<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2023.09.10 -->
        <title>Section2 Use Torchquantum on Pulse Level - TorchQuantum 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=362ab14a" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">TorchQuantum 0.1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">TorchQuantum 0.1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api_torchquantum.html">torchquantum</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../api_functional.html">torchquantum.functional</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of torchquantum.functional</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.apply_unitary_einsum.html">apply_unitary_einsum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.apply_unitary_bmm.html">apply_unitary_bmm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.gate_wrapper.html">gate_wrapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.reset.html">reset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.hadamard.html">hadamard</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.shadamard.html">shadamard</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.paulix.html">paulix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.pauliy.html">pauliy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.pauliz.html">pauliz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.i.html">i</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.s.html">s</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.t.html">t</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.sx.html">sx</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.cnot.html">cnot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.cz.html">cz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.cy.html">cy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.rx.html">rx</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.ry.html">ry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.rz.html">rz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.rxx.html">rxx</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.ryy.html">ryy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.rzz.html">rzz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.zz.html">zz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.rzx.html">rzx</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.zx.html">zx</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.swap.html">swap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.sswap.html">sswap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.cswap.html">cswap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.toffoli.html">toffoli</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.phaseshift.html">phaseshift</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.p.html">p</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.cp.html">cp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.rot.html">rot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.multirz.html">multirz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.crx.html">crx</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.cry.html">cry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.crz.html">crz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.crot.html">crot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.u1.html">u1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.u2.html">u2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.u3.html">u3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.u.html">u</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.cu1.html">cu1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.cu2.html">cu2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.cu3.html">cu3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.cu.html">cu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.qubitunitary.html">qubitunitary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.qubitunitaryfast.html">qubitunitaryfast</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.qubitunitarystrict.html">qubitunitarystrict</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.multicnot.html">multicnot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.multixcnot.html">multixcnot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.x.html">x</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.y.html">y</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.z.html">z</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.zz.html">zz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.cx.html">cx</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.ccnot.html">ccnot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.ccx.html">ccx</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.reset.html">reset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.singleexcitation.html">singleexcitation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.ecr.html">ecr</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.functional.echoedcrossresonance.html">echoedcrossresonance</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../api_operators.html">torchquantum.operators</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of torchquantum.operators</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.Operator.html">Operator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.Observable.html">Observable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.Operation.html">Operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.DiagonalOperation.html">DiagonalOperation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.Hadamard.html">Hadamard</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.SHadamard.html">SHadamard</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.PauliX.html">PauliX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.PauliY.html">PauliY</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.PauliZ.html">PauliZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.I.html">I</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.S.html">S</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.T.html">T</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.SX.html">SX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.CNOT.html">CNOT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.CZ.html">CZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.CY.html">CY</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.RX.html">RX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.RY.html">RY</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.RZ.html">RZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.RXX.html">RXX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.RYY.html">RYY</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.RZZ.html">RZZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.RZX.html">RZX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.SWAP.html">SWAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.SSWAP.html">SSWAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.CSWAP.html">CSWAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.Toffoli.html">Toffoli</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.PhaseShift.html">PhaseShift</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.Rot.html">Rot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.MultiRZ.html">MultiRZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.CRX.html">CRX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.CRY.html">CRY</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.CRZ.html">CRZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.CRot.html">CRot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.U1.html">U1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.U2.html">U2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.U3.html">U3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.CU1.html">CU1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.CU2.html">CU2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.CU3.html">CU3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.QubitUnitary.html">QubitUnitary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.QubitUnitaryFast.html">QubitUnitaryFast</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.TrainableUnitary.html">TrainableUnitary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.TrainableUnitaryStrict.html">TrainableUnitaryStrict</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.MultiCNOT.html">MultiCNOT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.MultiXCNOT.html">MultiXCNOT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.Reset.html">Reset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.SingleExcitation.html">SingleExcitation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.EchoedCrossResonance.html">EchoedCrossResonance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.operator.ECR.html">ECR</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../api_layers.html">torchquantum.layers</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of torchquantum.layers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.layer.QuantumModuleFromOps.html">QuantumModuleFromOps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.layer.TrainableOpAll.html">TrainableOpAll</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.layer.ClassicalInOpAll.html">ClassicalInOpAll</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.layer.FixedOpAll.html">FixedOpAll</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.layer.TwoQAll.html">TwoQAll</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.layer.RandomLayer.html">RandomLayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.layer.RandomLayerAllTypes.html">RandomLayerAllTypes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.layer.Op1QAllLayer.html">Op1QAllLayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.layer.RandomOp1All.html">RandomOp1All</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.layer.Op2QAllLayer.html">Op2QAllLayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.layer.Op2QButterflyLayer.html">Op2QButterflyLayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.layer.Op2QDenseLayer.html">Op2QDenseLayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.layer.CXLayer.html">CXLayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.layer.CXCXCXLayer.html">CXCXCXLayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.layer.SWAPSWAPLayer.html">SWAPSWAPLayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.layer.RXYZCXLayer0.html">RXYZCXLayer0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../generated/torchquantum.layer.QFTLayer.html">QFTLayer</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../usage_installation.html">Installation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../index.html">TorchQuantum Examples</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of TorchQuantum Examples</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../gradient_pruning/probabilistic_gradient_pruning.html">Probabilistic gradient pruning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../param_shift_onchip_training/param_shift_onchip_training.html">Apply parameters shift rules to train quantum model using TorchQuantum.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quantum_kernel_method/quantum_kernel_method.html">Quantum Kernel Methods for IRIS dataset classification with TorchQuantum.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quanvolution/quanvolution.html">Quanvolution (Quantum convolution) for MNIST image classification with TorchQuantum.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../superdense_coding/superdense_coding_torchquantum.html">Superdense Coding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../superdense_coding/superdense_coding_torchquantum.html#References:">References:</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="Section2-Use-Torchquantum-on-Pulse-Level">
<h1><strong>Section2 Use Torchquantum on Pulse Level</strong><a class="headerlink" href="#Section2-Use-Torchquantum-on-Pulse-Level" title="Link to this heading">#</a></h1>
</section>
<section id="Setup">
<h1>Setup<a class="headerlink" href="#Setup" title="Link to this heading">#</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Installing torchquantum...&#39;</span><span class="p">)</span>
<span class="err">!</span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">mit</span><span class="o">-</span><span class="n">han</span><span class="o">-</span><span class="n">lab</span><span class="o">/</span><span class="n">torchquantum</span><span class="o">.</span><span class="n">git</span>
<span class="o">%</span><span class="n">cd</span> <span class="o">/</span><span class="n">content</span><span class="o">/</span><span class="n">torchquantum</span>
<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">editable</span> <span class="o">.</span> <span class="mi">1</span><span class="o">&gt;/</span><span class="n">dev</span><span class="o">/</span><span class="n">null</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Installing torchquantum...
fatal: destination path &#39;torchquantum&#39; already exists and is not an empty directory.
/content/torchquantum
<span class="ansi-red-fg">ERROR: pip&#39;s dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
qiskit-nature 0.4.4 requires qiskit-terra&gt;=0.21.0, but you have qiskit-terra 0.18.3 which is incompatible.</span>
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">qiskit_nature</span><span class="o">==</span><span class="mf">0.4.4</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Requirement already satisfied: qiskit_nature==0.4.4 in /usr/local/lib/python3.7/dist-packages (0.4.4)
Requirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from qiskit_nature==0.4.4) (4.1.1)
Requirement already satisfied: scipy&gt;=1.4 in /usr/local/lib/python3.7/dist-packages (from qiskit_nature==0.4.4) (1.7.3)
Requirement already satisfied: numpy&gt;=1.17 in /usr/local/lib/python3.7/dist-packages (from qiskit_nature==0.4.4) (1.21.6)
Collecting qiskit-terra&gt;=0.21.0
  Using cached qiskit_terra-0.21.2-cp37-cp37m-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (6.7 MB)
Requirement already satisfied: scikit-learn&gt;=0.20.0 in /usr/local/lib/python3.7/dist-packages (from qiskit_nature==0.4.4) (1.0.2)
Requirement already satisfied: setuptools&gt;=40.1.0 in /usr/local/lib/python3.7/dist-packages (from qiskit_nature==0.4.4) (57.4.0)
Requirement already satisfied: retworkx&gt;=0.10.1 in /usr/local/lib/python3.7/dist-packages (from qiskit_nature==0.4.4) (0.11.0)
Requirement already satisfied: psutil&gt;=5 in /usr/local/lib/python3.7/dist-packages (from qiskit_nature==0.4.4) (5.4.8)
Requirement already satisfied: h5py in /usr/local/lib/python3.7/dist-packages (from qiskit_nature==0.4.4) (3.1.0)
Requirement already satisfied: stevedore&gt;=3.0.0 in /usr/local/lib/python3.7/dist-packages (from qiskit-terra&gt;=0.21.0-&gt;qiskit_nature==0.4.4) (3.5.0)
Requirement already satisfied: shared-memory38 in /usr/local/lib/python3.7/dist-packages (from qiskit-terra&gt;=0.21.0-&gt;qiskit_nature==0.4.4) (0.1.2)
Requirement already satisfied: tweedledum&lt;2.0,&gt;=1.1 in /usr/local/lib/python3.7/dist-packages (from qiskit-terra&gt;=0.21.0-&gt;qiskit_nature==0.4.4) (1.1.1)
Requirement already satisfied: symengine&gt;=0.9 in /usr/local/lib/python3.7/dist-packages (from qiskit-terra&gt;=0.21.0-&gt;qiskit_nature==0.4.4) (0.9.2)
Requirement already satisfied: sympy&gt;=1.3 in /usr/local/lib/python3.7/dist-packages (from qiskit-terra&gt;=0.21.0-&gt;qiskit_nature==0.4.4) (1.7.1)
Requirement already satisfied: ply&gt;=3.10 in /usr/local/lib/python3.7/dist-packages (from qiskit-terra&gt;=0.21.0-&gt;qiskit_nature==0.4.4) (3.11)
Requirement already satisfied: dill&gt;=0.3 in /usr/local/lib/python3.7/dist-packages (from qiskit-terra&gt;=0.21.0-&gt;qiskit_nature==0.4.4) (0.3.5.1)
Requirement already satisfied: python-dateutil&gt;=2.8.0 in /usr/local/lib/python3.7/dist-packages (from qiskit-terra&gt;=0.21.0-&gt;qiskit_nature==0.4.4) (2.8.2)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.7/dist-packages (from python-dateutil&gt;=2.8.0-&gt;qiskit-terra&gt;=0.21.0-&gt;qiskit_nature==0.4.4) (1.15.0)
Requirement already satisfied: joblib&gt;=0.11 in /usr/local/lib/python3.7/dist-packages (from scikit-learn&gt;=0.20.0-&gt;qiskit_nature==0.4.4) (1.1.0)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /usr/local/lib/python3.7/dist-packages (from scikit-learn&gt;=0.20.0-&gt;qiskit_nature==0.4.4) (3.1.0)
Requirement already satisfied: pbr!=2.1.0,&gt;=2.0.0 in /usr/local/lib/python3.7/dist-packages (from stevedore&gt;=3.0.0-&gt;qiskit-terra&gt;=0.21.0-&gt;qiskit_nature==0.4.4) (5.10.0)
Requirement already satisfied: importlib-metadata&gt;=1.7.0 in /usr/local/lib/python3.7/dist-packages (from stevedore&gt;=3.0.0-&gt;qiskit-terra&gt;=0.21.0-&gt;qiskit_nature==0.4.4) (4.12.0)
Requirement already satisfied: zipp&gt;=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata&gt;=1.7.0-&gt;stevedore&gt;=3.0.0-&gt;qiskit-terra&gt;=0.21.0-&gt;qiskit_nature==0.4.4) (3.8.1)
Requirement already satisfied: mpmath&gt;=0.19 in /usr/local/lib/python3.7/dist-packages (from sympy&gt;=1.3-&gt;qiskit-terra&gt;=0.21.0-&gt;qiskit_nature==0.4.4) (1.2.1)
Requirement already satisfied: cached-property in /usr/local/lib/python3.7/dist-packages (from h5py-&gt;qiskit_nature==0.4.4) (1.5.2)
Installing collected packages: qiskit-terra
  Attempting uninstall: qiskit-terra
    Found existing installation: qiskit-terra 0.18.3
    Uninstalling qiskit-terra-0.18.3:
      Successfully uninstalled qiskit-terra-0.18.3
<span class="ansi-red-fg">ERROR: pip&#39;s dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
qiskit 0.32.1 requires qiskit-terra==0.18.3, but you have qiskit-terra 0.21.2 which is incompatible.</span>
Successfully installed qiskit-terra-0.21.2
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="admonition warning">
<p>Data type cannot be displayed: application/vnd.colab-display-data+json</p>
</div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">qiskit</span><span class="o">==</span><span class="mf">0.38.0</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Collecting qiskit==0.38.0
  Using cached qiskit-0.38.0-py3-none-any.whl
Collecting qiskit-aer==0.11.0
  Using cached qiskit_aer-0.11.0-cp37-cp37m-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (19.2 MB)
Requirement already satisfied: qiskit-terra==0.21.2 in /usr/local/lib/python3.7/dist-packages (from qiskit==0.38.0) (0.21.2)
Collecting qiskit-ibmq-provider==0.19.2
  Using cached qiskit_ibmq_provider-0.19.2-py3-none-any.whl (240 kB)
Requirement already satisfied: scipy&gt;=1.0 in /usr/local/lib/python3.7/dist-packages (from qiskit-aer==0.11.0-&gt;qiskit==0.38.0) (1.7.3)
Requirement already satisfied: numpy&gt;=1.16.3 in /usr/local/lib/python3.7/dist-packages (from qiskit-aer==0.11.0-&gt;qiskit==0.38.0) (1.21.6)
Requirement already satisfied: requests&gt;=2.19 in /usr/local/lib/python3.7/dist-packages (from qiskit-ibmq-provider==0.19.2-&gt;qiskit==0.38.0) (2.28.1)
Requirement already satisfied: websockets&gt;=10.0 in /usr/local/lib/python3.7/dist-packages (from qiskit-ibmq-provider==0.19.2-&gt;qiskit==0.38.0) (10.3)
Requirement already satisfied: urllib3&gt;=1.21.1 in /usr/local/lib/python3.7/dist-packages (from qiskit-ibmq-provider==0.19.2-&gt;qiskit==0.38.0) (1.24.3)
Requirement already satisfied: python-dateutil&gt;=2.8.0 in /usr/local/lib/python3.7/dist-packages (from qiskit-ibmq-provider==0.19.2-&gt;qiskit==0.38.0) (2.8.2)
Requirement already satisfied: requests-ntlm&gt;=1.1.0 in /usr/local/lib/python3.7/dist-packages (from qiskit-ibmq-provider==0.19.2-&gt;qiskit==0.38.0) (1.1.0)
Requirement already satisfied: websocket-client&gt;=1.0.1 in /usr/local/lib/python3.7/dist-packages (from qiskit-ibmq-provider==0.19.2-&gt;qiskit==0.38.0) (1.4.1)
Requirement already satisfied: symengine&gt;=0.9 in /usr/local/lib/python3.7/dist-packages (from qiskit-terra==0.21.2-&gt;qiskit==0.38.0) (0.9.2)
Requirement already satisfied: sympy&gt;=1.3 in /usr/local/lib/python3.7/dist-packages (from qiskit-terra==0.21.2-&gt;qiskit==0.38.0) (1.7.1)
Requirement already satisfied: shared-memory38 in /usr/local/lib/python3.7/dist-packages (from qiskit-terra==0.21.2-&gt;qiskit==0.38.0) (0.1.2)
Requirement already satisfied: dill&gt;=0.3 in /usr/local/lib/python3.7/dist-packages (from qiskit-terra==0.21.2-&gt;qiskit==0.38.0) (0.3.5.1)
Requirement already satisfied: ply&gt;=3.10 in /usr/local/lib/python3.7/dist-packages (from qiskit-terra==0.21.2-&gt;qiskit==0.38.0) (3.11)
Requirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from qiskit-terra==0.21.2-&gt;qiskit==0.38.0) (4.1.1)
Requirement already satisfied: retworkx&gt;=0.11.0 in /usr/local/lib/python3.7/dist-packages (from qiskit-terra==0.21.2-&gt;qiskit==0.38.0) (0.11.0)
Requirement already satisfied: tweedledum&lt;2.0,&gt;=1.1 in /usr/local/lib/python3.7/dist-packages (from qiskit-terra==0.21.2-&gt;qiskit==0.38.0) (1.1.1)
Requirement already satisfied: psutil&gt;=5 in /usr/local/lib/python3.7/dist-packages (from qiskit-terra==0.21.2-&gt;qiskit==0.38.0) (5.4.8)
Requirement already satisfied: stevedore&gt;=3.0.0 in /usr/local/lib/python3.7/dist-packages (from qiskit-terra==0.21.2-&gt;qiskit==0.38.0) (3.5.0)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.7/dist-packages (from python-dateutil&gt;=2.8.0-&gt;qiskit-ibmq-provider==0.19.2-&gt;qiskit==0.38.0) (1.15.0)
Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests&gt;=2.19-&gt;qiskit-ibmq-provider==0.19.2-&gt;qiskit==0.38.0) (2022.6.15)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /usr/local/lib/python3.7/dist-packages (from requests&gt;=2.19-&gt;qiskit-ibmq-provider==0.19.2-&gt;qiskit==0.38.0) (2.10)
Requirement already satisfied: charset-normalizer&lt;3,&gt;=2 in /usr/local/lib/python3.7/dist-packages (from requests&gt;=2.19-&gt;qiskit-ibmq-provider==0.19.2-&gt;qiskit==0.38.0) (2.1.1)
Requirement already satisfied: cryptography&gt;=1.3 in /usr/local/lib/python3.7/dist-packages (from requests-ntlm&gt;=1.1.0-&gt;qiskit-ibmq-provider==0.19.2-&gt;qiskit==0.38.0) (38.0.1)
Requirement already satisfied: ntlm-auth&gt;=1.0.2 in /usr/local/lib/python3.7/dist-packages (from requests-ntlm&gt;=1.1.0-&gt;qiskit-ibmq-provider==0.19.2-&gt;qiskit==0.38.0) (1.5.0)
Requirement already satisfied: cffi&gt;=1.12 in /usr/local/lib/python3.7/dist-packages (from cryptography&gt;=1.3-&gt;requests-ntlm&gt;=1.1.0-&gt;qiskit-ibmq-provider==0.19.2-&gt;qiskit==0.38.0) (1.15.1)
Requirement already satisfied: pycparser in /usr/local/lib/python3.7/dist-packages (from cffi&gt;=1.12-&gt;cryptography&gt;=1.3-&gt;requests-ntlm&gt;=1.1.0-&gt;qiskit-ibmq-provider==0.19.2-&gt;qiskit==0.38.0) (2.21)
Requirement already satisfied: pbr!=2.1.0,&gt;=2.0.0 in /usr/local/lib/python3.7/dist-packages (from stevedore&gt;=3.0.0-&gt;qiskit-terra==0.21.2-&gt;qiskit==0.38.0) (5.10.0)
Requirement already satisfied: importlib-metadata&gt;=1.7.0 in /usr/local/lib/python3.7/dist-packages (from stevedore&gt;=3.0.0-&gt;qiskit-terra==0.21.2-&gt;qiskit==0.38.0) (4.12.0)
Requirement already satisfied: zipp&gt;=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata&gt;=1.7.0-&gt;stevedore&gt;=3.0.0-&gt;qiskit-terra==0.21.2-&gt;qiskit==0.38.0) (3.8.1)
Requirement already satisfied: mpmath&gt;=0.19 in /usr/local/lib/python3.7/dist-packages (from sympy&gt;=1.3-&gt;qiskit-terra==0.21.2-&gt;qiskit==0.38.0) (1.2.1)
Installing collected packages: qiskit-ibmq-provider, qiskit-aer, qiskit
  Attempting uninstall: qiskit-ibmq-provider
    Found existing installation: qiskit-ibmq-provider 0.18.1
    Uninstalling qiskit-ibmq-provider-0.18.1:
      Successfully uninstalled qiskit-ibmq-provider-0.18.1
  Attempting uninstall: qiskit-aer
    Found existing installation: qiskit-aer 0.9.1
    Uninstalling qiskit-aer-0.9.1:
      Successfully uninstalled qiskit-aer-0.9.1
  Attempting uninstall: qiskit
    Found existing installation: qiskit 0.32.1
    Uninstalling qiskit-0.32.1:
      Successfully uninstalled qiskit-0.32.1
<span class="ansi-red-fg">ERROR: pip&#39;s dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
torchquantum 0.1.2 requires qiskit==0.32.1, but you have qiskit 0.38.0 which is incompatible.</span>
Successfully installed qiskit-0.38.0 qiskit-aer-0.11.0 qiskit-ibmq-provider-0.19.2
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="admonition warning">
<p>Data type cannot be displayed: application/vnd.colab-display-data+json</p>
</div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">matplotlib</span><span class="o">==</span><span class="mf">3.1.3</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Collecting matplotlib==3.1.3
  Using cached matplotlib-3.1.3-cp37-cp37m-manylinux1_x86_64.whl (13.1 MB)
Requirement already satisfied: python-dateutil&gt;=2.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib==3.1.3) (2.8.2)
Requirement already satisfied: numpy&gt;=1.11 in /usr/local/lib/python3.7/dist-packages (from matplotlib==3.1.3) (1.21.6)
Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,&gt;=2.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib==3.1.3) (3.0.9)
Requirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.7/dist-packages (from matplotlib==3.1.3) (0.11.0)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib==3.1.3) (1.4.4)
Requirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from kiwisolver&gt;=1.0.1-&gt;matplotlib==3.1.3) (4.1.1)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.7/dist-packages (from python-dateutil&gt;=2.1-&gt;matplotlib==3.1.3) (1.15.0)
Installing collected packages: matplotlib
  Attempting uninstall: matplotlib
    Found existing installation: matplotlib 3.5.3
    Uninstalling matplotlib-3.5.3:
      Successfully uninstalled matplotlib-3.5.3
<span class="ansi-red-fg">ERROR: pip&#39;s dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
torchquantum 0.1.2 requires matplotlib&gt;=3.3.2, but you have matplotlib 3.1.3 which is incompatible.
torchquantum 0.1.2 requires qiskit==0.32.1, but you have qiskit 0.38.0 which is incompatible.</span>
Successfully installed matplotlib-3.1.3
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="admonition warning">
<p>Data type cannot be displayed: application/vnd.colab-display-data+json</p>
</div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">torchquantum.pulse_utils</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">import</span> <span class="nn">torch.optim</span> <span class="k">as</span> <span class="nn">optim</span>
<span class="kn">import</span> <span class="nn">argparse</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torchquantum</span> <span class="k">as</span> <span class="nn">tq</span>
<span class="kn">import</span> <span class="nn">torchquantum.functional</span> <span class="k">as</span> <span class="nn">tqf</span>
<span class="kn">import</span> <span class="nn">pdb</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</pre></div>
</div>
</div>
</section>
<section id="2.1-Quantum-Optimal-Control">
<h1><strong>2.1 Quantum Optimal Control</strong><a class="headerlink" href="#2.1-Quantum-Optimal-Control" title="Link to this heading">#</a></h1>
<p>Optimal control can be used to achieve efficient state preparation, state-to-state transfer or some unitary matrix on a quantum system. Current quantum systems can be manipulated in a controlled way, such as the time-varying amplitude of microwave pulses that act on a superconducting circuit.</p>
<p>In the simple example below, QOC is used to achieve a rotation gate, and we use pulses to achieve such target. The pulses are composed of four time steps with different amplitudes. The control Hamiltonian is the Pauli-X. In this gradient-based optimization we will be able to achieve the target unitary with desired accuracy.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">theta</span> <span class="o">=</span> <span class="mf">0.6</span>
<span class="n">target_unitary</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="o">/</span><span class="mi">2</span><span class="p">)],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="o">/</span><span class="mi">2</span><span class="p">)]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">complex64</span><span class="p">)</span>
<span class="c1"># The target_unitary is a simple rotation gate with angle = 0.6;</span>
<span class="n">pulse</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumPulseDirect</span><span class="p">(</span><span class="n">n_steps</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                              <span class="n">hamil</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="c1"># The pulse has 4 time slots and the drive Hamiltonian is the Pauli-X.</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">pulse</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span>  <span class="n">lr</span><span class="o">=</span><span class="mf">5e-3</span><span class="p">)</span>

<span class="c1"># TODO(jinleic):</span>
<span class="c1"># add Bloch Sphere here</span>
<span class="c1"># add figure for pulse time slots</span>
<span class="c1"># Can we see the learning curve?</span>
<span class="n">losses</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="c1"># loss = (abs(pulse.get_unitary() - target_unitary)**2).sum()</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">pulse</span><span class="o">.</span><span class="n">get_unitary</span><span class="p">()</span> <span class="o">@</span> <span class="n">target_unitary</span><span class="p">)</span> <span class="o">/</span> <span class="n">target_unitary</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
    <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
    <span class="c1"># print(pulse.pulse_shape.grad)</span>
    <span class="c1"># print(loss)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">pulse</span><span class="o">.</span><span class="n">pulse_shape</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">pulse</span><span class="o">.</span><span class="n">get_unitary</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Number of Iterations&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Training Losses&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Training from Default Initialization&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">losses</span><span class="p">[:</span><span class="mi">100</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Parameter containing:
tensor([0.9950, 0.9950, 0.9950, 0.9950], requires_grad=True)
tensor([[-0.6686+0.0000j,  0.0000+0.7436j],
        [ 0.0000+0.7436j, -0.6686+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.9900, 0.9900, 0.9900, 0.9900], requires_grad=True)
tensor([[-0.6834+0.0000j,  0.0000+0.7300j],
        [ 0.0000+0.7300j, -0.6834+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.9850, 0.9850, 0.9850, 0.9850], requires_grad=True)
tensor([[-0.6979+0.0000j,  0.0000+0.7162j],
        [ 0.0000+0.7162j, -0.6979+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.9800, 0.9800, 0.9800, 0.9800], requires_grad=True)
tensor([[-0.7121+0.0000j,  0.0000+0.7021j],
        [ 0.0000+0.7021j, -0.7121+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.9749, 0.9749, 0.9749, 0.9749], requires_grad=True)
tensor([[-0.7261+0.0000j,  0.0000+0.6876j],
        [ 0.0000+0.6876j, -0.7261+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.9699, 0.9699, 0.9699, 0.9699], requires_grad=True)
tensor([[-0.7398+0.0000j,  0.0000+0.6728j],
        [ 0.0000+0.6728j, -0.7398+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.9649, 0.9649, 0.9649, 0.9649], requires_grad=True)
tensor([[-0.7532+0.0000j,  0.0000+0.6577j],
        [ 0.0000+0.6577j, -0.7532+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.9598, 0.9598, 0.9598, 0.9598], requires_grad=True)
tensor([[-0.7664+0.0000j,  0.0000+0.6423j],
        [ 0.0000+0.6423j, -0.7664+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.9547, 0.9547, 0.9547, 0.9547], requires_grad=True)
tensor([[-0.7793+0.0000j,  0.0000+0.6266j],
        [ 0.0000+0.6266j, -0.7793+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.9496, 0.9496, 0.9496, 0.9496], requires_grad=True)
tensor([[-0.7919+0.0000j,  0.0000+0.6106j],
        [ 0.0000+0.6106j, -0.7919+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.9445, 0.9445, 0.9445, 0.9445], requires_grad=True)
tensor([[-0.8042+0.0000j,  0.0000+0.5943j],
        [ 0.0000+0.5943j, -0.8042+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.9394, 0.9394, 0.9394, 0.9394], requires_grad=True)
tensor([[-0.8162+0.0000j,  0.0000+0.5777j],
        [ 0.0000+0.5777j, -0.8162+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.9342, 0.9342, 0.9342, 0.9342], requires_grad=True)
tensor([[-0.8279+0.0000j,  0.0000+0.5608j],
        [ 0.0000+0.5608j, -0.8279+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.9291, 0.9291, 0.9291, 0.9291], requires_grad=True)
tensor([[-0.8393+0.0000j,  0.0000+0.5437j],
        [ 0.0000+0.5437j, -0.8393+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.9239, 0.9239, 0.9239, 0.9239], requires_grad=True)
tensor([[-0.8504+0.0000j,  0.0000+0.5262j],
        [ 0.0000+0.5262j, -0.8504+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.9188, 0.9188, 0.9188, 0.9188], requires_grad=True)
tensor([[-0.8611+0.0000j,  0.0000+0.5085j],
        [ 0.0000+0.5085j, -0.8611+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.9136, 0.9136, 0.9136, 0.9136], requires_grad=True)
tensor([[-0.8714+0.0000j,  0.0000+0.4905j],
        [ 0.0000+0.4905j, -0.8714+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.9084, 0.9084, 0.9084, 0.9084], requires_grad=True)
tensor([[-0.8814+0.0000j,  0.0000+0.4723j],
        [ 0.0000+0.4723j, -0.8814+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.9032, 0.9032, 0.9032, 0.9032], requires_grad=True)
tensor([[-0.8911+0.0000j,  0.0000+0.4538j],
        [ 0.0000+0.4538j, -0.8911+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.8980, 0.8980, 0.8980, 0.8980], requires_grad=True)
tensor([[-0.9003+0.0000j,  0.0000+0.4352j],
        [ 0.0000+0.4352j, -0.9003+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.8927, 0.8927, 0.8927, 0.8927], requires_grad=True)
tensor([[-0.9092+0.0000j,  0.0000+0.4163j],
        [ 0.0000+0.4163j, -0.9092+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.8875, 0.8875, 0.8875, 0.8875], requires_grad=True)
tensor([[-0.9177+0.0000j,  0.0000+0.3972j],
        [ 0.0000+0.3972j, -0.9177+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.8823, 0.8823, 0.8823, 0.8823], requires_grad=True)
tensor([[-0.9258+0.0000j,  0.0000+0.3780j],
        [ 0.0000+0.3780j, -0.9258+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.8771, 0.8771, 0.8771, 0.8771], requires_grad=True)
tensor([[-0.9335+0.0000j,  0.0000+0.3586j],
        [ 0.0000+0.3586j, -0.9335+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.8719, 0.8719, 0.8719, 0.8719], requires_grad=True)
tensor([[-0.9407+0.0000j,  0.0000+0.3391j],
        [ 0.0000+0.3391j, -0.9407+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.8667, 0.8667, 0.8667, 0.8667], requires_grad=True)
tensor([[-0.9476+0.0000j,  0.0000+0.3195j],
        [ 0.0000+0.3195j, -0.9476+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.8615, 0.8615, 0.8615, 0.8615], requires_grad=True)
tensor([[-0.9540+0.0000j,  0.0000+0.2998j],
        [ 0.0000+0.2998j, -0.9540+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.8564, 0.8564, 0.8564, 0.8564], requires_grad=True)
tensor([[-0.9600+0.0000j,  0.0000+0.2801j],
        [ 0.0000+0.2801j, -0.9600+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.8512, 0.8512, 0.8512, 0.8512], requires_grad=True)
tensor([[-0.9655+0.0000j,  0.0000+0.2603j],
        [ 0.0000+0.2603j, -0.9655+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.8461, 0.8461, 0.8461, 0.8461], requires_grad=True)
tensor([[-0.9707+0.0000j,  0.0000+0.2405j],
        [ 0.0000+0.2405j, -0.9707+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.8410, 0.8410, 0.8410, 0.8410], requires_grad=True)
tensor([[-0.9753+0.0000j,  0.0000+0.2207j],
        [ 0.0000+0.2207j, -0.9753+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.8360, 0.8360, 0.8360, 0.8360], requires_grad=True)
tensor([[-0.9796+0.0000j,  0.0000+0.2009j],
        [ 0.0000+0.2009j, -0.9796+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.8310, 0.8310, 0.8310, 0.8310], requires_grad=True)
tensor([[-0.9834+0.0000j,  0.0000+0.1812j],
        [ 0.0000+0.1812j, -0.9834+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.8260, 0.8260, 0.8260, 0.8260], requires_grad=True)
tensor([[-0.9869+0.0000j,  0.0000+0.1616j],
        [ 0.0000+0.1616j, -0.9869+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.8211, 0.8211, 0.8211, 0.8211], requires_grad=True)
tensor([[-0.9898+0.0000j,  0.0000+0.1422j],
        [ 0.0000+0.1422j, -0.9898+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.8162, 0.8162, 0.8162, 0.8162], requires_grad=True)
tensor([[-0.9924+0.0000j,  0.0000+0.1229j],
        [ 0.0000+0.1229j, -0.9924+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.8114, 0.8114, 0.8114, 0.8114], requires_grad=True)
tensor([[-0.9946+0.0000j,  0.0000+0.1037j],
        [ 0.0000+0.1037j, -0.9946+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.8066, 0.8066, 0.8066, 0.8066], requires_grad=True)
tensor([[-0.9964+0.0000j,  0.0000+0.0848j],
        [ 0.0000+0.0848j, -0.9964+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.8019, 0.8019, 0.8019, 0.8019], requires_grad=True)
tensor([[-0.9978+0.0000j,  0.0000+0.0661j],
        [ 0.0000+0.0661j, -0.9978+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7973, 0.7973, 0.7973, 0.7973], requires_grad=True)
tensor([[-0.9989+0.0000j,  0.0000+0.0477j],
        [ 0.0000+0.0477j, -0.9989+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7928, 0.7928, 0.7928, 0.7928], requires_grad=True)
tensor([[-0.9996+0.0000j,  0.0000+0.0296j],
        [ 0.0000+0.0296j, -0.9996+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7883, 0.7883, 0.7883, 0.7883], requires_grad=True)
tensor([[-0.9999+0.0000j,  0.0000+0.0118j],
        [ 0.0000+0.0118j, -0.9999+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7840, 0.7840, 0.7840, 0.7840], requires_grad=True)
tensor([[-1.0000+0.0000j,  0.0000-0.0057j],
        [ 0.0000-0.0057j, -1.0000+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7797, 0.7797, 0.7797, 0.7797], requires_grad=True)
tensor([[-0.9997+0.0000j,  0.0000-0.0228j],
        [ 0.0000-0.0228j, -0.9997+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7755, 0.7755, 0.7755, 0.7755], requires_grad=True)
tensor([[-0.9992+0.0000j,  0.0000-0.0395j],
        [ 0.0000-0.0395j, -0.9992+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7714, 0.7714, 0.7714, 0.7714], requires_grad=True)
tensor([[-0.9984+0.0000j,  0.0000-0.0558j],
        [ 0.0000-0.0558j, -0.9984+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7675, 0.7675, 0.7675, 0.7675], requires_grad=True)
tensor([[-0.9974+0.0000j,  0.0000-0.0716j],
        [ 0.0000-0.0716j, -0.9974+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7636, 0.7636, 0.7636, 0.7636], requires_grad=True)
tensor([[-0.9962+0.0000j,  0.0000-0.0870j],
        [ 0.0000-0.0870j, -0.9962+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7599, 0.7599, 0.7599, 0.7599], requires_grad=True)
tensor([[-0.9948+0.0000j,  0.0000-0.1020j],
        [ 0.0000-0.1020j, -0.9948+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7562, 0.7562, 0.7562, 0.7562], requires_grad=True)
tensor([[-0.9932+0.0000j,  0.0000-0.1164j],
        [ 0.0000-0.1164j, -0.9932+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7527, 0.7527, 0.7527, 0.7527], requires_grad=True)
tensor([[-0.9915+0.0000j,  0.0000-0.1303j],
        [ 0.0000-0.1303j, -0.9915+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7493, 0.7493, 0.7493, 0.7493], requires_grad=True)
tensor([[-0.9896+0.0000j,  0.0000-0.1438j],
        [ 0.0000-0.1438j, -0.9896+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7461, 0.7461, 0.7461, 0.7461], requires_grad=True)
tensor([[-0.9876+0.0000j,  0.0000-0.1567j],
        [ 0.0000-0.1567j, -0.9876+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7429, 0.7429, 0.7429, 0.7429], requires_grad=True)
tensor([[-0.9856+0.0000j,  0.0000-0.1691j],
        [ 0.0000-0.1691j, -0.9856+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7399, 0.7399, 0.7399, 0.7399], requires_grad=True)
tensor([[-0.9835+0.0000j,  0.0000-0.1809j],
        [ 0.0000-0.1809j, -0.9835+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7370, 0.7370, 0.7370, 0.7370], requires_grad=True)
tensor([[-0.9814+0.0000j,  0.0000-0.1922j],
        [ 0.0000-0.1922j, -0.9814+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7343, 0.7343, 0.7343, 0.7343], requires_grad=True)
tensor([[-0.9792+0.0000j,  0.0000-0.2030j],
        [ 0.0000-0.2030j, -0.9792+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7317, 0.7317, 0.7317, 0.7317], requires_grad=True)
tensor([[-0.9770+0.0000j,  0.0000-0.2132j],
        [ 0.0000-0.2132j, -0.9770+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7292, 0.7292, 0.7292, 0.7292], requires_grad=True)
tensor([[-0.9748+0.0000j,  0.0000-0.2229j],
        [ 0.0000-0.2229j, -0.9748+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7268, 0.7268, 0.7268, 0.7268], requires_grad=True)
tensor([[-0.9727+0.0000j,  0.0000-0.2321j],
        [ 0.0000-0.2321j, -0.9727+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7246, 0.7246, 0.7246, 0.7246], requires_grad=True)
tensor([[-0.9706+0.0000j,  0.0000-0.2407j],
        [ 0.0000-0.2407j, -0.9706+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7225, 0.7225, 0.7225, 0.7225], requires_grad=True)
tensor([[-0.9686+0.0000j,  0.0000-0.2488j],
        [ 0.0000-0.2488j, -0.9686+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7206, 0.7206, 0.7206, 0.7206], requires_grad=True)
tensor([[-0.9666+0.0000j,  0.0000-0.2564j],
        [ 0.0000-0.2564j, -0.9666+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7187, 0.7187, 0.7187, 0.7187], requires_grad=True)
tensor([[-0.9647+0.0000j,  0.0000-0.2635j],
        [ 0.0000-0.2635j, -0.9647+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7170, 0.7170, 0.7170, 0.7170], requires_grad=True)
tensor([[-0.9628+0.0000j,  0.0000-0.2700j],
        [ 0.0000-0.2700j, -0.9628+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7155, 0.7155, 0.7155, 0.7155], requires_grad=True)
tensor([[-0.9611+0.0000j,  0.0000-0.2761j],
        [ 0.0000-0.2761j, -0.9611+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7140, 0.7140, 0.7140, 0.7140], requires_grad=True)
tensor([[-0.9595+0.0000j,  0.0000-0.2818j],
        [ 0.0000-0.2818j, -0.9595+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7126, 0.7126, 0.7126, 0.7126], requires_grad=True)
tensor([[-0.9579+0.0000j,  0.0000-0.2869j],
        [ 0.0000-0.2869j, -0.9579+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7114, 0.7114, 0.7114, 0.7114], requires_grad=True)
tensor([[-0.9565+0.0000j,  0.0000-0.2917j],
        [ 0.0000-0.2917j, -0.9565+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7103, 0.7103, 0.7103, 0.7103], requires_grad=True)
tensor([[-0.9552+0.0000j,  0.0000-0.2960j],
        [ 0.0000-0.2960j, -0.9552+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7093, 0.7093, 0.7093, 0.7093], requires_grad=True)
tensor([[-0.9540+0.0000j,  0.0000-0.2999j],
        [ 0.0000-0.2999j, -0.9540+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7083, 0.7083, 0.7083, 0.7083], requires_grad=True)
tensor([[-0.9529+0.0000j,  0.0000-0.3034j],
        [ 0.0000-0.3034j, -0.9529+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7075, 0.7075, 0.7075, 0.7075], requires_grad=True)
tensor([[-0.9519+0.0000j,  0.0000-0.3065j],
        [ 0.0000-0.3065j, -0.9519+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7068, 0.7068, 0.7068, 0.7068], requires_grad=True)
tensor([[-0.9510+0.0000j,  0.0000-0.3093j],
        [ 0.0000-0.3093j, -0.9510+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7062, 0.7062, 0.7062, 0.7062], requires_grad=True)
tensor([[-0.9502+0.0000j,  0.0000-0.3117j],
        [ 0.0000-0.3117j, -0.9502+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7056, 0.7056, 0.7056, 0.7056], requires_grad=True)
tensor([[-0.9495+0.0000j,  0.0000-0.3138j],
        [ 0.0000-0.3138j, -0.9495+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7051, 0.7051, 0.7051, 0.7051], requires_grad=True)
tensor([[-0.9489+0.0000j,  0.0000-0.3156j],
        [ 0.0000-0.3156j, -0.9489+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7047, 0.7047, 0.7047, 0.7047], requires_grad=True)
tensor([[-0.9484+0.0000j,  0.0000-0.3171j],
        [ 0.0000-0.3171j, -0.9484+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7044, 0.7044, 0.7044, 0.7044], requires_grad=True)
tensor([[-0.9480+0.0000j,  0.0000-0.3183j],
        [ 0.0000-0.3183j, -0.9480+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7041, 0.7041, 0.7041, 0.7041], requires_grad=True)
tensor([[-0.9476+0.0000j,  0.0000-0.3193j],
        [ 0.0000-0.3193j, -0.9476+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7040, 0.7040, 0.7040, 0.7040], requires_grad=True)
tensor([[-0.9474+0.0000j,  0.0000-0.3201j],
        [ 0.0000-0.3201j, -0.9474+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7038, 0.7038, 0.7038, 0.7038], requires_grad=True)
tensor([[-0.9472+0.0000j,  0.0000-0.3206j],
        [ 0.0000-0.3206j, -0.9472+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7037, 0.7037, 0.7037, 0.7037], requires_grad=True)
tensor([[-0.9471+0.0000j,  0.0000-0.3209j],
        [ 0.0000-0.3209j, -0.9471+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7037, 0.7037, 0.7037, 0.7037], requires_grad=True)
tensor([[-0.9471+0.0000j,  0.0000-0.3210j],
        [ 0.0000-0.3210j, -0.9471+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7037, 0.7037, 0.7037, 0.7037], requires_grad=True)
tensor([[-0.9471+0.0000j,  0.0000-0.3210j],
        [ 0.0000-0.3210j, -0.9471+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7038, 0.7038, 0.7038, 0.7038], requires_grad=True)
tensor([[-0.9471+0.0000j,  0.0000-0.3208j],
        [ 0.0000-0.3208j, -0.9471+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7038, 0.7038, 0.7038, 0.7038], requires_grad=True)
tensor([[-0.9473+0.0000j,  0.0000-0.3205j],
        [ 0.0000-0.3205j, -0.9473+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7040, 0.7040, 0.7040, 0.7040], requires_grad=True)
tensor([[-0.9474+0.0000j,  0.0000-0.3200j],
        [ 0.0000-0.3200j, -0.9474+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7041, 0.7041, 0.7041, 0.7041], requires_grad=True)
tensor([[-0.9476+0.0000j,  0.0000-0.3194j],
        [ 0.0000-0.3194j, -0.9476+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7043, 0.7043, 0.7043, 0.7043], requires_grad=True)
tensor([[-0.9478+0.0000j,  0.0000-0.3187j],
        [ 0.0000-0.3187j, -0.9478+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7045, 0.7045, 0.7045, 0.7045], requires_grad=True)
tensor([[-0.9481+0.0000j,  0.0000-0.3180j],
        [ 0.0000-0.3180j, -0.9481+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7047, 0.7047, 0.7047, 0.7047], requires_grad=True)
tensor([[-0.9484+0.0000j,  0.0000-0.3172j],
        [ 0.0000-0.3172j, -0.9484+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7050, 0.7050, 0.7050, 0.7050], requires_grad=True)
tensor([[-0.9487+0.0000j,  0.0000-0.3163j],
        [ 0.0000-0.3163j, -0.9487+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7052, 0.7052, 0.7052, 0.7052], requires_grad=True)
tensor([[-0.9490+0.0000j,  0.0000-0.3153j],
        [ 0.0000-0.3153j, -0.9490+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7055, 0.7055, 0.7055, 0.7055], requires_grad=True)
tensor([[-0.9493+0.0000j,  0.0000-0.3143j],
        [ 0.0000-0.3143j, -0.9493+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7057, 0.7057, 0.7057, 0.7057], requires_grad=True)
tensor([[-0.9497+0.0000j,  0.0000-0.3133j],
        [ 0.0000-0.3133j, -0.9497+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7060, 0.7060, 0.7060, 0.7060], requires_grad=True)
tensor([[-0.9500+0.0000j,  0.0000-0.3123j],
        [ 0.0000-0.3123j, -0.9500+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7063, 0.7063, 0.7063, 0.7063], requires_grad=True)
tensor([[-0.9503+0.0000j,  0.0000-0.3112j],
        [ 0.0000-0.3112j, -0.9503+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7066, 0.7066, 0.7066, 0.7066], requires_grad=True)
tensor([[-0.9507+0.0000j,  0.0000-0.3101j],
        [ 0.0000-0.3101j, -0.9507+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
Parameter containing:
tensor([0.7068, 0.7068, 0.7068, 0.7068], requires_grad=True)
tensor([[-0.9510+0.0000j,  0.0000-0.3091j],
        [ 0.0000-0.3091j, -0.9510+0.0000j]], grad_fn=&lt;MmBackward0&gt;)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x7fdcc725dc10&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_ICCAD22_tutorial_sec2_pulse_10_2.png" src="../../_images/examples_ICCAD22_tutorial_sec2_pulse_10_2.png" />
</div>
</div>
<p>Since the pulses are generated in an iterative way. The initialization of pulses will influence the number of iterations. It would be great if we can choose a better starting point. Intuitively, if pulses are initialized from a close or similar target unitary matrix, we will able to reduce the number of iterations. In the following example, we simply show that the pulses are initialized from previous unitary matrix and it can help achieve convergence faster.</p>
</section>
<section id="2.2-Variational-Pulse-Learning">
<h1><strong>2.2 Variational Pulse Learning</strong><a class="headerlink" href="#2.2-Variational-Pulse-Learning" title="Link to this heading">#</a></h1>
<p>Varitional pulse control schme is designed to avoid drawbacks of gate level approaches as well as quantum optimal control. We try to find a intermdiate level of pulse control abstraction and post optimization algorithms to improve the pulses and finally achieves better performance on quantum algorithm on NISQ machines.</p>
<section id="Native-Pulse-Build-up">
<h2><strong>Native Pulse Build-up</strong><a class="headerlink" href="#Native-Pulse-Build-up" title="Link to this heading">#</a></h2>
<p>Set the backend, please note that pulse is hardware dependent, it varying with every calibration and also different with devices.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">backend</span> <span class="o">=</span> <span class="n">FakeJakarta</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>SNP is namly a single-qubit native pulse, and TNP is two-qubit native pulse, we use this as a example to build the pulse ansatz for VQE task.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sched0</span> <span class="o">=</span> <span class="n">snp</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">backend</span><span class="p">)</span>
<span class="n">sched0</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_ICCAD22_tutorial_sec2_pulse_18_0.png" src="../../_images/examples_ICCAD22_tutorial_sec2_pulse_18_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sched1</span> <span class="o">=</span> <span class="n">snp</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">backend</span><span class="p">)</span>
<span class="n">sched1</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_ICCAD22_tutorial_sec2_pulse_19_0.png" src="../../_images/examples_ICCAD22_tutorial_sec2_pulse_19_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sched2</span> <span class="o">=</span> <span class="n">tnp</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">backend</span><span class="p">)</span>
<span class="n">sched2</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_ICCAD22_tutorial_sec2_pulse_20_0.png" src="../../_images/examples_ICCAD22_tutorial_sec2_pulse_20_0.png" />
</div>
</div>
<p>pul_append is a method to combine two schedules.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pulse_ansatz</span> <span class="o">=</span> <span class="n">pul_append</span><span class="p">(</span><span class="n">sched0</span><span class="p">,</span> <span class="n">sched1</span><span class="p">)</span>
<span class="n">pulse_ansatz</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_ICCAD22_tutorial_sec2_pulse_22_0.png" src="../../_images/examples_ICCAD22_tutorial_sec2_pulse_22_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pulse_ansatz</span> <span class="o">=</span> <span class="n">pul_append</span><span class="p">(</span><span class="n">pulse_ansatz</span><span class="p">,</span> <span class="n">sched2</span><span class="p">)</span>
<span class="n">pulse_ansatz</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_ICCAD22_tutorial_sec2_pulse_23_0.png" src="../../_images/examples_ICCAD22_tutorial_sec2_pulse_23_0.png" />
</div>
</div>
<p>In torchquantum, extract_amp can use to get the amplitudes from pulses, you can also choose extract_realamp for only the real part of pulse amplitudes and ignore the imaginary part. We also have extract_phase to get the classical phase from pulses.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">parameters_array</span> <span class="o">=</span> <span class="n">extract_amp</span><span class="p">(</span><span class="n">pulse_ansatz</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">parameters_array</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[ 0.1007186   0.00833101  0.096837    0.02080554  0.20122114 -1.57079633
  0.096837    0.02080554  0.11225338  0.01509274  0.7727792  -2.96348159
  0.20122114  0.          0.11225338 -3.12649991  0.7727792   0.17811106]
</pre></div></div>
</div>
</section>
<section id="VQE-Model-Setup">
<h2><strong>VQE Model Setup</strong><a class="headerlink" href="#VQE-Model-Setup" title="Link to this heading">#</a></h2>
<p>Here we use an example of Hydrogen molecule. And we give a pauli string here based on sto3g basis and with parity mapping as well as two-qubit reduction.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">n_qubit</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">pauli_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;II&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.0523732</span><span class="p">,</span> <span class="s1">&#39;IZ&#39;</span><span class="p">:</span> <span class="mf">0.39793742</span><span class="p">,</span> <span class="s1">&#39;ZI&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.3979374</span><span class="p">,</span> <span class="s1">&#39;ZZ&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.0112801</span><span class="p">,</span> <span class="s1">&#39;XX&#39;</span><span class="p">:</span><span class="mf">0.18093119</span><span class="p">}</span>
</pre></div>
</div>
</div>
<p>map_amp is a method in torchquantum introduce to map the adjusted amplitude to the pulses then get new pulses and send to quantum machine. observe_generate is a method to genrate the observe-pulses of the hydrogen molecule. run_pulse_sim is use to run the updated pulses in pulse simulator.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">vqe</span><span class="p">(</span><span class="n">cur_best_w</span><span class="p">):</span>
    <span class="n">backend</span> <span class="o">=</span> <span class="n">FakeJakarta</span><span class="p">()</span>
    <span class="n">modified_list</span> <span class="o">=</span> <span class="p">((</span><span class="n">cur_best_w</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cur_best_w</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">cur_best_w</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cur_best_w</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">):])</span> <span class="o">+</span> <span class="p">(</span><span class="n">cur_best_w</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cur_best_w</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">cur_best_w</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cur_best_w</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">):])</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="p">)</span>
    <span class="n">modified_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">.</span><span class="n">tolist</span><span class="p">(</span><span class="n">modified_list</span><span class="p">)</span>
    <span class="n">sched1</span> <span class="o">=</span> <span class="n">snp</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">backend</span><span class="p">)</span>
    <span class="n">sched2</span> <span class="o">=</span> <span class="n">tnp</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">backend</span><span class="p">)</span>
    <span class="n">pulse_ansatz</span> <span class="o">=</span> <span class="n">pul_append</span><span class="p">(</span><span class="n">sched1</span><span class="p">,</span> <span class="n">sched2</span><span class="p">)</span>
    <span class="n">prepulse</span> <span class="o">=</span> <span class="n">map_amp</span><span class="p">(</span><span class="n">pulse_ansatz</span><span class="p">,</span> <span class="n">modified_list</span><span class="p">)</span>
    <span class="n">measurement_pulse</span> <span class="o">=</span> <span class="n">observe_genearte</span><span class="p">(</span><span class="n">prepulse</span><span class="p">,</span> <span class="n">backend</span><span class="p">)</span>
    <span class="n">XX_YY_ZZ_expect</span> <span class="o">=</span> <span class="n">run_pulse_sim</span><span class="p">(</span><span class="n">measurement_pulse</span><span class="p">)</span>
    <span class="n">H_expect</span> <span class="o">=</span> <span class="n">pauli_dict</span><span class="p">[</span><span class="s1">&#39;II&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">pauli_dict</span><span class="p">[</span><span class="s1">&#39;IZ&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">XX_YY_ZZ_expect</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">pauli_dict</span><span class="p">[</span><span class="s1">&#39;ZI&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">XX_YY_ZZ_expect</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">pauli_dict</span><span class="p">[</span><span class="s1">&#39;XX&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">XX_YY_ZZ_expect</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">pauli_dict</span><span class="p">[</span><span class="s1">&#39;ZZ&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">XX_YY_ZZ_expect</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">H_expect</span>
</pre></div>
</div>
</div>
<p>Note, here we use COBYLA as the optimizer to train the pulse ansatz.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">vqe_result</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">vqe</span><span class="p">,</span> <span class="n">parameters_array</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;COBYLA&#39;</span><span class="p">,</span> <span class="n">constraints</span><span class="o">=</span><span class="n">gen_LC</span><span class="p">(</span><span class="n">parameters_array</span><span class="p">),</span>
                        <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;rhobeg&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s1">&#39;maxiter&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;disp&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The estimated ground state energy from pulse level VQE algorithm is: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">vqe_result</span><span class="o">.</span><span class="n">fun</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The optimal parameter theta is : </span><span class="si">{}</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">vqe_result</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/usr/local/lib/python3.7/dist-packages/qiskit/compiler/assembler.py:461: RuntimeWarning: Dynamic rep rates are supported on this backend. &#39;rep_delay&#39; will be used instead of &#39;rep_time&#39;.
  RuntimeWarning,
</pre></div></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2021, Hanrui Wang
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=2709fde1"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=32e29ea5"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>