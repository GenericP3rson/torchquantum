<!doctype html>
<html class="no-js" lang="en" data-content_root="../../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2023.09.10 -->
        <title>torchquantum.layer.layers - TorchQuantum 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=362ab14a" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">TorchQuantum 0.1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../index.html">
  
  
  <span class="sidebar-brand-text">TorchQuantum 0.1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api_torchquantum.html">torchquantum</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../api_functional.html">torchquantum.functional</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of torchquantum.functional</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.apply_unitary_einsum.html">apply_unitary_einsum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.apply_unitary_bmm.html">apply_unitary_bmm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.gate_wrapper.html">gate_wrapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.reset.html">reset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.hadamard.html">hadamard</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.shadamard.html">shadamard</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.paulix.html">paulix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.pauliy.html">pauliy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.pauliz.html">pauliz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.i.html">i</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.s.html">s</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.t.html">t</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.sx.html">sx</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.cnot.html">cnot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.cz.html">cz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.cy.html">cy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.rx.html">rx</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.ry.html">ry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.rz.html">rz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.rxx.html">rxx</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.ryy.html">ryy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.rzz.html">rzz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.zz.html">zz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.rzx.html">rzx</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.zx.html">zx</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.swap.html">swap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.sswap.html">sswap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.cswap.html">cswap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.toffoli.html">toffoli</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.phaseshift.html">phaseshift</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.p.html">p</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.cp.html">cp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.rot.html">rot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.multirz.html">multirz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.crx.html">crx</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.cry.html">cry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.crz.html">crz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.crot.html">crot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.u1.html">u1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.u2.html">u2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.u3.html">u3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.u.html">u</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.cu1.html">cu1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.cu2.html">cu2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.cu3.html">cu3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.cu.html">cu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.qubitunitary.html">qubitunitary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.qubitunitaryfast.html">qubitunitaryfast</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.qubitunitarystrict.html">qubitunitarystrict</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.multicnot.html">multicnot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.multixcnot.html">multixcnot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.x.html">x</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.y.html">y</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.z.html">z</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.zz.html">zz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.cx.html">cx</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.ccnot.html">ccnot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.ccx.html">ccx</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.reset.html">reset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.singleexcitation.html">singleexcitation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.ecr.html">ecr</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.echoedcrossresonance.html">echoedcrossresonance</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../api_operators.html">torchquantum.operators</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of torchquantum.operators</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.Operator.html">Operator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.Observable.html">Observable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.Operation.html">Operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.DiagonalOperation.html">DiagonalOperation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.Hadamard.html">Hadamard</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.SHadamard.html">SHadamard</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.PauliX.html">PauliX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.PauliY.html">PauliY</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.PauliZ.html">PauliZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.I.html">I</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.S.html">S</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.T.html">T</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.SX.html">SX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.CNOT.html">CNOT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.CZ.html">CZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.CY.html">CY</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.RX.html">RX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.RY.html">RY</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.RZ.html">RZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.RXX.html">RXX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.RYY.html">RYY</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.RZZ.html">RZZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.RZX.html">RZX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.SWAP.html">SWAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.SSWAP.html">SSWAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.CSWAP.html">CSWAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.Toffoli.html">Toffoli</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.PhaseShift.html">PhaseShift</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.Rot.html">Rot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.MultiRZ.html">MultiRZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.CRX.html">CRX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.CRY.html">CRY</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.CRZ.html">CRZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.CRot.html">CRot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.U1.html">U1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.U2.html">U2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.U3.html">U3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.CU1.html">CU1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.CU2.html">CU2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.CU3.html">CU3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.QubitUnitary.html">QubitUnitary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.QubitUnitaryFast.html">QubitUnitaryFast</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.TrainableUnitary.html">TrainableUnitary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.TrainableUnitaryStrict.html">TrainableUnitaryStrict</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.MultiCNOT.html">MultiCNOT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.MultiXCNOT.html">MultiXCNOT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.Reset.html">Reset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.SingleExcitation.html">SingleExcitation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.EchoedCrossResonance.html">EchoedCrossResonance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.ECR.html">ECR</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../api_layers.html">torchquantum.layers</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of torchquantum.layers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.layer.QuantumModuleFromOps.html">QuantumModuleFromOps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.layer.TrainableOpAll.html">TrainableOpAll</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.layer.ClassicalInOpAll.html">ClassicalInOpAll</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.layer.FixedOpAll.html">FixedOpAll</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.layer.TwoQAll.html">TwoQAll</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.layer.RandomLayer.html">RandomLayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.layer.RandomLayerAllTypes.html">RandomLayerAllTypes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.layer.Op1QAllLayer.html">Op1QAllLayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.layer.RandomOp1All.html">RandomOp1All</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.layer.Op2QAllLayer.html">Op2QAllLayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.layer.Op2QButterflyLayer.html">Op2QButterflyLayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.layer.Op2QDenseLayer.html">Op2QDenseLayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.layer.CXLayer.html">CXLayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.layer.CXCXCXLayer.html">CXCXCXLayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.layer.SWAPSWAPLayer.html">SWAPSWAPLayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.layer.RXYZCXLayer0.html">RXYZCXLayer0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.layer.QFTLayer.html">QFTLayer</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../usage_installation.html">Installation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../examples/index.html">TorchQuantum Examples</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of TorchQuantum Examples</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/gradient_pruning/probabilistic_gradient_pruning.html">Probabilistic gradient pruning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/param_shift_onchip_training/param_shift_onchip_training.html">Apply parameters shift rules to train quantum model using TorchQuantum.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/quantum_kernel_method/quantum_kernel_method.html">Quantum Kernel Methods for IRIS dataset classification with TorchQuantum.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/quanvolution/quanvolution.html">Quanvolution (Quantum convolution) for MNIST image classification with TorchQuantum.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/superdense_coding/superdense_coding_torchquantum.html">Superdense Coding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/superdense_coding/superdense_coding_torchquantum.html#References:">References:</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <h1>Source code for torchquantum.layer.layers</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">MIT License</span>

<span class="sd">Copyright (c) 2020-present TorchQuantum Authors</span>

<span class="sd">Permission is hereby granted, free of charge, to any person obtaining a copy</span>
<span class="sd">of this software and associated documentation files (the &quot;Software&quot;), to deal</span>
<span class="sd">in the Software without restriction, including without limitation the rights</span>
<span class="sd">to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</span>
<span class="sd">copies of the Software, and to permit persons to whom the Software is</span>
<span class="sd">furnished to do so, subject to the following conditions:</span>

<span class="sd">The above copyright notice and this permission notice shall be included in all</span>
<span class="sd">copies or substantial portions of the Software.</span>

<span class="sd">THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<span class="sd">IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span class="sd">FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span>
<span class="sd">AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span>
<span class="sd">LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span>
<span class="sd">OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE</span>
<span class="sd">SOFTWARE.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">torchquantum</span> <span class="k">as</span> <span class="nn">tq</span>
<span class="kn">import</span> <span class="nn">torchquantum.functional</span> <span class="k">as</span> <span class="nn">tqf</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Iterable</span>
<span class="kn">from</span> <span class="nn">torchquantum.plugin.qiskit</span> <span class="kn">import</span> <span class="n">QISKIT_INCOMPATIBLE_FUNC_NAMES</span>
<span class="kn">from</span> <span class="nn">torchpack.utils.logging</span> <span class="kn">import</span> <span class="n">logger</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;QuantumModuleFromOps&quot;</span><span class="p">,</span>
    <span class="s2">&quot;TrainableOpAll&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ClassicalInOpAll&quot;</span><span class="p">,</span>
    <span class="s2">&quot;FixedOpAll&quot;</span><span class="p">,</span>
    <span class="s2">&quot;TwoQAll&quot;</span><span class="p">,</span>
    <span class="s2">&quot;RandomLayer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;RandomLayerAllTypes&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Op1QAllLayer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;RandomOp1All&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Op2QAllLayer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Op2QButterflyLayer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Op2QDenseLayer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;layer_name_dict&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CXLayer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CXCXCXLayer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SWAPSWAPLayer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;RXYZCXLayer0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;QFTLayer&quot;</span><span class="p">,</span>
<span class="p">]</span>


<div class="viewcode-block" id="QuantumModuleFromOps">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.QuantumModuleFromOps.html#torchquantum.layer.QuantumModuleFromOps">[docs]</a>
<span class="k">class</span> <span class="nc">QuantumModuleFromOps</span><span class="p">(</span><span class="n">tq</span><span class="o">.</span><span class="n">QuantumModule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes a QuantumModuleFromOps instance.</span>

<span class="sd">            Args:</span>
<span class="sd">                ops (List[tq.Operation]): List of quantum operations.</span>

<span class="sd">            &quot;&quot;&quot;</span>
<div class="viewcode-block" id="QuantumModuleFromOps.__init__">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.QuantumModuleFromOps.html#torchquantum.layer.QuantumModuleFromOps.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ops</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ops</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumModuleList</span><span class="p">(</span><span class="n">ops</span><span class="p">)</span></div>


<div class="viewcode-block" id="QuantumModuleFromOps.forward">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.QuantumModuleFromOps.html#torchquantum.layer.QuantumModuleFromOps.forward">[docs]</a>
    <span class="nd">@tq</span><span class="o">.</span><span class="n">static_support</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q_device</span><span class="p">:</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumDevice</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Performs the forward pass of the quantum module.</span>

<span class="sd">               Args:</span>
<span class="sd">                   q_device (tq.QuantumDevice): Quantum device to apply the operations on.</span>

<span class="sd">               Returns:</span>
<span class="sd">                   None</span>

<span class="sd">               &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">q_device</span> <span class="o">=</span> <span class="n">q_device</span>
        <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ops</span><span class="p">:</span>
            <span class="n">op</span><span class="p">(</span><span class="n">q_device</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="TrainableOpAll">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.TrainableOpAll.html#torchquantum.layer.TrainableOpAll">[docs]</a>
<span class="k">class</span> <span class="nc">TrainableOpAll</span><span class="p">(</span><span class="n">tq</span><span class="o">.</span><span class="n">QuantumModule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Rotation rx on all qubits</span>
<span class="sd">    The rotation angle is a parameter of each rotation gate</span>
<span class="sd">    One potential optimization is to compute the unitary of all gates</span>
<span class="sd">    together.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="TrainableOpAll.__init__">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.TrainableOpAll.html#torchquantum.layer.TrainableOpAll.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_gate</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">op</span><span class="p">:</span> <span class="n">tq</span><span class="o">.</span><span class="n">Operation</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_gate</span> <span class="o">=</span> <span class="n">n_gate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gate_all</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ModuleList</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_gate</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gate_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">op</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span></div>


<div class="viewcode-block" id="TrainableOpAll.forward">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.TrainableOpAll.html#torchquantum.layer.TrainableOpAll.forward">[docs]</a>
    <span class="nd">@tq</span><span class="o">.</span><span class="n">static_support</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q_device</span><span class="p">:</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumDevice</span><span class="p">):</span>
        <span class="c1"># rx on all wires, assert the number of gate is the same as the number</span>
        <span class="c1"># of wires in the device.</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_gate</span> <span class="o">==</span> <span class="n">q_device</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Number of rx gates (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_gate</span><span class="si">}</span><span class="s2">) is different from number &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;of wires (</span><span class="si">{</span><span class="n">q_device</span><span class="o">.</span><span class="n">n_wires</span><span class="si">}</span><span class="s2">)!&quot;</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_gate</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gate_all</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">q_device</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">k</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="ClassicalInOpAll">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.ClassicalInOpAll.html#torchquantum.layer.ClassicalInOpAll">[docs]</a>
<span class="k">class</span> <span class="nc">ClassicalInOpAll</span><span class="p">(</span><span class="n">tq</span><span class="o">.</span><span class="n">QuantumModule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Quantum module that applies the same quantum operation to all wires of a quantum device,</span>
<span class="sd">      where the parameters of the operation are obtained from a classical input.</span>

<span class="sd">      Args:</span>
<span class="sd">          n_gate (int): Number of gates.</span>
<span class="sd">          op (tq.Operator): Quantum operation to be applied.</span>

<span class="sd">      Attributes:</span>
<span class="sd">          n_gate (int): Number of gates.</span>
<span class="sd">          gate_all (nn.ModuleList): List of quantum operations.</span>

<span class="sd">      &quot;&quot;&quot;</span>
<div class="viewcode-block" id="ClassicalInOpAll.__init__">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.ClassicalInOpAll.html#torchquantum.layer.ClassicalInOpAll.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_gate</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">op</span><span class="p">:</span> <span class="n">tq</span><span class="o">.</span><span class="n">Operator</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_gate</span> <span class="o">=</span> <span class="n">n_gate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gate_all</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ModuleList</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_gate</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gate_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">op</span><span class="p">())</span></div>


<div class="viewcode-block" id="ClassicalInOpAll.forward">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.ClassicalInOpAll.html#torchquantum.layer.ClassicalInOpAll.forward">[docs]</a>
    <span class="nd">@tq</span><span class="o">.</span><span class="n">static_support</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q_device</span><span class="p">:</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumDevice</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">               Performs the forward pass of the classical input quantum operation module.</span>

<span class="sd">               Args:</span>
<span class="sd">                   q_device (tq.QuantumDevice): Quantum device to apply the operations on.</span>
<span class="sd">                   x (torch.Tensor): Classical input of shape (batch_size, n_gate).</span>

<span class="sd">               Returns:</span>
<span class="sd">                   None</span>

<span class="sd">               Raises:</span>
<span class="sd">                   AssertionError: If the number of gates is different from the number of wires in the device.</span>

<span class="sd">               &quot;&quot;&quot;</span>
        <span class="c1"># rx on all wires, assert the number of gate is the same as the number</span>
        <span class="c1"># of wires in the device.</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_gate</span> <span class="o">==</span> <span class="n">q_device</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Number of rx gates (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_gate</span><span class="si">}</span><span class="s2">) is different from number &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;of wires (</span><span class="si">{</span><span class="n">q_device</span><span class="o">.</span><span class="n">n_wires</span><span class="si">}</span><span class="s2">)!&quot;</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_gate</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gate_all</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">q_device</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="n">k</span><span class="p">])</span></div>
</div>



<div class="viewcode-block" id="FixedOpAll">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.FixedOpAll.html#torchquantum.layer.FixedOpAll">[docs]</a>
<span class="k">class</span> <span class="nc">FixedOpAll</span><span class="p">(</span><span class="n">tq</span><span class="o">.</span><span class="n">QuantumModule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">       Quantum module that applies the same fixed quantum operation to all wires of a quantum device.</span>

<span class="sd">       Args:</span>
<span class="sd">           n_gate (int): Number of gates.</span>
<span class="sd">           op (tq.Operator): Quantum operation to be applied.</span>

<span class="sd">       Attributes:</span>
<span class="sd">           n_gate (int): Number of gates.</span>
<span class="sd">           gate_all (nn.ModuleList): List of quantum operations.</span>

<span class="sd">       &quot;&quot;&quot;</span>
<div class="viewcode-block" id="FixedOpAll.__init__">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.FixedOpAll.html#torchquantum.layer.FixedOpAll.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_gate</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">op</span><span class="p">:</span> <span class="n">tq</span><span class="o">.</span><span class="n">Operator</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_gate</span> <span class="o">=</span> <span class="n">n_gate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gate_all</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ModuleList</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_gate</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gate_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">op</span><span class="p">())</span></div>


<div class="viewcode-block" id="FixedOpAll.forward">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.FixedOpAll.html#torchquantum.layer.FixedOpAll.forward">[docs]</a>
    <span class="nd">@tq</span><span class="o">.</span><span class="n">static_support</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q_device</span><span class="p">:</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumDevice</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                Performs the forward pass of the fixed quantum operation module.</span>

<span class="sd">                Args:</span>
<span class="sd">                    q_device (tq.QuantumDevice): Quantum device to apply the operations on.</span>

<span class="sd">                Returns:</span>
<span class="sd">                    None</span>

<span class="sd">                Raises:</span>
<span class="sd">                    AssertionError: If the number of gates is different from the number of wires in the device.</span>

<span class="sd">                &quot;&quot;&quot;</span>
        <span class="c1"># rx on all wires, assert the number of gate is the same as the number</span>
        <span class="c1"># of wires in the device.</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_gate</span> <span class="o">==</span> <span class="n">q_device</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Number of rx gates (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_gate</span><span class="si">}</span><span class="s2">) is different from number &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;of wires (</span><span class="si">{</span><span class="n">q_device</span><span class="o">.</span><span class="n">n_wires</span><span class="si">}</span><span class="s2">)!&quot;</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_gate</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gate_all</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">q_device</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">k</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="TwoQAll">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.TwoQAll.html#torchquantum.layer.TwoQAll">[docs]</a>
<span class="k">class</span> <span class="nc">TwoQAll</span><span class="p">(</span><span class="n">tq</span><span class="o">.</span><span class="n">QuantumModule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Quantum module that applies a two-qubit quantum operation to adjacent pairs of wires in a quantum device.</span>

<span class="sd">        Args:</span>
<span class="sd">            n_gate (int): Number of adjacent pairs of wires.</span>
<span class="sd">            op (tq.Operator): Two-qubit quantum operation to be applied.</span>

<span class="sd">        Attributes:</span>
<span class="sd">            n_gate (int): Number of adjacent pairs of wires.</span>
<span class="sd">            op (tq.Operator): Two-qubit quantum operation.</span>

<span class="sd">        &quot;&quot;&quot;</span>
<div class="viewcode-block" id="TwoQAll.__init__">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.TwoQAll.html#torchquantum.layer.TwoQAll.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_gate</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">op</span><span class="p">:</span> <span class="n">tq</span><span class="o">.</span><span class="n">Operator</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_gate</span> <span class="o">=</span> <span class="n">n_gate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">op</span> <span class="o">=</span> <span class="n">op</span><span class="p">()</span></div>


<div class="viewcode-block" id="TwoQAll.forward">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.TwoQAll.html#torchquantum.layer.TwoQAll.forward">[docs]</a>
    <span class="nd">@tq</span><span class="o">.</span><span class="n">static_support</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q_device</span><span class="p">:</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumDevice</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_gate</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">op</span><span class="p">(</span><span class="n">q_device</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">op</span><span class="p">(</span><span class="n">q_device</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n_gate</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span></div>
</div>



<div class="viewcode-block" id="RandomOp1All">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.RandomOp1All.html#torchquantum.layer.RandomOp1All">[docs]</a>
<span class="k">class</span> <span class="nc">RandomOp1All</span><span class="p">(</span><span class="n">tq</span><span class="o">.</span><span class="n">QuantumModule</span><span class="p">):</span>
<div class="viewcode-block" id="RandomOp1All.__init__">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.RandomOp1All.html#torchquantum.layer.RandomOp1All.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">n_wires</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">op_types</span><span class="o">=</span><span class="p">(</span><span class="n">tq</span><span class="o">.</span><span class="n">RX</span><span class="p">,</span> <span class="n">tq</span><span class="o">.</span><span class="n">RY</span><span class="p">,</span> <span class="n">tq</span><span class="o">.</span><span class="n">RZ</span><span class="p">),</span> <span class="n">op_ratios</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Layer adding a random gate to all wires</span>

<span class="sd">        Params:</span>
<span class="sd">            n_wires (int): number of wires/gates in integer format</span>
<span class="sd">            op_types (Iterable): single-wire gates to select from in iterable format</span>
<span class="sd">            op_ratios (Iterable): probabilities to select each gate option in iterable format</span>
<span class="sd">            seed (int): random seed in integer format</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span> <span class="o">=</span> <span class="n">n_wires</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">op_types</span> <span class="o">=</span> <span class="n">op_types</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">op_ratios</span> <span class="o">=</span> <span class="n">op_ratios</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gate_all</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ModuleList</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">build_random_layer</span><span class="p">()</span></div>


<div class="viewcode-block" id="RandomOp1All.build_random_layer">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.RandomOp1All.html#torchquantum.layer.RandomOp1All.build_random_layer">[docs]</a>
    <span class="k">def</span> <span class="nf">build_random_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">):</span>
            <span class="n">op</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">op_types</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">op_ratios</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gate_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">op</span><span class="p">())</span></div>


<div class="viewcode-block" id="RandomOp1All.forward">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.RandomOp1All.html#torchquantum.layer.RandomOp1All.forward">[docs]</a>
    <span class="nd">@tq</span><span class="o">.</span><span class="n">static_support</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q_device</span><span class="p">:</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumDevice</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="c1"># op on all wires, assert the number of gate is the same as the number</span>
        <span class="c1"># of wires in the device.</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_gate</span> <span class="o">==</span> <span class="n">q_device</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Number of gates (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="si">}</span><span class="s2">) is different from number &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;of wires (</span><span class="si">{</span><span class="n">q_device</span><span class="o">.</span><span class="n">n_wires</span><span class="si">}</span><span class="s2">)!&quot;</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gate_all</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">q_device</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">x</span><span class="p">[:,</span> <span class="n">k</span><span class="p">])</span></div>
</div>



<div class="viewcode-block" id="RandomLayer">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.RandomLayer.html#torchquantum.layer.RandomLayer">[docs]</a>
<span class="k">class</span> <span class="nc">RandomLayer</span><span class="p">(</span><span class="n">tq</span><span class="o">.</span><span class="n">QuantumModule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Quantum module that represents a random layer of quantum operations applied to specified wires.</span>

<span class="sd">        Args:</span>
<span class="sd">            wires (int or Iterable[int]): Indices of the wires the operations are applied to.</span>
<span class="sd">            n_ops (int): Number of random operations in the layer.</span>
<span class="sd">            n_params (int): Number of parameters for each random operation.</span>
<span class="sd">            op_ratios (list or float): Ratios determining the relative frequencies of different operation types.</span>
<span class="sd">            op_types (tuple or tq.Operator): Types of random operations to be included in the layer.</span>
<span class="sd">            seed (int): Seed for random number generation.</span>
<span class="sd">            qiskit_compatible (bool): Flag indicating whether the layer should be compatible with Qiskit.</span>

<span class="sd">        Attributes:</span>
<span class="sd">            n_ops (int): Number of random operations in the layer.</span>
<span class="sd">            n_params (int): Number of parameters for each random operation.</span>
<span class="sd">            wires (list): Indices of the wires the operations are applied to.</span>
<span class="sd">            n_wires (int): Number of wires.</span>
<span class="sd">            op_types (list): Types of random operations included in the layer.</span>
<span class="sd">            op_ratios (numpy.array): Ratios determining the relative frequencies of different operation types.</span>
<span class="sd">            seed (int): Seed for random number generation.</span>
<span class="sd">            op_list (tq.QuantumModuleList): List of random operations in the layer.</span>

<span class="sd">        &quot;&quot;&quot;</span>
<div class="viewcode-block" id="RandomLayer.__init__">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.RandomLayer.html#torchquantum.layer.RandomLayer.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">wires</span><span class="p">,</span>
        <span class="n">n_ops</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">n_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">op_ratios</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">op_types</span><span class="o">=</span><span class="p">(</span><span class="n">tq</span><span class="o">.</span><span class="n">RX</span><span class="p">,</span> <span class="n">tq</span><span class="o">.</span><span class="n">RY</span><span class="p">,</span> <span class="n">tq</span><span class="o">.</span><span class="n">RZ</span><span class="p">,</span> <span class="n">tq</span><span class="o">.</span><span class="n">CNOT</span><span class="p">),</span>
        <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">qiskit_compatible</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_ops</span> <span class="o">=</span> <span class="n">n_ops</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_params</span> <span class="o">=</span> <span class="n">n_params</span>
        <span class="k">assert</span> <span class="n">n_params</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">n_ops</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wires</span> <span class="o">=</span> <span class="n">wires</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wires</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="k">else</span> <span class="p">[</span><span class="n">wires</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">wires</span><span class="p">)</span>

        <span class="n">op_types</span> <span class="o">=</span> <span class="n">op_types</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">op_types</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="k">else</span> <span class="p">[</span><span class="n">op_types</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">op_ratios</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">op_ratios</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">op_types</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">op_ratios</span> <span class="o">=</span> <span class="n">op_ratios</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">op_ratios</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="k">else</span> <span class="p">[</span><span class="n">op_ratios</span><span class="p">]</span>
        <span class="n">op_types_valid</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">op_ratios_valid</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">qiskit_compatible</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">op_type</span><span class="p">,</span> <span class="n">op_ratio</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">op_types</span><span class="p">,</span> <span class="n">op_ratios</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">op_type</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">QISKIT_INCOMPATIBLE_FUNC_NAMES</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Remove </span><span class="si">{</span><span class="n">op_type</span><span class="si">}</span><span class="s2"> from op_types to make &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;the layer qiskit-compatible.&quot;</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">op_types_valid</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">op_type</span><span class="p">)</span>
                    <span class="n">op_ratios_valid</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">op_ratio</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">op_types_valid</span> <span class="o">=</span> <span class="n">op_types</span>
            <span class="n">op_ratios_valid</span> <span class="o">=</span> <span class="n">op_ratios</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">op_types</span> <span class="o">=</span> <span class="n">op_types_valid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">op_ratios</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">op_ratios_valid</span><span class="p">)</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">op_ratios_valid</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">op_list</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumModuleList</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">build_random_layer</span><span class="p">()</span></div>


<div class="viewcode-block" id="RandomLayer.rebuild_random_layer_from_op_list">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.RandomLayer.html#torchquantum.layer.RandomLayer.rebuild_random_layer_from_op_list">[docs]</a>
    <span class="k">def</span> <span class="nf">rebuild_random_layer_from_op_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_ops_in</span><span class="p">,</span> <span class="n">wires_in</span><span class="p">,</span> <span class="n">op_list_in</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">           Rebuilds a random layer from the given operation list.</span>
<span class="sd">           This method is used for loading a random layer from a checkpoint.</span>

<span class="sd">           Args:</span>
<span class="sd">               n_ops_in (int): Number of operations in the layer.</span>
<span class="sd">               wires_in (list): Indices of the wires the operations are applied to.</span>
<span class="sd">               op_list_in (list): List of operations in the layer.</span>

<span class="sd">           &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">n_ops</span> <span class="o">=</span> <span class="n">n_ops_in</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wires</span> <span class="o">=</span> <span class="n">wires_in</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">op_list</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumModuleList</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">op_in</span> <span class="ow">in</span> <span class="n">op_list_in</span><span class="p">:</span>
            <span class="n">op</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">op_name_dict</span><span class="p">[</span><span class="n">op_in</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()](</span>
                <span class="n">has_params</span><span class="o">=</span><span class="n">op_in</span><span class="o">.</span><span class="n">has_params</span><span class="p">,</span>
                <span class="n">trainable</span><span class="o">=</span><span class="n">op_in</span><span class="o">.</span><span class="n">trainable</span><span class="p">,</span>
                <span class="n">wires</span><span class="o">=</span><span class="n">op_in</span><span class="o">.</span><span class="n">wires</span><span class="p">,</span>
                <span class="n">n_wires</span><span class="o">=</span><span class="n">op_in</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">op_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">op</span><span class="p">)</span></div>


<div class="viewcode-block" id="RandomLayer.build_random_layer">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.RandomLayer.html#torchquantum.layer.RandomLayer.build_random_layer">[docs]</a>
    <span class="k">def</span> <span class="nf">build_random_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">op_cnt</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">param_cnt</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">op</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">op_types</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">op_ratios</span><span class="p">)</span>
            <span class="n">n_op_wires</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">num_wires</span>
            <span class="k">if</span> <span class="n">n_op_wires</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">n_op_wires</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">is_AnyWire</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">n_op_wires</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">is_AnyWire</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="n">op_wires</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wires</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n_op_wires</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">is_AnyWire</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">op</span><span class="p">()</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;MultiRZ&quot;</span><span class="p">]:</span>
                    <span class="n">operation</span> <span class="o">=</span> <span class="n">op</span><span class="p">(</span>
                        <span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">n_wires</span><span class="o">=</span><span class="n">n_op_wires</span><span class="p">,</span>
                        <span class="n">wires</span><span class="o">=</span><span class="n">op_wires</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">operation</span> <span class="o">=</span> <span class="n">op</span><span class="p">(</span><span class="n">n_wires</span><span class="o">=</span><span class="n">n_op_wires</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">op_wires</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">op</span><span class="p">()</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">tq</span><span class="o">.</span><span class="n">Operator</span><span class="o">.</span><span class="n">parameterized_ops</span><span class="p">:</span>
                <span class="n">operation</span> <span class="o">=</span> <span class="n">op</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">op_wires</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">operation</span> <span class="o">=</span> <span class="n">op</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="n">op_wires</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">op_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">operation</span><span class="p">)</span>
            <span class="n">op_cnt</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">param_cnt</span> <span class="o">+=</span> <span class="n">op</span><span class="o">.</span><span class="n">num_params</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_ops</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">op_cnt</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_ops</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_ops</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_params</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">param_cnt</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_params</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="k">elif</span> <span class="n">param_cnt</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_params</span><span class="p">:</span>
<span class="w">                    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                    the last operation has too many params and exceed the</span>
<span class="sd">                    constraint, so need to remove it and sample another</span>
<span class="sd">                    &quot;&quot;&quot;</span>
                    <span class="n">op_cnt</span> <span class="o">-=</span> <span class="mi">1</span>
                    <span class="n">param_cnt</span> <span class="o">-=</span> <span class="n">op</span><span class="o">.</span><span class="n">num_params</span>
                    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">op_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span></div>


<div class="viewcode-block" id="RandomLayer.forward">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.RandomLayer.html#torchquantum.layer.RandomLayer.forward">[docs]</a>
    <span class="nd">@tq</span><span class="o">.</span><span class="n">static_support</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q_device</span><span class="p">:</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumDevice</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">op_list</span><span class="p">:</span>
            <span class="n">op</span><span class="p">(</span><span class="n">q_device</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="RandomLayerAllTypes">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.RandomLayerAllTypes.html#torchquantum.layer.RandomLayerAllTypes">[docs]</a>
<span class="k">class</span> <span class="nc">RandomLayerAllTypes</span><span class="p">(</span><span class="n">RandomLayer</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">       Random layer with a wide range of quantum gate types.</span>

<span class="sd">       This class extends the `RandomLayer` class to include a variety of quantum gate types as options for the random layer.</span>

<span class="sd">       Args:</span>
<span class="sd">           wires (int or list): Indices of the wires the operations are applied to.</span>
<span class="sd">           n_ops (int): Number of operations in the layer.</span>
<span class="sd">           n_params (int): Number of parameters for each operation.</span>
<span class="sd">           op_ratios (list): Ratios for selecting different types of operations.</span>
<span class="sd">           op_types (tuple): Types of operations to include in the layer.</span>
<span class="sd">           seed (int): Seed for the random number generator.</span>
<span class="sd">           qiskit_compatible (bool): Flag indicating whether the layer should be Qiskit-compatible.</span>

<span class="sd">       &quot;&quot;&quot;</span>
<div class="viewcode-block" id="RandomLayerAllTypes.__init__">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.RandomLayerAllTypes.html#torchquantum.layer.RandomLayerAllTypes.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">wires</span><span class="p">,</span>
        <span class="n">n_ops</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">n_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">op_ratios</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">op_types</span><span class="o">=</span><span class="p">(</span>
            <span class="n">tq</span><span class="o">.</span><span class="n">Hadamard</span><span class="p">,</span>
            <span class="n">tq</span><span class="o">.</span><span class="n">SHadamard</span><span class="p">,</span>
            <span class="n">tq</span><span class="o">.</span><span class="n">PauliX</span><span class="p">,</span>
            <span class="n">tq</span><span class="o">.</span><span class="n">PauliY</span><span class="p">,</span>
            <span class="n">tq</span><span class="o">.</span><span class="n">PauliZ</span><span class="p">,</span>
            <span class="n">tq</span><span class="o">.</span><span class="n">S</span><span class="p">,</span>
            <span class="n">tq</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
            <span class="n">tq</span><span class="o">.</span><span class="n">SX</span><span class="p">,</span>
            <span class="n">tq</span><span class="o">.</span><span class="n">CNOT</span><span class="p">,</span>
            <span class="n">tq</span><span class="o">.</span><span class="n">CZ</span><span class="p">,</span>
            <span class="n">tq</span><span class="o">.</span><span class="n">CY</span><span class="p">,</span>
            <span class="n">tq</span><span class="o">.</span><span class="n">RX</span><span class="p">,</span>
            <span class="n">tq</span><span class="o">.</span><span class="n">RY</span><span class="p">,</span>
            <span class="n">tq</span><span class="o">.</span><span class="n">RZ</span><span class="p">,</span>
            <span class="n">tq</span><span class="o">.</span><span class="n">RZZ</span><span class="p">,</span>
            <span class="n">tq</span><span class="o">.</span><span class="n">SWAP</span><span class="p">,</span>
            <span class="n">tq</span><span class="o">.</span><span class="n">CSWAP</span><span class="p">,</span>
            <span class="n">tq</span><span class="o">.</span><span class="n">Toffoli</span><span class="p">,</span>
            <span class="n">tq</span><span class="o">.</span><span class="n">PhaseShift</span><span class="p">,</span>
            <span class="n">tq</span><span class="o">.</span><span class="n">Rot</span><span class="p">,</span>
            <span class="n">tq</span><span class="o">.</span><span class="n">MultiRZ</span><span class="p">,</span>
            <span class="n">tq</span><span class="o">.</span><span class="n">CRX</span><span class="p">,</span>
            <span class="n">tq</span><span class="o">.</span><span class="n">CRY</span><span class="p">,</span>
            <span class="n">tq</span><span class="o">.</span><span class="n">CRZ</span><span class="p">,</span>
            <span class="n">tq</span><span class="o">.</span><span class="n">CRot</span><span class="p">,</span>
            <span class="n">tq</span><span class="o">.</span><span class="n">U1</span><span class="p">,</span>
            <span class="n">tq</span><span class="o">.</span><span class="n">U2</span><span class="p">,</span>
            <span class="n">tq</span><span class="o">.</span><span class="n">U3</span><span class="p">,</span>
            <span class="n">tq</span><span class="o">.</span><span class="n">MultiCNOT</span><span class="p">,</span>
            <span class="n">tq</span><span class="o">.</span><span class="n">MultiXCNOT</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">qiskit_compatible</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">wires</span><span class="o">=</span><span class="n">wires</span><span class="p">,</span>
            <span class="n">n_ops</span><span class="o">=</span><span class="n">n_ops</span><span class="p">,</span>
            <span class="n">n_params</span><span class="o">=</span><span class="n">n_params</span><span class="p">,</span>
            <span class="n">op_ratios</span><span class="o">=</span><span class="n">op_ratios</span><span class="p">,</span>
            <span class="n">op_types</span><span class="o">=</span><span class="n">op_types</span><span class="p">,</span>
            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
            <span class="n">qiskit_compatible</span><span class="o">=</span><span class="n">qiskit_compatible</span><span class="p">,</span>
        <span class="p">)</span></div>
</div>



<span class="k">class</span> <span class="nc">SimpleQLayer</span><span class="p">(</span><span class="n">tq</span><span class="o">.</span><span class="n">QuantumModule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">       Simple quantum layer consisting of three parameterized gates applied to specific wires.</span>

<span class="sd">       This class represents a simple quantum layer with three parameterized gates: RX, RY, and RZ. The gates are applied to specific wires in the quantum device.</span>

<span class="sd">       Args:</span>
<span class="sd">           n_wires (int): Number of wires in the quantum device.</span>

<span class="sd">       &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_wires</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span> <span class="o">=</span> <span class="n">n_wires</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gate1</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">RX</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gate2</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">RY</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gate3</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">RZ</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nd">@tq</span><span class="o">.</span><span class="n">static_support</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q_dev</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">q_device</span> <span class="o">=</span> <span class="n">q_dev</span>
        <span class="n">tqf</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="n">q_dev</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">static</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">static_mode</span><span class="p">,</span> <span class="n">parent_graph</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gate1</span><span class="p">(</span><span class="n">q_dev</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gate2</span><span class="p">(</span><span class="n">q_dev</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gate3</span><span class="p">(</span><span class="n">q_dev</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">tqf</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="n">q_dev</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">static</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">static_mode</span><span class="p">,</span> <span class="n">parent_graph</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>


<div class="viewcode-block" id="CXLayer">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.CXLayer.html#torchquantum.layer.CXLayer">[docs]</a>
<span class="k">class</span> <span class="nc">CXLayer</span><span class="p">(</span><span class="n">tq</span><span class="o">.</span><span class="n">QuantumModule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Quantum layer with a controlled-X (CX) gate applied to two specified wires.</span>

<span class="sd">        This class represents a quantum layer with a controlled-X (CX) gate applied to two specified wires in the quantum device.</span>

<span class="sd">        Args:</span>
<span class="sd">            n_wires (int): Number of wires in the quantum device.</span>

<span class="sd">        &quot;&quot;&quot;</span>
<div class="viewcode-block" id="CXLayer.__init__">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.CXLayer.html#torchquantum.layer.CXLayer.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_wires</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span> <span class="o">=</span> <span class="n">n_wires</span></div>


<div class="viewcode-block" id="CXLayer.forward">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.CXLayer.html#torchquantum.layer.CXLayer.forward">[docs]</a>
    <span class="nd">@tq</span><span class="o">.</span><span class="n">static_support</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q_dev</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">q_device</span> <span class="o">=</span> <span class="n">q_dev</span>
        <span class="n">tqf</span><span class="o">.</span><span class="n">cnot</span><span class="p">(</span><span class="n">q_dev</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">static</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">static_mode</span><span class="p">,</span> <span class="n">parent_graph</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="CXCXCXLayer">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.CXCXCXLayer.html#torchquantum.layer.CXCXCXLayer">[docs]</a>
<span class="k">class</span> <span class="nc">CXCXCXLayer</span><span class="p">(</span><span class="n">tq</span><span class="o">.</span><span class="n">QuantumModule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">       Quantum layer with a sequence of CX gates applied to three specified wires.</span>

<span class="sd">       This class represents a quantum layer with a sequence of CX gates applied to three specified wires in the quantum device.</span>

<span class="sd">       Args:</span>
<span class="sd">           n_wires (int): Number of wires in the quantum device.</span>

<span class="sd">       &quot;&quot;&quot;</span>
<div class="viewcode-block" id="CXCXCXLayer.__init__">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.CXCXCXLayer.html#torchquantum.layer.CXCXCXLayer.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_wires</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span> <span class="o">=</span> <span class="n">n_wires</span></div>


<div class="viewcode-block" id="CXCXCXLayer.forward">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.CXCXCXLayer.html#torchquantum.layer.CXCXCXLayer.forward">[docs]</a>
    <span class="nd">@tq</span><span class="o">.</span><span class="n">static_support</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q_dev</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">q_device</span> <span class="o">=</span> <span class="n">q_dev</span>
        <span class="n">tqf</span><span class="o">.</span><span class="n">cnot</span><span class="p">(</span><span class="n">q_dev</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">static</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">static_mode</span><span class="p">,</span> <span class="n">parent_graph</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>
        <span class="n">tqf</span><span class="o">.</span><span class="n">cnot</span><span class="p">(</span><span class="n">q_dev</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">static</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">static_mode</span><span class="p">,</span> <span class="n">parent_graph</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>
        <span class="n">tqf</span><span class="o">.</span><span class="n">cnot</span><span class="p">(</span><span class="n">q_dev</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">static</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">static_mode</span><span class="p">,</span> <span class="n">parent_graph</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="SWAPSWAPLayer">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.SWAPSWAPLayer.html#torchquantum.layer.SWAPSWAPLayer">[docs]</a>
<span class="k">class</span> <span class="nc">SWAPSWAPLayer</span><span class="p">(</span><span class="n">tq</span><span class="o">.</span><span class="n">QuantumModule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">       Quantum layer with a sequence of SWAP gates applied to two specified pairs of wires.</span>

<span class="sd">       This class represents a quantum layer with a sequence of SWAP gates applied to two specified pairs of wires in the quantum device.</span>

<span class="sd">       Args:</span>
<span class="sd">           n_wires (int): Number of wires in the quantum device.</span>

<span class="sd">       &quot;&quot;&quot;</span>
<div class="viewcode-block" id="SWAPSWAPLayer.__init__">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.SWAPSWAPLayer.html#torchquantum.layer.SWAPSWAPLayer.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_wires</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span> <span class="o">=</span> <span class="n">n_wires</span></div>


<div class="viewcode-block" id="SWAPSWAPLayer.forward">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.SWAPSWAPLayer.html#torchquantum.layer.SWAPSWAPLayer.forward">[docs]</a>
    <span class="nd">@tq</span><span class="o">.</span><span class="n">static_support</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q_dev</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">q_device</span> <span class="o">=</span> <span class="n">q_dev</span>
        <span class="n">tqf</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="n">q_dev</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">static</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">static_mode</span><span class="p">,</span> <span class="n">parent_graph</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>
        <span class="n">tqf</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="n">q_dev</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">static</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">static_mode</span><span class="p">,</span> <span class="n">parent_graph</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="Op1QAllLayer">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.Op1QAllLayer.html#torchquantum.layer.Op1QAllLayer">[docs]</a>
<span class="k">class</span> <span class="nc">Op1QAllLayer</span><span class="p">(</span><span class="n">tq</span><span class="o">.</span><span class="n">QuantumModule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Quantum layer applying the same single-qubit operation to all wires.</span>

<span class="sd">        This class represents a quantum layer that applies the same single-qubit operation to all wires in the quantum device.</span>

<span class="sd">        Args:</span>
<span class="sd">            op (tq.Operator): Single-qubit operation to be applied.</span>
<span class="sd">            n_wires (int): Number of wires in the quantum device.</span>
<span class="sd">            has_params (bool, optional): Flag indicating if the operation has parameters. Defaults to False.</span>
<span class="sd">            trainable (bool, optional): Flag indicating if the operation is trainable. Defaults to False.</span>

<span class="sd">        &quot;&quot;&quot;</span>
<div class="viewcode-block" id="Op1QAllLayer.__init__">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.Op1QAllLayer.html#torchquantum.layer.Op1QAllLayer.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">n_wires</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">has_params</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span> <span class="o">=</span> <span class="n">n_wires</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">op</span> <span class="o">=</span> <span class="n">op</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ops_all</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumModuleList</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_wires</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ops_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">op</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="n">has_params</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="n">trainable</span><span class="p">))</span></div>


<div class="viewcode-block" id="Op1QAllLayer.forward">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.Op1QAllLayer.html#torchquantum.layer.Op1QAllLayer.forward">[docs]</a>
    <span class="nd">@tq</span><span class="o">.</span><span class="n">static_support</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q_device</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ops_all</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">q_device</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">k</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="Op2QAllLayer">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.Op2QAllLayer.html#torchquantum.layer.Op2QAllLayer">[docs]</a>
<span class="k">class</span> <span class="nc">Op2QAllLayer</span><span class="p">(</span><span class="n">tq</span><span class="o">.</span><span class="n">QuantumModule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Quantum layer applying the same two-qubit operation to all pairs of adjacent wires.</span>
<span class="sd">        This class represents a quantum layer that applies the same two-qubit operation to all pairs of adjacent wires</span>
<span class="sd">        in the quantum device. The pairs of wires can be determined in a circular or non-circular pattern based on the</span>
<span class="sd">        specified jump.</span>

<span class="sd">        Args:</span>
<span class="sd">            op (tq.Operator): Two-qubit operation to be applied.</span>
<span class="sd">            n_wires (int): Number of wires in the quantum device.</span>
<span class="sd">            has_params (bool, optional): Flag indicating if the operation has parameters. Defaults to False.</span>
<span class="sd">            trainable (bool, optional): Flag indicating if the operation is trainable. Defaults to False.</span>
<span class="sd">            wire_reverse (bool, optional): Flag indicating if the order of wires in each pair should be reversed. Defaults to False.</span>
<span class="sd">            jump (int, optional): Number of positions to jump between adjacent pairs of wires. Defaults to 1.</span>
<span class="sd">            circular (bool, optional): Flag indicating if the pattern should be circular. Defaults to False.</span>

<span class="sd">    &quot;&quot;&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;pattern:</span>
<span class="sd">    circular = False</span>
<span class="sd">    jump = 1: [0, 1], [1, 2], [2, 3], [3, 4], [4, 5]</span>
<span class="sd">    jump = 2: [0, 2], [1, 3], [2, 4], [3, 5]</span>
<span class="sd">    jump = 3: [0, 3], [1, 4], [2, 5]</span>
<span class="sd">    jump = 4: [0, 4], [1, 5]</span>
<span class="sd">    jump = 5: [0, 5]</span>

<span class="sd">    circular = True</span>
<span class="sd">    jump = 1: [0, 1], [1, 2], [2, 3], [3, 4], [4, 5], [5, 0]</span>
<span class="sd">    jump = 2: [0, 2], [1, 3], [2, 4], [3, 5], [4, 0], [5, 1]</span>
<span class="sd">    jump = 3: [0, 3], [1, 4], [2, 5], [3, 0], [4, 1], [5, 2]</span>
<span class="sd">    jump = 4: [0, 4], [1, 5], [2, 0], [3, 1], [4, 2], [5, 3]</span>
<span class="sd">    jump = 5: [0, 5], [1, 0], [2, 1], [3, 2], [4, 3], [5, 4]</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Op2QAllLayer.__init__">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.Op2QAllLayer.html#torchquantum.layer.Op2QAllLayer.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">op</span><span class="p">,</span>
        <span class="n">n_wires</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">has_params</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">trainable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">wire_reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">jump</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">circular</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span> <span class="o">=</span> <span class="n">n_wires</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jump</span> <span class="o">=</span> <span class="n">jump</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">circular</span> <span class="o">=</span> <span class="n">circular</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">op</span> <span class="o">=</span> <span class="n">op</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ops_all</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumModuleList</span><span class="p">()</span>

        <span class="c1"># reverse the wires, for example from [1, 2] to [2, 1]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wire_reverse</span> <span class="o">=</span> <span class="n">wire_reverse</span>

        <span class="k">if</span> <span class="n">circular</span><span class="p">:</span>
            <span class="n">n_ops</span> <span class="o">=</span> <span class="n">n_wires</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n_ops</span> <span class="o">=</span> <span class="n">n_wires</span> <span class="o">-</span> <span class="n">jump</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_ops</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ops_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">op</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="n">has_params</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="n">trainable</span><span class="p">))</span></div>


<div class="viewcode-block" id="Op2QAllLayer.forward">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.Op2QAllLayer.html#torchquantum.layer.Op2QAllLayer.forward">[docs]</a>
    <span class="nd">@tq</span><span class="o">.</span><span class="n">static_support</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q_device</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ops_all</span><span class="p">)):</span>
            <span class="n">wires</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">jump</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">wire_reverse</span><span class="p">:</span>
                <span class="n">wires</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ops_all</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">q_device</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">wires</span><span class="p">)</span></div>
</div>



<span class="k">class</span> <span class="nc">Op2QFit32Layer</span><span class="p">(</span><span class="n">tq</span><span class="o">.</span><span class="n">QuantumModule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Quantum layer applying the same two-qubit operation to all pairs of adjacent wires, fitting to 32 operations.</span>

<span class="sd">        This class represents a quantum layer that applies the same two-qubit operation to all pairs of adjacent wires in the quantum device. The pairs of wires can be determined in a circular or non-circular pattern based on the specified jump. The layer is designed to fit to 32 operations by repeating the same operation pattern multiple times.</span>

<span class="sd">        Args:</span>
<span class="sd">            op (tq.Operator): Two-qubit operation to be applied.</span>
<span class="sd">            n_wires (int): Number of wires in the quantum device.</span>
<span class="sd">            has_params (bool, optional): Flag indicating if the operation has parameters. Defaults to False.</span>
<span class="sd">            trainable (bool, optional): Flag indicating if the operation is trainable. Defaults to False.</span>
<span class="sd">            wire_reverse (bool, optional): Flag indicating if the order of wires in each pair should be reversed. Defaults to False.</span>
<span class="sd">            jump (int, optional): Number of positions to jump between adjacent pairs of wires. Defaults to 1.</span>
<span class="sd">            circular (bool, optional): Flag indicating if the pattern should be circular. Defaults to False.</span>

<span class="sd">        &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">op</span><span class="p">,</span>
        <span class="n">n_wires</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">has_params</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">trainable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">wire_reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">jump</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">circular</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span> <span class="o">=</span> <span class="n">n_wires</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jump</span> <span class="o">=</span> <span class="n">jump</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">circular</span> <span class="o">=</span> <span class="n">circular</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">op</span> <span class="o">=</span> <span class="n">op</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ops_all</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumModuleList</span><span class="p">()</span>

        <span class="c1"># reverse the wires, for example from [1, 2] to [2, 1]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wire_reverse</span> <span class="o">=</span> <span class="n">wire_reverse</span>

        <span class="c1"># if circular:</span>
        <span class="c1">#     n_ops = n_wires</span>
        <span class="c1"># else:</span>
        <span class="c1">#     n_ops = n_wires - jump</span>
        <span class="n">n_ops</span> <span class="o">=</span> <span class="mi">32</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_ops</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ops_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">op</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="n">has_params</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="n">trainable</span><span class="p">))</span>

    <span class="nd">@tq</span><span class="o">.</span><span class="n">static_support</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q_device</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ops_all</span><span class="p">)):</span>
            <span class="n">wires</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span> <span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">jump</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">wire_reverse</span><span class="p">:</span>
                <span class="n">wires</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ops_all</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">q_device</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">wires</span><span class="p">)</span>


<div class="viewcode-block" id="Op2QButterflyLayer">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.Op2QButterflyLayer.html#torchquantum.layer.Op2QButterflyLayer">[docs]</a>
<span class="k">class</span> <span class="nc">Op2QButterflyLayer</span><span class="p">(</span><span class="n">tq</span><span class="o">.</span><span class="n">QuantumModule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Quantum layer applying the same two-qubit operation in a butterfly pattern.</span>

<span class="sd">        This class represents a quantum layer that applies the same two-qubit operation in a butterfly pattern. The butterfly pattern connects the first and last wire, the second and second-to-last wire, and so on, until the center wire(s) in the case of an odd number of wires.</span>

<span class="sd">        Args:</span>
<span class="sd">            op (tq.Operator): Two-qubit operation to be applied.</span>
<span class="sd">            n_wires (int): Number of wires in the quantum device.</span>
<span class="sd">            has_params (bool, optional): Flag indicating if the operation has parameters. Defaults to False.</span>
<span class="sd">            trainable (bool, optional): Flag indicating if the operation is trainable. Defaults to False.</span>
<span class="sd">            wire_reverse (bool, optional): Flag indicating if the order of wires in each pair should be reversed. Defaults to False.</span>

<span class="sd">        &quot;&quot;&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;pattern: [0, 5], [1, 4], [2, 3]&quot;&quot;&quot;</span>

<div class="viewcode-block" id="Op2QButterflyLayer.__init__">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.Op2QButterflyLayer.html#torchquantum.layer.Op2QButterflyLayer.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">n_wires</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">has_params</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">wire_reverse</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span> <span class="o">=</span> <span class="n">n_wires</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">op</span> <span class="o">=</span> <span class="n">op</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ops_all</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumModuleList</span><span class="p">()</span>

        <span class="c1"># reverse the wires, for example from [1, 2] to [2, 1]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wire_reverse</span> <span class="o">=</span> <span class="n">wire_reverse</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_wires</span> <span class="o">//</span> <span class="mi">2</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ops_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">op</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="n">has_params</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="n">trainable</span><span class="p">))</span></div>


<div class="viewcode-block" id="Op2QButterflyLayer.forward">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.Op2QButterflyLayer.html#torchquantum.layer.Op2QButterflyLayer.forward">[docs]</a>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q_device</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ops_all</span><span class="p">)):</span>
            <span class="n">wires</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">k</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">wire_reverse</span><span class="p">:</span>
                <span class="n">wires</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ops_all</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">q_device</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">wires</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="Op2QDenseLayer">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.Op2QDenseLayer.html#torchquantum.layer.Op2QDenseLayer">[docs]</a>
<span class="k">class</span> <span class="nc">Op2QDenseLayer</span><span class="p">(</span><span class="n">tq</span><span class="o">.</span><span class="n">QuantumModule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">       Quantum layer applying the same two-qubit operation in a dense pattern.</span>

<span class="sd">       This class represents a quantum layer that applies the same two-qubit operation in a dense pattern. The dense pattern connects every pair of wires, ensuring that each wire is connected to every other wire exactly once.</span>

<span class="sd">       Args:</span>
<span class="sd">           op (tq.Operator): Two-qubit operation to be applied.</span>
<span class="sd">           n_wires (int): Number of wires in the quantum device.</span>
<span class="sd">           has_params (bool, optional): Flag indicating if the operation has parameters. Defaults to False.</span>
<span class="sd">           trainable (bool, optional): Flag indicating if the operation is trainable. Defaults to False.</span>
<span class="sd">           wire_reverse (bool, optional): Flag indicating if the order of wires in each pair should be reversed. Defaults to False.</span>

<span class="sd">       &quot;&quot;&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;pattern:</span>
<span class="sd">    [0, 1], [0, 2], [0, 3], [0, 4], [0, 5]</span>
<span class="sd">    [1, 2], [1, 3], [1, 4], [1, 5]</span>
<span class="sd">    [2, 3], [2, 4], [2, 5]</span>
<span class="sd">    [3, 4], [3, 5]</span>
<span class="sd">    [4, 5]</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Op2QDenseLayer.__init__">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.Op2QDenseLayer.html#torchquantum.layer.Op2QDenseLayer.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">n_wires</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">has_params</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">wire_reverse</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span> <span class="o">=</span> <span class="n">n_wires</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">op</span> <span class="o">=</span> <span class="n">op</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ops_all</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumModuleList</span><span class="p">()</span>

        <span class="c1"># reverse the wires, for example from [1, 2] to [2, 1]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wire_reverse</span> <span class="o">=</span> <span class="n">wire_reverse</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ops_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">op</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="n">has_params</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="n">trainable</span><span class="p">))</span></div>


<div class="viewcode-block" id="Op2QDenseLayer.forward">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.Op2QDenseLayer.html#torchquantum.layer.Op2QDenseLayer.forward">[docs]</a>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q_device</span><span class="p">):</span>
        <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">):</span>
                <span class="n">wires</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">wire_reverse</span><span class="p">:</span>
                    <span class="n">wires</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ops_all</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">q_device</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">wires</span><span class="p">)</span>
                <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span></div>
</div>



<span class="k">class</span> <span class="nc">LayerTemplate0</span><span class="p">(</span><span class="n">tq</span><span class="o">.</span><span class="n">QuantumModule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">       A template for a custom quantum layer.</span>

<span class="sd">       Args:</span>
<span class="sd">           arch (dict, optional): The architecture configuration for the layer. Defaults to None.</span>

<span class="sd">       Attributes:</span>
<span class="sd">           n_wires (int): The number of wires in the layer.</span>
<span class="sd">           arch (dict): The architecture configuration for the layer.</span>
<span class="sd">           n_blocks (int): The number of blocks in the layer. (Optional)</span>
<span class="sd">           n_layers_per_block (int): The number of layers per block. (Optional)</span>
<span class="sd">           layers_all (tq.QuantumModuleList): The list of layers in the template.</span>

<span class="sd">       Methods:</span>
<span class="sd">           build_layers: Abstract method to build the layers of the template.</span>
<span class="sd">           forward: Applies the quantum layer to the given quantum device.</span>

<span class="sd">       &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arch</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span> <span class="o">=</span> <span class="n">arch</span><span class="p">[</span><span class="s2">&quot;n_wires&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arch</span> <span class="o">=</span> <span class="n">arch</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">n_blocks</span> <span class="o">=</span> <span class="n">arch</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;n_blocks&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_layers_per_block</span> <span class="o">=</span> <span class="n">arch</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;n_layers_per_block&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">layers_all</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_layers</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">build_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@tq</span><span class="o">.</span><span class="n">static_support</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q_device</span><span class="p">:</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumDevice</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">q_device</span> <span class="o">=</span> <span class="n">q_device</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layers_all</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">layers_all</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">q_device</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">U3CU3Layer0</span><span class="p">(</span><span class="n">LayerTemplate0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Layer template with U3 and CU3 blocks.</span>

<span class="sd">        This layer template consists of U3 and CU3 blocks repeated for the specified number of blocks.</span>

<span class="sd">        Args:</span>
<span class="sd">            arch (dict, optional): The architecture configuration for the layer. Defaults to None.</span>

<span class="sd">        Attributes:</span>
<span class="sd">            n_wires (int): The number of wires in the layer.</span>
<span class="sd">            arch (dict): The architecture configuration for the layer.</span>
<span class="sd">            n_blocks (int): The number of blocks in the layer.</span>
<span class="sd">            layers_all (tq.QuantumModuleList): The list of layers in the template.</span>

<span class="sd">        Methods:</span>
<span class="sd">            build_layers: Builds the U3 and CU3 layers for the template.</span>
<span class="sd">            forward: Applies the quantum layer to the given quantum device.</span>

<span class="sd">        &quot;&quot;&quot;</span>


    <span class="k">def</span> <span class="nf">build_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">layers_all</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumModuleList</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arch</span><span class="p">[</span><span class="s2">&quot;n_blocks&quot;</span><span class="p">]):</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Op1QAllLayer</span><span class="p">(</span>
                    <span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">U3</span><span class="p">,</span> <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span> <span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Op2QAllLayer</span><span class="p">(</span>
                    <span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">CU3</span><span class="p">,</span>
                    <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span>
                    <span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">jump</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">circular</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">layers_all</span>


<span class="k">class</span> <span class="nc">CU3Layer0</span><span class="p">(</span><span class="n">LayerTemplate0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Layer template with CU3 blocks.</span>

<span class="sd">        This layer template consists of CU3 blocks repeated for the specified number of blocks.</span>

<span class="sd">        Args:</span>
<span class="sd">            arch (dict, optional): The architecture configuration for the layer. Defaults to None.</span>

<span class="sd">        Attributes:</span>
<span class="sd">            n_wires (int): The number of wires in the layer.</span>
<span class="sd">            arch (dict): The architecture configuration for the layer.</span>
<span class="sd">            n_blocks (int): The number of blocks in the layer.</span>
<span class="sd">            layers_all (tq.QuantumModuleList): The list of layers in the template.</span>

<span class="sd">        Methods:</span>
<span class="sd">            build_layers: Builds the CU3 layers for the template.</span>
<span class="sd">            forward: Applies the quantum layer to the given quantum device.</span>

<span class="sd">        &quot;&quot;&quot;</span>


    <span class="k">def</span> <span class="nf">build_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">layers_all</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumModuleList</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arch</span><span class="p">[</span><span class="s2">&quot;n_blocks&quot;</span><span class="p">]):</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Op2QAllLayer</span><span class="p">(</span>
                    <span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">CU3</span><span class="p">,</span>
                    <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span>
                    <span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">jump</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">circular</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">layers_all</span>


<span class="k">class</span> <span class="nc">CXRZSXLayer0</span><span class="p">(</span><span class="n">LayerTemplate0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Layer template with CXRZSX blocks.</span>

<span class="sd">        This layer template consists of CXRZSX blocks, which include RZ, CNOT, and SX gates, repeated for the specified number of blocks.</span>

<span class="sd">        Args:</span>
<span class="sd">            arch (dict, optional): The architecture configuration for the layer. Defaults to None.</span>

<span class="sd">        Attributes:</span>
<span class="sd">            n_wires (int): The number of wires in the layer.</span>
<span class="sd">            arch (dict): The architecture configuration for the layer.</span>
<span class="sd">            n_blocks (int): The number of blocks in the layer.</span>
<span class="sd">            layers_all (tq.QuantumModuleList): The list of layers in the template.</span>

<span class="sd">        Methods:</span>
<span class="sd">            build_layers: Builds the CXRZSX layers for the template.</span>
<span class="sd">            forward: Applies the quantum layer to the given quantum device.</span>

<span class="sd">        &quot;&quot;&quot;</span>


    <span class="k">def</span> <span class="nf">build_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">layers_all</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumModuleList</span><span class="p">()</span>

        <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">Op1QAllLayer</span><span class="p">(</span>
                <span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">RZ</span><span class="p">,</span> <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span> <span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">Op2QAllLayer</span><span class="p">(</span><span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">CNOT</span><span class="p">,</span> <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span> <span class="n">jump</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">circular</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arch</span><span class="p">[</span><span class="s2">&quot;n_blocks&quot;</span><span class="p">]):</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Op1QAllLayer</span><span class="p">(</span>
                    <span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">RZ</span><span class="p">,</span> <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span> <span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Op1QAllLayer</span><span class="p">(</span>
                    <span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">SX</span><span class="p">,</span> <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span> <span class="n">has_params</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">False</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">Op1QAllLayer</span><span class="p">(</span>
                <span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">RZ</span><span class="p">,</span> <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span> <span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">layers_all</span>


<span class="k">class</span> <span class="nc">SethLayer0</span><span class="p">(</span><span class="n">LayerTemplate0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Layer template with Seth blocks.</span>

<span class="sd">        This layer template consists of Seth blocks, which include RZZ and RY gates, repeated for the specified number of blocks.</span>

<span class="sd">        Args:</span>
<span class="sd">            arch (dict, optional): The architecture configuration for the layer. Defaults to None.</span>

<span class="sd">        Attributes:</span>
<span class="sd">            n_wires (int): The number of wires in the layer.</span>
<span class="sd">            arch (dict): The architecture configuration for the layer.</span>
<span class="sd">            n_blocks (int): The number of blocks in the layer.</span>
<span class="sd">            layers_all (tq.QuantumModuleList): The list of layers in the template.</span>

<span class="sd">        Methods:</span>
<span class="sd">            build_layers: Builds the Seth layers for the template.</span>
<span class="sd">            forward: Applies the quantum layer to the given quantum device.</span>

<span class="sd">        &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">build_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">layers_all</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumModuleList</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arch</span><span class="p">[</span><span class="s2">&quot;n_blocks&quot;</span><span class="p">]):</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Op2QAllLayer</span><span class="p">(</span>
                    <span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">RZZ</span><span class="p">,</span>
                    <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span>
                    <span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">jump</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">circular</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Op1QAllLayer</span><span class="p">(</span>
                    <span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">RY</span><span class="p">,</span> <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span> <span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">layers_all</span>


<span class="k">class</span> <span class="nc">SethLayer1</span><span class="p">(</span><span class="n">LayerTemplate0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">       Layer template with extended Seth blocks.</span>

<span class="sd">       This layer template consists of extended Seth blocks, which include RZZ and RY gates repeated twice for each block.</span>

<span class="sd">       Args:</span>
<span class="sd">           arch (dict, optional): The architecture configuration for the layer. Defaults to None.</span>

<span class="sd">       Attributes:</span>
<span class="sd">           n_wires (int): The number of wires in the layer.</span>
<span class="sd">           arch (dict): The architecture configuration for the layer.</span>
<span class="sd">           n_blocks (int): The number of blocks in the layer.</span>
<span class="sd">           layers_all (tq.QuantumModuleList): The list of layers in the template.</span>

<span class="sd">       Methods:</span>
<span class="sd">           build_layers: Builds the extended Seth layers for the template.</span>
<span class="sd">           forward: Applies the quantum layer to the given quantum device.</span>

<span class="sd">       &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">build_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">layers_all</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumModuleList</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arch</span><span class="p">[</span><span class="s2">&quot;n_blocks&quot;</span><span class="p">]):</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Op2QAllLayer</span><span class="p">(</span>
                    <span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">RZZ</span><span class="p">,</span>
                    <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span>
                    <span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">jump</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">circular</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Op1QAllLayer</span><span class="p">(</span>
                    <span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">RY</span><span class="p">,</span> <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span> <span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Op2QAllLayer</span><span class="p">(</span>
                    <span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">RZZ</span><span class="p">,</span>
                    <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span>
                    <span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">jump</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">circular</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">layers_all</span>


<span class="k">class</span> <span class="nc">SethLayer2</span><span class="p">(</span><span class="n">LayerTemplate0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Layer template with Seth blocks using Op2QFit32Layer.</span>

<span class="sd">        This layer template consists of Seth blocks using the Op2QFit32Layer, which includes RZZ gates and supports 32 wires.</span>

<span class="sd">        Args:</span>
<span class="sd">            arch (dict, optional): The architecture configuration for the layer. Defaults to None.</span>

<span class="sd">        Attributes:</span>
<span class="sd">            n_wires (int): The number of wires in the layer.</span>
<span class="sd">            arch (dict): The architecture configuration for the layer.</span>
<span class="sd">            n_blocks (int): The number of blocks in the layer.</span>
<span class="sd">            layers_all (tq.QuantumModuleList): The list of layers in the template.</span>

<span class="sd">        Methods:</span>
<span class="sd">            build_layers: Builds the Seth layers with Op2QFit32Layer for the template.</span>
<span class="sd">            forward: Applies the quantum layer to the given quantum device.</span>

<span class="sd">        &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">build_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">layers_all</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumModuleList</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arch</span><span class="p">[</span><span class="s2">&quot;n_blocks&quot;</span><span class="p">]):</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Op2QFit32Layer</span><span class="p">(</span>
                    <span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">RZZ</span><span class="p">,</span>
                    <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span>
                    <span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">jump</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">circular</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">layers_all</span>


<span class="k">class</span> <span class="nc">RZZLayer0</span><span class="p">(</span><span class="n">LayerTemplate0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Layer template with RZZ blocks.</span>

<span class="sd">        This layer template consists of RZZ blocks using the Op2QAllLayer.</span>

<span class="sd">        Args:</span>
<span class="sd">            arch (dict, optional): The architecture configuration for the layer. Defaults to None.</span>

<span class="sd">        Attributes:</span>
<span class="sd">            n_wires (int): The number of wires in the layer.</span>
<span class="sd">            arch (dict): The architecture configuration for the layer.</span>
<span class="sd">            n_blocks (int): The number of blocks in the layer.</span>
<span class="sd">            layers_all (tq.QuantumModuleList): The list of layers in the template.</span>

<span class="sd">        Methods:</span>
<span class="sd">            build_layers: Builds the RZZ layers with Op2QAllLayer for the template.</span>
<span class="sd">            forward: Applies the quantum layer to the given quantum device.</span>

<span class="sd">        &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">build_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">layers_all</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumModuleList</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arch</span><span class="p">[</span><span class="s2">&quot;n_blocks&quot;</span><span class="p">]):</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Op2QAllLayer</span><span class="p">(</span>
                    <span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">RZZ</span><span class="p">,</span>
                    <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span>
                    <span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">jump</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">circular</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">layers_all</span>


<span class="k">class</span> <span class="nc">BarrenLayer0</span><span class="p">(</span><span class="n">LayerTemplate0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Layer template with Barren blocks.</span>

<span class="sd">        This layer template consists of Barren blocks using the Op1QAllLayer and Op2QAllLayer.</span>

<span class="sd">        Args:</span>
<span class="sd">            arch (dict, optional): The architecture configuration for the layer. Defaults to None.</span>

<span class="sd">        Attributes:</span>
<span class="sd">            n_wires (int): The number of wires in the layer.</span>
<span class="sd">            arch (dict): The architecture configuration for the layer.</span>
<span class="sd">            n_blocks (int): The number of blocks in the layer.</span>
<span class="sd">            layers_all (tq.QuantumModuleList): The list of layers in the template.</span>

<span class="sd">        Methods:</span>
<span class="sd">            build_layers: Builds the Barren layers with Op1QAllLayer and Op2QAllLayer for the template.</span>
<span class="sd">            forward: Applies the quantum layer to the given quantum device.</span>

<span class="sd">        &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">build_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">layers_all</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumModuleList</span><span class="p">()</span>
        <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">Op1QAllLayer</span><span class="p">(</span>
                <span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">SHadamard</span><span class="p">,</span>
                <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arch</span><span class="p">[</span><span class="s2">&quot;n_blocks&quot;</span><span class="p">]):</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Op1QAllLayer</span><span class="p">(</span>
                    <span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">RX</span><span class="p">,</span> <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span> <span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Op1QAllLayer</span><span class="p">(</span>
                    <span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">RY</span><span class="p">,</span> <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span> <span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Op1QAllLayer</span><span class="p">(</span>
                    <span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">RZ</span><span class="p">,</span> <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span> <span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Op2QAllLayer</span><span class="p">(</span><span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">CZ</span><span class="p">,</span> <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span> <span class="n">jump</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">layers_all</span>


<span class="k">class</span> <span class="nc">FarhiLayer0</span><span class="p">(</span><span class="n">LayerTemplate0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">     Layer template with Farhi blocks.</span>

<span class="sd">     This layer template consists of Farhi blocks using the Op2QAllLayer.</span>

<span class="sd">     Args:</span>
<span class="sd">         arch (dict, optional): The architecture configuration for the layer. Defaults to None.</span>

<span class="sd">     Attributes:</span>
<span class="sd">         n_wires (int): The number of wires in the layer.</span>
<span class="sd">         arch (dict): The architecture configuration for the layer.</span>
<span class="sd">         n_blocks (int): The number of blocks in the layer.</span>
<span class="sd">         layers_all (tq.QuantumModuleList): The list of layers in the template.</span>

<span class="sd">     Methods:</span>
<span class="sd">         build_layers: Builds the Farhi layers with Op2QAllLayer for the template.</span>
<span class="sd">         forward: Applies the quantum layer to the given quantum device.</span>

<span class="sd">     &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">build_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">layers_all</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumModuleList</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arch</span><span class="p">[</span><span class="s2">&quot;n_blocks&quot;</span><span class="p">]):</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Op2QAllLayer</span><span class="p">(</span>
                    <span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">RZX</span><span class="p">,</span>
                    <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span>
                    <span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">jump</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">circular</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Op2QAllLayer</span><span class="p">(</span>
                    <span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">RXX</span><span class="p">,</span>
                    <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span>
                    <span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">jump</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">circular</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">layers_all</span>


<span class="k">class</span> <span class="nc">MaxwellLayer0</span><span class="p">(</span><span class="n">LayerTemplate0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">       Layer template with Maxwell blocks.</span>

<span class="sd">       This layer template consists of Maxwell blocks using the Op1QAllLayer and Op2QAllLayer modules.</span>

<span class="sd">       Args:</span>
<span class="sd">           arch (dict, optional): The architecture configuration for the layer. Defaults to None.</span>

<span class="sd">       Attributes:</span>
<span class="sd">           n_wires (int): The number of wires in the layer.</span>
<span class="sd">           arch (dict): The architecture configuration for the layer.</span>
<span class="sd">           n_blocks (int): The number of blocks in the layer.</span>
<span class="sd">           layers_all (tq.QuantumModuleList): The list of layers in the template.</span>

<span class="sd">       Methods:</span>
<span class="sd">           build_layers: Builds the Maxwell layers with Op1QAllLayer and Op2QAllLayer for the template.</span>
<span class="sd">           forward: Applies the quantum layer to the given quantum device.</span>

<span class="sd">       &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">build_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">layers_all</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumModuleList</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arch</span><span class="p">[</span><span class="s2">&quot;n_blocks&quot;</span><span class="p">]):</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Op1QAllLayer</span><span class="p">(</span>
                    <span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">RX</span><span class="p">,</span> <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span> <span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Op1QAllLayer</span><span class="p">(</span><span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">S</span><span class="p">,</span> <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">))</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Op2QAllLayer</span><span class="p">(</span><span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">CNOT</span><span class="p">,</span> <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span> <span class="n">jump</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">circular</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="p">)</span>

            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Op1QAllLayer</span><span class="p">(</span>
                    <span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">RY</span><span class="p">,</span> <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span> <span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Op1QAllLayer</span><span class="p">(</span><span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">))</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Op2QAllLayer</span><span class="p">(</span><span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">SWAP</span><span class="p">,</span> <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span> <span class="n">jump</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">circular</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="p">)</span>

            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Op1QAllLayer</span><span class="p">(</span>
                    <span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">RZ</span><span class="p">,</span> <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span> <span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Op1QAllLayer</span><span class="p">(</span><span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">Hadamard</span><span class="p">,</span> <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">))</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Op2QAllLayer</span><span class="p">(</span><span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">SSWAP</span><span class="p">,</span> <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span> <span class="n">jump</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">circular</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="p">)</span>

            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Op1QAllLayer</span><span class="p">(</span>
                    <span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">U1</span><span class="p">,</span> <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span> <span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Op2QAllLayer</span><span class="p">(</span>
                    <span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">CU3</span><span class="p">,</span>
                    <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span>
                    <span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">jump</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">circular</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">layers_all</span>


<span class="k">class</span> <span class="nc">RYRYCXLayer0</span><span class="p">(</span><span class="n">LayerTemplate0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">       Layer template with RYRYCX blocks.</span>

<span class="sd">       This layer template consists of RYRYCX blocks using the Op1QAllLayer and CXLayer modules.</span>

<span class="sd">       Args:</span>
<span class="sd">           arch (dict, optional): The architecture configuration for the layer. Defaults to None.</span>

<span class="sd">       Attributes:</span>
<span class="sd">           n_wires (int): The number of wires in the layer.</span>
<span class="sd">           arch (dict): The architecture configuration for the layer.</span>
<span class="sd">           n_blocks (int): The number of blocks in the layer.</span>
<span class="sd">           layers_all (tq.QuantumModuleList): The list of layers in the template.</span>

<span class="sd">       Methods:</span>
<span class="sd">           build_layers: Builds the RYRYCX layers with Op1QAllLayer and CXLayer for the template.</span>
<span class="sd">           forward: Applies the quantum layer to the given quantum device.</span>

<span class="sd">       &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">build_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">layers_all</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumModuleList</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arch</span><span class="p">[</span><span class="s2">&quot;n_blocks&quot;</span><span class="p">]):</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Op1QAllLayer</span><span class="p">(</span>
                    <span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">RY</span><span class="p">,</span> <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span> <span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CXLayer</span><span class="p">(</span><span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">layers_all</span>


<span class="k">class</span> <span class="nc">RYRYRYCXCXCXLayer0</span><span class="p">(</span><span class="n">LayerTemplate0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">       Layer template with RYRYRYCXCXCX blocks.</span>

<span class="sd">       This layer template consists of RYRYRYCXCXCX blocks using the RYRYCXCXLayer module.</span>

<span class="sd">       Args:</span>
<span class="sd">           arch (dict, optional): The architecture configuration for the layer. Defaults to None.</span>

<span class="sd">       Attributes:</span>
<span class="sd">           n_wires (int): The number of wires in the layer.</span>
<span class="sd">           arch (dict): The architecture configuration for the layer.</span>
<span class="sd">           n_blocks (int): The number of blocks in the layer.</span>
<span class="sd">           layers_all (tq.QuantumModuleList): The list of layers in the template.</span>

<span class="sd">       Methods:</span>
<span class="sd">           build_layers: Builds the RYRYRYCXCXCX layers with RYRYCXCXLayer for the template.</span>

<span class="sd">       &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">build_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">layers_all</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumModuleList</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arch</span><span class="p">[</span><span class="s2">&quot;n_blocks&quot;</span><span class="p">]):</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Op1QAllLayer</span><span class="p">(</span>
                    <span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">RY</span><span class="p">,</span> <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span> <span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CXCXCXLayer</span><span class="p">(</span><span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">layers_all</span>


<span class="k">class</span> <span class="nc">RYRYRYLayer0</span><span class="p">(</span><span class="n">LayerTemplate0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Layer template with RYRYRYCXCXCX blocks.</span>

<span class="sd">        This layer template consists of RYRYRYCXCXCX blocks using the Op1QAllLayer and CXCXCXLayer modules.</span>

<span class="sd">        Args:</span>
<span class="sd">            arch (dict, optional): The architecture configuration for the layer. Defaults to None.</span>

<span class="sd">        Attributes:</span>
<span class="sd">            n_wires (int): The number of wires in the layer.</span>
<span class="sd">            arch (dict): The architecture configuration for the layer.</span>
<span class="sd">            n_blocks (int): The number of blocks in the layer.</span>
<span class="sd">            layers_all (tq.QuantumModuleList): The list of layers in the template.</span>

<span class="sd">        Methods:</span>
<span class="sd">            build_layers: Builds the RYRYRYCXCXCX layers with Op1QAllLayer and CXCXCXLayer for the template.</span>


<span class="sd">        &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">build_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">layers_all</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumModuleList</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arch</span><span class="p">[</span><span class="s2">&quot;n_blocks&quot;</span><span class="p">]):</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Op1QAllLayer</span><span class="p">(</span>
                    <span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">RY</span><span class="p">,</span> <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span> <span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">layers_all</span>


<span class="k">class</span> <span class="nc">RYRYRYSWAPSWAPLayer0</span><span class="p">(</span><span class="n">LayerTemplate0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Layer template with RYRYRYSWAPSWAP blocks.</span>

<span class="sd">        This layer template consists of RYRYRYSWAPSWAP blocks using the Op1QAllLayer and SWAPSWAPLayer modules.</span>

<span class="sd">        Args:</span>
<span class="sd">            arch (dict, optional): The architecture configuration for the layer. Defaults to None.</span>

<span class="sd">        Attributes:</span>
<span class="sd">            n_wires (int): The number of wires in the layer.</span>
<span class="sd">            arch (dict): The architecture configuration for the layer.</span>
<span class="sd">            n_blocks (int): The number of blocks in the layer.</span>
<span class="sd">            layers_all (tq.QuantumModuleList): The list of layers in the template.</span>

<span class="sd">        Methods:</span>
<span class="sd">            build_layers: Builds the RYRYRYSWAPSWAP layers with Op1QAllLayer and SWAPSWAPLayer for the template.</span>


<span class="sd">        &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">build_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">layers_all</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumModuleList</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arch</span><span class="p">[</span><span class="s2">&quot;n_blocks&quot;</span><span class="p">]):</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Op1QAllLayer</span><span class="p">(</span>
                    <span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">RY</span><span class="p">,</span> <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span> <span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SWAPSWAPLayer</span><span class="p">(</span><span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">layers_all</span>


<span class="k">class</span> <span class="nc">SWAPSWAPLayer0</span><span class="p">(</span><span class="n">LayerTemplate0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Layer template with SWAPSWAP blocks.</span>

<span class="sd">        This layer template consists of SWAPSWAP blocks using the SWAPSWAPLayer module.</span>

<span class="sd">        Args:</span>
<span class="sd">            arch (dict, optional): The architecture configuration for the layer. Defaults to None.</span>

<span class="sd">        Attributes:</span>
<span class="sd">            n_wires (int): The number of wires in the layer.</span>
<span class="sd">            arch (dict): The architecture configuration for the layer.</span>
<span class="sd">            n_blocks (int): The number of blocks in the layer.</span>
<span class="sd">            layers_all (tq.QuantumModuleList): The list of layers in the template.</span>

<span class="sd">        Methods:</span>
<span class="sd">            build_layers: Builds the SWAPSWAP layers with SWAPSWAPLayer for the template.</span>

<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">build_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">layers_all</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumModuleList</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arch</span><span class="p">[</span><span class="s2">&quot;n_blocks&quot;</span><span class="p">]):</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SWAPSWAPLayer</span><span class="p">(</span><span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">layers_all</span>


<div class="viewcode-block" id="RXYZCXLayer0">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.RXYZCXLayer0.html#torchquantum.layer.RXYZCXLayer0">[docs]</a>
<span class="k">class</span> <span class="nc">RXYZCXLayer0</span><span class="p">(</span><span class="n">LayerTemplate0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Layer template with RXYZCX blocks.</span>

<span class="sd">        This layer template consists of RXYZCX blocks using the RXYZCXLayer module.</span>

<span class="sd">        Args:</span>
<span class="sd">            arch (dict, optional): The architecture configuration for the layer. Defaults to None.</span>

<span class="sd">        Attributes:</span>
<span class="sd">            n_wires (int): The number of wires in the layer.</span>
<span class="sd">            arch (dict): The architecture configuration for the layer.</span>
<span class="sd">            n_blocks (int): The number of blocks in the layer.</span>
<span class="sd">            layers_all (tq.QuantumModuleList): The list of layers in the template.</span>

<span class="sd">        Methods:</span>
<span class="sd">            build_layers: Builds the RXYZCX layers with RXYZCXLayer for the template.</span>

<span class="sd">        &quot;&quot;&quot;</span>
<div class="viewcode-block" id="RXYZCXLayer0.build_layers">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.RXYZCXLayer0.html#torchquantum.layer.RXYZCXLayer0.build_layers">[docs]</a>
    <span class="k">def</span> <span class="nf">build_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">layers_all</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumModuleList</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arch</span><span class="p">[</span><span class="s2">&quot;n_blocks&quot;</span><span class="p">]):</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Op1QAllLayer</span><span class="p">(</span>
                    <span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">RX</span><span class="p">,</span> <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span> <span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Op1QAllLayer</span><span class="p">(</span>
                    <span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">RY</span><span class="p">,</span> <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span> <span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Op1QAllLayer</span><span class="p">(</span>
                    <span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">RZ</span><span class="p">,</span> <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span> <span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">layers_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Op2QAllLayer</span><span class="p">(</span><span class="n">op</span><span class="o">=</span><span class="n">tq</span><span class="o">.</span><span class="n">CNOT</span><span class="p">,</span> <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span> <span class="n">jump</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">circular</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">layers_all</span></div>
</div>



<div class="viewcode-block" id="QFTLayer">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.QFTLayer.html#torchquantum.layer.QFTLayer">[docs]</a>
<span class="k">class</span> <span class="nc">QFTLayer</span><span class="p">(</span><span class="n">tq</span><span class="o">.</span><span class="n">QuantumModule</span><span class="p">):</span>
<div class="viewcode-block" id="QFTLayer.__init__">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.QFTLayer.html#torchquantum.layer.QFTLayer.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">n_wires</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">wires</span><span class="p">:</span> <span class="n">Iterable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">do_swaps</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">inverse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructs a Quantum Fourier Transform (QFT) layer</span>

<span class="sd">        Args:</span>
<span class="sd">            n_wires (int): Number of wires for the QFT as an integer</span>
<span class="sd">            wires (Iterable): Wires to perform the QFT as an Iterable</span>
<span class="sd">            do_swaps (bool): Whether or not to add the final swaps in a boolean format</span>
<span class="sd">            inverse (bool): Whether to create an inverse QFT layer in a boolean format</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="k">assert</span> <span class="n">n_wires</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">wires</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">n_wires</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">wires</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">wires</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">wires</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_wires</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span> <span class="o">=</span> <span class="n">n_wires</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wires</span> <span class="o">=</span> <span class="n">wires</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">do_swaps</span> <span class="o">=</span> <span class="n">do_swaps</span>

        <span class="k">if</span> <span class="n">inverse</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gates_all</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_inverse_circuit</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gates_all</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_circuit</span><span class="p">()</span></div>


<div class="viewcode-block" id="QFTLayer.build_circuit">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.QFTLayer.html#torchquantum.layer.QFTLayer.build_circuit">[docs]</a>
    <span class="k">def</span> <span class="nf">build_circuit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct a QFT circuit.&quot;&quot;&quot;</span>

        <span class="n">operation_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># add the H and CU1 gates</span>
        <span class="k">for</span> <span class="n">top_wire</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">):</span>
            <span class="n">operation_list</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;hadamard&quot;</span><span class="p">,</span> <span class="s2">&quot;wires&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">wires</span><span class="p">[</span><span class="n">top_wire</span><span class="p">]})</span>
            <span class="k">for</span> <span class="n">wire</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">top_wire</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">):</span>
                <span class="n">lam</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">wire</span> <span class="o">-</span> <span class="n">top_wire</span><span class="p">))</span>
                <span class="n">operation_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;cu1&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="n">lam</span><span class="p">,</span>
                        <span class="s2">&quot;wires&quot;</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">wires</span><span class="p">[</span><span class="n">wire</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">wires</span><span class="p">[</span><span class="n">top_wire</span><span class="p">]],</span>
                    <span class="p">}</span>
                <span class="p">)</span>

        <span class="c1"># add swaps if specified</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_swaps</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">wire</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span> <span class="o">//</span> <span class="mi">2</span><span class="p">):</span>
                <span class="n">operation_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;swap&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;wires&quot;</span><span class="p">:</span> <span class="p">[</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">wires</span><span class="p">[</span><span class="n">wire</span><span class="p">],</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">wires</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span> <span class="o">-</span> <span class="n">wire</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span>
                        <span class="p">],</span>
                    <span class="p">}</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumModule</span><span class="o">.</span><span class="n">from_op_history</span><span class="p">(</span><span class="n">operation_list</span><span class="p">)</span></div>


<div class="viewcode-block" id="QFTLayer.build_inverse_circuit">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.QFTLayer.html#torchquantum.layer.QFTLayer.build_inverse_circuit">[docs]</a>
    <span class="k">def</span> <span class="nf">build_inverse_circuit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct the inverse of a QFT circuit.&quot;&quot;&quot;</span>

        <span class="n">operation_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># add swaps if specified</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_swaps</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">wire</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span> <span class="o">//</span> <span class="mi">2</span><span class="p">):</span>
                <span class="n">operation_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;swap&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;wires&quot;</span><span class="p">:</span> <span class="p">[</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">wires</span><span class="p">[</span><span class="n">wire</span><span class="p">],</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">wires</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span> <span class="o">-</span> <span class="n">wire</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span>
                        <span class="p">],</span>
                    <span class="p">}</span>
                <span class="p">)</span>

        <span class="c1"># add the CU1 and H gates</span>
        <span class="k">for</span> <span class="n">top_wire</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">wire</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">top_wire</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">lam</span> <span class="o">=</span> <span class="o">-</span><span class="n">torch</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">wire</span> <span class="o">-</span> <span class="n">top_wire</span><span class="p">))</span>
                <span class="n">operation_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;cu1&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="n">lam</span><span class="p">,</span>
                        <span class="s2">&quot;wires&quot;</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">wires</span><span class="p">[</span><span class="n">wire</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">wires</span><span class="p">[</span><span class="n">top_wire</span><span class="p">]],</span>
                    <span class="p">}</span>
                <span class="p">)</span>
            <span class="n">operation_list</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;hadamard&quot;</span><span class="p">,</span> <span class="s2">&quot;wires&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">wires</span><span class="p">[</span><span class="n">top_wire</span><span class="p">]})</span>

        <span class="k">return</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumModule</span><span class="o">.</span><span class="n">from_op_history</span><span class="p">(</span><span class="n">operation_list</span><span class="p">)</span></div>


<div class="viewcode-block" id="QFTLayer.forward">
<a class="viewcode-back" href="../../../generated/torchquantum.layer.QFTLayer.html#torchquantum.layer.QFTLayer.forward">[docs]</a>
    <span class="nd">@tq</span><span class="o">.</span><span class="n">static_support</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q_device</span><span class="p">:</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumDevice</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gates_all</span><span class="p">(</span><span class="n">q_device</span><span class="p">)</span></div>
</div>



<span class="n">layer_name_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;u3cu3_0&quot;</span><span class="p">:</span> <span class="n">U3CU3Layer0</span><span class="p">,</span>
    <span class="s2">&quot;cu3_0&quot;</span><span class="p">:</span> <span class="n">CU3Layer0</span><span class="p">,</span>
    <span class="s2">&quot;cxrzsx_0&quot;</span><span class="p">:</span> <span class="n">CXRZSXLayer0</span><span class="p">,</span>
    <span class="s2">&quot;seth_0&quot;</span><span class="p">:</span> <span class="n">SethLayer0</span><span class="p">,</span>
    <span class="s2">&quot;seth_1&quot;</span><span class="p">:</span> <span class="n">SethLayer1</span><span class="p">,</span>
    <span class="s2">&quot;seth_2&quot;</span><span class="p">:</span> <span class="n">SethLayer2</span><span class="p">,</span>
    <span class="s2">&quot;rzz_0&quot;</span><span class="p">:</span> <span class="n">RZZLayer0</span><span class="p">,</span>
    <span class="s2">&quot;barren_0&quot;</span><span class="p">:</span> <span class="n">BarrenLayer0</span><span class="p">,</span>
    <span class="s2">&quot;farhi_0&quot;</span><span class="p">:</span> <span class="n">FarhiLayer0</span><span class="p">,</span>
    <span class="s2">&quot;maxwell_0&quot;</span><span class="p">:</span> <span class="n">MaxwellLayer0</span><span class="p">,</span>
    <span class="s2">&quot;ryrycx&quot;</span><span class="p">:</span> <span class="n">RYRYCXLayer0</span><span class="p">,</span>
    <span class="s2">&quot;ryryrycxcxcx&quot;</span><span class="p">:</span> <span class="n">RYRYRYCXCXCXLayer0</span><span class="p">,</span>
    <span class="s2">&quot;ryryry&quot;</span><span class="p">:</span> <span class="n">RYRYRYLayer0</span><span class="p">,</span>
    <span class="s2">&quot;swapswap&quot;</span><span class="p">:</span> <span class="n">SWAPSWAPLayer0</span><span class="p">,</span>
    <span class="s2">&quot;ryryryswapswap&quot;</span><span class="p">:</span> <span class="n">RYRYRYSWAPSWAPLayer0</span><span class="p">,</span>
    <span class="s2">&quot;rxyzcx_0&quot;</span><span class="p">:</span> <span class="n">RXYZCXLayer0</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2021, Hanrui Wang
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script src="../../../_static/documentation_options.js?v=2709fde1"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/scripts/furo.js?v=32e29ea5"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    </body>
</html>