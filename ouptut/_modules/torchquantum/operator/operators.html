<!doctype html>
<html class="no-js" lang="en" data-content_root="../../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2023.09.10 -->
        <title>torchquantum.operator.operators - TorchQuantum 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=362ab14a" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">TorchQuantum 0.1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../index.html">
  
  
  <span class="sidebar-brand-text">TorchQuantum 0.1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api_torchquantum.html">torchquantum</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../api_functional.html">torchquantum.functional</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of torchquantum.functional</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.apply_unitary_einsum.html">apply_unitary_einsum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.apply_unitary_bmm.html">apply_unitary_bmm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.gate_wrapper.html">gate_wrapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.reset.html">reset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.hadamard.html">hadamard</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.shadamard.html">shadamard</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.paulix.html">paulix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.pauliy.html">pauliy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.pauliz.html">pauliz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.i.html">i</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.s.html">s</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.t.html">t</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.sx.html">sx</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.cnot.html">cnot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.cz.html">cz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.cy.html">cy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.rx.html">rx</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.ry.html">ry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.rz.html">rz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.rxx.html">rxx</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.ryy.html">ryy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.rzz.html">rzz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.zz.html">zz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.rzx.html">rzx</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.zx.html">zx</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.swap.html">swap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.sswap.html">sswap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.cswap.html">cswap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.toffoli.html">toffoli</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.phaseshift.html">phaseshift</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.p.html">p</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.cp.html">cp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.rot.html">rot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.multirz.html">multirz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.crx.html">crx</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.cry.html">cry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.crz.html">crz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.crot.html">crot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.u1.html">u1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.u2.html">u2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.u3.html">u3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.u.html">u</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.cu1.html">cu1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.cu2.html">cu2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.cu3.html">cu3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.cu.html">cu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.qubitunitary.html">qubitunitary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.qubitunitaryfast.html">qubitunitaryfast</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.qubitunitarystrict.html">qubitunitarystrict</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.multicnot.html">multicnot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.multixcnot.html">multixcnot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.x.html">x</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.y.html">y</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.z.html">z</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.zz.html">zz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.cx.html">cx</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.ccnot.html">ccnot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.ccx.html">ccx</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.reset.html">reset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.singleexcitation.html">singleexcitation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.ecr.html">ecr</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.functional.echoedcrossresonance.html">echoedcrossresonance</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../api_operators.html">torchquantum.operators</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of torchquantum.operators</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.Operator.html">Operator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.Observable.html">Observable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.Operation.html">Operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.DiagonalOperation.html">DiagonalOperation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.Hadamard.html">Hadamard</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.SHadamard.html">SHadamard</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.PauliX.html">PauliX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.PauliY.html">PauliY</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.PauliZ.html">PauliZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.I.html">I</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.S.html">S</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.T.html">T</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.SX.html">SX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.CNOT.html">CNOT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.CZ.html">CZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.CY.html">CY</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.RX.html">RX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.RY.html">RY</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.RZ.html">RZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.RXX.html">RXX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.RYY.html">RYY</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.RZZ.html">RZZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.RZX.html">RZX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.SWAP.html">SWAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.SSWAP.html">SSWAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.CSWAP.html">CSWAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.Toffoli.html">Toffoli</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.PhaseShift.html">PhaseShift</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.Rot.html">Rot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.MultiRZ.html">MultiRZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.CRX.html">CRX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.CRY.html">CRY</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.CRZ.html">CRZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.CRot.html">CRot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.U1.html">U1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.U2.html">U2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.U3.html">U3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.CU1.html">CU1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.CU2.html">CU2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.CU3.html">CU3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.QubitUnitary.html">QubitUnitary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.QubitUnitaryFast.html">QubitUnitaryFast</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.TrainableUnitary.html">TrainableUnitary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.TrainableUnitaryStrict.html">TrainableUnitaryStrict</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.MultiCNOT.html">MultiCNOT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.MultiXCNOT.html">MultiXCNOT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.Reset.html">Reset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.SingleExcitation.html">SingleExcitation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.EchoedCrossResonance.html">EchoedCrossResonance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.operator.ECR.html">ECR</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../api_layers.html">torchquantum.layers</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of torchquantum.layers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.layer.QuantumModuleFromOps.html">QuantumModuleFromOps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.layer.TrainableOpAll.html">TrainableOpAll</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.layer.ClassicalInOpAll.html">ClassicalInOpAll</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.layer.FixedOpAll.html">FixedOpAll</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.layer.TwoQAll.html">TwoQAll</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.layer.RandomLayer.html">RandomLayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.layer.RandomLayerAllTypes.html">RandomLayerAllTypes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.layer.Op1QAllLayer.html">Op1QAllLayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.layer.RandomOp1All.html">RandomOp1All</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.layer.Op2QAllLayer.html">Op2QAllLayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.layer.Op2QButterflyLayer.html">Op2QButterflyLayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.layer.Op2QDenseLayer.html">Op2QDenseLayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.layer.CXLayer.html">CXLayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.layer.CXCXCXLayer.html">CXCXCXLayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.layer.SWAPSWAPLayer.html">SWAPSWAPLayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.layer.RXYZCXLayer0.html">RXYZCXLayer0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generated/torchquantum.layer.QFTLayer.html">QFTLayer</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../usage_installation.html">Installation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../examples/index.html">TorchQuantum Examples</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of TorchQuantum Examples</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/gradient_pruning/probabilistic_gradient_pruning.html">Probabilistic gradient pruning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/param_shift_onchip_training/param_shift_onchip_training.html">Apply parameters shift rules to train quantum model using TorchQuantum.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/quantum_kernel_method/quantum_kernel_method.html">Quantum Kernel Methods for IRIS dataset classification with TorchQuantum.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/quanvolution/quanvolution.html">Quanvolution (Quantum convolution) for MNIST image classification with TorchQuantum.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/superdense_coding/superdense_coding_torchquantum.html">Superdense Coding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/superdense_coding/superdense_coding_torchquantum.html#References:">References:</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <h1>Source code for torchquantum.operator.operators</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">MIT License</span>

<span class="sd">Copyright (c) 2020-present TorchQuantum Authors</span>

<span class="sd">Permission is hereby granted, free of charge, to any person obtaining a copy</span>
<span class="sd">of this software and associated documentation files (the &quot;Software&quot;), to deal</span>
<span class="sd">in the Software without restriction, including without limitation the rights</span>
<span class="sd">to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</span>
<span class="sd">copies of the Software, and to permit persons to whom the Software is</span>
<span class="sd">furnished to do so, subject to the following conditions:</span>

<span class="sd">The above copyright notice and this permission notice shall be included in all</span>
<span class="sd">copies or substantial portions of the Software.</span>

<span class="sd">THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<span class="sd">IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span class="sd">FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span>
<span class="sd">AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span>
<span class="sd">LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span>
<span class="sd">OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE</span>
<span class="sd">SOFTWARE.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">torchquantum</span> <span class="k">as</span> <span class="nn">tq</span>
<span class="kn">import</span> <span class="nn">torchquantum.functional.functionals</span> <span class="k">as</span> <span class="nn">tqf</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">IntEnum</span>
<span class="kn">from</span> <span class="nn">torchquantum.functional</span> <span class="kn">import</span> <span class="n">mat_dict</span>
<span class="kn">from</span> <span class="nn">torchquantum.util.quantization.clifford_quantization</span> <span class="kn">import</span> <span class="n">CliffordQuantizer</span>
<span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABCMeta</span>
<span class="kn">from</span> <span class="nn">..macro</span> <span class="kn">import</span> <span class="n">C_DTYPE</span><span class="p">,</span> <span class="n">F_DTYPE</span>
<span class="kn">from</span> <span class="nn">torchpack.utils.logging</span> <span class="kn">import</span> <span class="n">logger</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">List</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;op_name_dict&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Operator&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Operation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;DiagonalOperation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Observable&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Hadamard&quot;</span><span class="p">,</span>
    <span class="s2">&quot;H&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SHadamard&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SH&quot;</span><span class="p">,</span>
    <span class="s2">&quot;PauliX&quot;</span><span class="p">,</span>
    <span class="s2">&quot;PauliY&quot;</span><span class="p">,</span>
    <span class="s2">&quot;PauliZ&quot;</span><span class="p">,</span>
    <span class="s2">&quot;I&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S&quot;</span><span class="p">,</span>
    <span class="s2">&quot;T&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SX&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CNOT&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CZ&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CY&quot;</span><span class="p">,</span>
    <span class="s2">&quot;RX&quot;</span><span class="p">,</span>
    <span class="s2">&quot;RY&quot;</span><span class="p">,</span>
    <span class="s2">&quot;RZ&quot;</span><span class="p">,</span>
    <span class="s2">&quot;RXX&quot;</span><span class="p">,</span>
    <span class="s2">&quot;RYY&quot;</span><span class="p">,</span>
    <span class="s2">&quot;RZZ&quot;</span><span class="p">,</span>
    <span class="s2">&quot;RZX&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SWAP&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SSWAP&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CSWAP&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Toffoli&quot;</span><span class="p">,</span>
    <span class="s2">&quot;PhaseShift&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Rot&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MultiRZ&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CRX&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CRY&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CRZ&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CRot&quot;</span><span class="p">,</span>
    <span class="s2">&quot;U1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;U2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;U3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CU&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CU1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CU2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CU3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;QubitUnitary&quot;</span><span class="p">,</span>
    <span class="s2">&quot;QubitUnitaryFast&quot;</span><span class="p">,</span>
    <span class="s2">&quot;TrainableUnitary&quot;</span><span class="p">,</span>
    <span class="s2">&quot;TrainableUnitaryStrict&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MultiCNOT&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MultiXCNOT&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Reset&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SingleExcitation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;EchoedCrossResonance&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ECR&quot;</span><span class="p">,</span>
    <span class="s2">&quot;QFT&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SDG&quot;</span><span class="p">,</span>
    <span class="s2">&quot;TDG&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SXDG&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CH&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CCZ&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ISWAP&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CS&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CSDG&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CSX&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CHadamard&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CCZ&quot;</span><span class="p">,</span>
    <span class="s2">&quot;DCX&quot;</span><span class="p">,</span>
    <span class="s2">&quot;XXMINYY&quot;</span><span class="p">,</span>
    <span class="s2">&quot;XXPLUSYY&quot;</span><span class="p">,</span>
    <span class="s2">&quot;C3X&quot;</span><span class="p">,</span>
    <span class="s2">&quot;R&quot;</span><span class="p">,</span>
    <span class="s2">&quot;C4X&quot;</span><span class="p">,</span>
    <span class="s2">&quot;RC3X&quot;</span><span class="p">,</span>
    <span class="s2">&quot;RCCX&quot;</span><span class="p">,</span>
    <span class="s2">&quot;GlobalPhase&quot;</span><span class="p">,</span>
    <span class="s2">&quot;C3SX&quot;</span><span class="p">,</span>
<span class="p">]</span>


<span class="k">class</span> <span class="nc">WiresEnum</span><span class="p">(</span><span class="n">IntEnum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Integer enumeration class</span>
<span class="sd">    to represent the number of wires</span>
<span class="sd">    an operation acts on.&quot;&quot;&quot;</span>

    <span class="n">AnyWires</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">AllWires</span> <span class="o">=</span> <span class="mi">0</span>


<span class="k">class</span> <span class="nc">NParamsEnum</span><span class="p">(</span><span class="n">IntEnum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Integer enumeration class</span>
<span class="sd">    to represent the number of wires</span>
<span class="sd">    an operation acts on&quot;&quot;&quot;</span>

    <span class="n">AnyNParams</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>


<span class="n">AnyNParams</span> <span class="o">=</span> <span class="n">NParamsEnum</span><span class="o">.</span><span class="n">AnyNParams</span>


<span class="n">AllWires</span> <span class="o">=</span> <span class="n">WiresEnum</span><span class="o">.</span><span class="n">AllWires</span>
<span class="sd">&quot;&quot;&quot;IntEnum: An enumeration which represents all wires in the</span>
<span class="sd">subsystem. It is equivalent to an integer with value 0.&quot;&quot;&quot;</span>

<span class="n">AnyWires</span> <span class="o">=</span> <span class="n">WiresEnum</span><span class="o">.</span><span class="n">AnyWires</span>
<span class="sd">&quot;&quot;&quot;IntEnum: An enumeration which represents any wires in the</span>
<span class="sd">subsystem. It is equivalent to an integer with value -1.&quot;&quot;&quot;</span>


<div class="viewcode-block" id="Operator">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.Operator.html#torchquantum.operator.Operator">[docs]</a>
<span class="k">class</span> <span class="nc">Operator</span><span class="p">(</span><span class="n">tq</span><span class="o">.</span><span class="n">QuantumModule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The class for quantum operators.&quot;&quot;&quot;</span>

    <span class="n">fixed_ops</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;Hadamard&quot;</span><span class="p">,</span>
        <span class="s2">&quot;SHadamard&quot;</span><span class="p">,</span>
        <span class="s2">&quot;PauliX&quot;</span><span class="p">,</span>
        <span class="s2">&quot;PauliY&quot;</span><span class="p">,</span>
        <span class="s2">&quot;PauliZ&quot;</span><span class="p">,</span>
        <span class="s2">&quot;I&quot;</span><span class="p">,</span>
        <span class="s2">&quot;S&quot;</span><span class="p">,</span>
        <span class="s2">&quot;T&quot;</span><span class="p">,</span>
        <span class="s2">&quot;SX&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CNOT&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CZ&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CY&quot;</span><span class="p">,</span>
        <span class="s2">&quot;SWAP&quot;</span><span class="p">,</span>
        <span class="s2">&quot;SSWAP&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CSWAP&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Toffoli&quot;</span><span class="p">,</span>
        <span class="s2">&quot;MultiCNOT&quot;</span><span class="p">,</span>
        <span class="s2">&quot;MultiXCNOT&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Reset&quot;</span><span class="p">,</span>
        <span class="s2">&quot;EchoedCrossResonance&quot;</span><span class="p">,</span>
        <span class="s2">&quot;QFT&quot;</span><span class="p">,</span>
        <span class="s2">&quot;SDG&quot;</span><span class="p">,</span>
        <span class="s2">&quot;TDG&quot;</span><span class="p">,</span>
        <span class="s2">&quot;SXDG&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CH&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CCZ&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ISWAP&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CS&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CSDG&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CSX&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CHadamard&quot;</span><span class="p">,</span>
        <span class="s2">&quot;DCX&quot;</span><span class="p">,</span>
        <span class="s2">&quot;C3X&quot;</span><span class="p">,</span>
        <span class="s2">&quot;C3SX&quot;</span><span class="p">,</span>
        <span class="s2">&quot;RCCX&quot;</span><span class="p">,</span>
        <span class="s2">&quot;RC3X&quot;</span><span class="p">,</span>
        <span class="s2">&quot;C4X&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="n">parameterized_ops</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;RX&quot;</span><span class="p">,</span>
        <span class="s2">&quot;RY&quot;</span><span class="p">,</span>
        <span class="s2">&quot;RZ&quot;</span><span class="p">,</span>
        <span class="s2">&quot;RXX&quot;</span><span class="p">,</span>
        <span class="s2">&quot;RYY&quot;</span><span class="p">,</span>
        <span class="s2">&quot;RZZ&quot;</span><span class="p">,</span>
        <span class="s2">&quot;RZX&quot;</span><span class="p">,</span>
        <span class="s2">&quot;PhaseShift&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Rot&quot;</span><span class="p">,</span>
        <span class="s2">&quot;MultiRZ&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CRX&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CRY&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CRZ&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CRot&quot;</span><span class="p">,</span>
        <span class="s2">&quot;U1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;U2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;U3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CU&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CU1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CU2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CU3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;QubitUnitary&quot;</span><span class="p">,</span>
        <span class="s2">&quot;QubitUnitaryFast&quot;</span><span class="p">,</span>
        <span class="s2">&quot;TrainableUnitary&quot;</span><span class="p">,</span>
        <span class="s2">&quot;TrainableUnitaryStrict&quot;</span><span class="p">,</span>
        <span class="s2">&quot;SingleExcitation&quot;</span><span class="p">,</span>
        <span class="s2">&quot;XXMINYY&quot;</span><span class="p">,</span>
        <span class="s2">&quot;XXPLUSYY&quot;</span><span class="p">,</span>
        <span class="s2">&quot;R&quot;</span><span class="p">,</span>
        <span class="s2">&quot;GlobalPhase&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;String for the name of the operator.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="nd">@name</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the name of the operator.</span>

<span class="sd">        Args:</span>
<span class="sd">            value (str): operator name.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">value</span>

<div class="viewcode-block" id="Operator.__init__">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.Operator.html#torchquantum.operator.Operator.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">has_params</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">trainable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">init_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">n_wires</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">wires</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">inverse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;__init__ function for Operator.</span>

<span class="sd">        Args:</span>
<span class="sd">            has_params (bool, optional): Whether the operations has parameters.</span>
<span class="sd">                Defaults to False.</span>
<span class="sd">            trainable (bool, optional): Whether the parameters are trainable</span>
<span class="sd">                (if contains parameters). Defaults to False.</span>
<span class="sd">            init_params (torch.Tensor, optional): Initial parameters.</span>
<span class="sd">                Defaults to None.</span>
<span class="sd">            n_wires (int, optional): Number of qubits. Defaults to None.</span>
<span class="sd">            wires (Union[int, List[int]], optional): Which qubit the operation</span>
<span class="sd">                is applied to. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># number of wires of the operator</span>
        <span class="c1"># n_wires is used in gates that can be applied to arbitrary number</span>
        <span class="c1"># of qubits such as MultiRZ</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span> <span class="o">=</span> <span class="n">n_wires</span>
        <span class="c1"># wires that the operator applies to</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wires</span> <span class="o">=</span> <span class="n">wires</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="c1"># for static mode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">static_matrix</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inverse</span> <span class="o">=</span> <span class="n">inverse</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clifford_quantization</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">assert</span> <span class="ow">not</span> <span class="p">(</span><span class="n">trainable</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_params</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AssertionError</span><span class="p">:</span>
            <span class="n">has_params</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Module must have parameters to be trainable; &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Switched &#39;has_params&#39; to True.&quot;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">has_params</span> <span class="o">=</span> <span class="n">has_params</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trainable</span> <span class="o">=</span> <span class="n">trainable</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_params</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_params</span><span class="p">(</span><span class="n">trainable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">trainable</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reset_params</span><span class="p">(</span><span class="n">init_params</span><span class="p">)</span></div>


    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The unitary matrix of the operator.</span>

<span class="sd">        Args:</span>
<span class="sd">            params (torch.Tensor, optional): The parameters for parameterized</span>
<span class="sd">                operators.</span>

<span class="sd">        Returns: None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The unitary matrix of the operator.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_eigvals</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The eigenvalues of the unitary matrix of the operator.</span>

<span class="sd">        Args:</span>
<span class="sd">            params (torch.Tensor, optional): The parameters for parameterized</span>
<span class="sd">                operators.</span>

<span class="sd">        Returns: None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Warning: The eigenvalues of the operator {cls.__name__} are not defined.</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">eigvals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The eigenvalues of the unitary matrix of the operator.</span>

<span class="sd">        Returns: Eigenvalues.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eigvals</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_unitary_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Obtain the unitary matrix of the operator.</span>

<span class="sd">        Returns: Unitary matrix.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span>

<div class="viewcode-block" id="Operator.set_wires">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.Operator.html#torchquantum.operator.Operator.set_wires">[docs]</a>
    <span class="k">def</span> <span class="nf">set_wires</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wires</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set which qubits the operator is applied to.</span>

<span class="sd">        Args:</span>
<span class="sd">            wires (Union[int, List[int]]): Qubits the operator is applied to.</span>

<span class="sd">        Returns: None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wires</span> <span class="o">=</span> <span class="p">[</span><span class="n">wires</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wires</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">else</span> <span class="n">wires</span></div>


<div class="viewcode-block" id="Operator.forward">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.Operator.html#torchquantum.operator.Operator.forward">[docs]</a>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">q_device</span><span class="p">:</span> <span class="n">tq</span><span class="o">.</span><span class="n">QuantumDevice</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply the operator to the quantum device states.</span>

<span class="sd">        Args:</span>
<span class="sd">            q_device (torchquantum.QuantumDevice): Quantum Device that the</span>
<span class="sd">                operator is applied to.</span>
<span class="sd">            wires (Union[int, List[int]]): Qubits that the operator is</span>
<span class="sd">                applied to.</span>
<span class="sd">            params (torch.Tensor): Parameters of the operator</span>
<span class="sd">            inverse (bool): Whether inverse the unitary matrix of the operator.</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">inverse</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;replace the inverse flag with the input&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">inverse</span> <span class="o">=</span> <span class="n">inverse</span>
        <span class="c1"># try:</span>
        <span class="c1">#     assert self.name in self.fixed_ops or \</span>
        <span class="c1">#            self.has_params ^ (params is not None)</span>
        <span class="c1"># except AssertionError as err:</span>
        <span class="c1">#     logger.exception(f&quot;Parameterized gate either has its &quot;</span>
        <span class="c1">#                      f&quot;own parameters or has input as parameters&quot;)</span>
        <span class="c1">#     raise err</span>

        <span class="c1"># try:</span>
        <span class="c1">#     assert not (self.wires is None and wires is None)</span>
        <span class="c1"># except AssertionError as err:</span>
        <span class="c1">#     logger.exception(f&quot;Need to specify the wires either when &quot;</span>
        <span class="c1">#                      f&quot;initialize or when forward&quot;)</span>
        <span class="c1">#     raise err</span>

        <span class="k">if</span> <span class="n">params</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">params</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">wires</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># update the wires</span>
            <span class="n">wires</span> <span class="o">=</span> <span class="p">[</span><span class="n">wires</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wires</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">else</span> <span class="n">wires</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wires</span> <span class="o">=</span> <span class="n">wires</span>

        <span class="c1"># self.inverse = inverse</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">static_mode</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent_graph</span><span class="o">.</span><span class="n">add_op</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># non-parameterized gate</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">q_device</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wires</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inverse</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">q_device</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wires</span><span class="p">,</span> <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inverse</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">noise_model_tq</span><span class="p">,</span> <span class="n">tq</span><span class="o">.</span><span class="n">NoiseModelTQPhase</span><span class="p">):</span>
                <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise_model_tq</span><span class="o">.</span><span class="n">add_noise</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">clifford_quantization</span><span class="p">:</span>
                <span class="n">params</span> <span class="o">=</span> <span class="n">CliffordQuantizer</span><span class="o">.</span><span class="n">quantize_sse</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">q_device</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wires</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inverse</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span>
                    <span class="n">q_device</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">wires</span><span class="p">,</span>
                    <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
                    <span class="n">n_wires</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span>
                    <span class="n">inverse</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inverse</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise_model_tq</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise_model_tq</span><span class="o">.</span><span class="n">is_add_noise</span><span class="p">:</span>
            <span class="n">noise_ops</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise_model_tq</span><span class="o">.</span><span class="n">sample_noise_op</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">noise_ops</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">noise_op</span> <span class="ow">in</span> <span class="n">noise_ops</span><span class="p">:</span>
                    <span class="n">noise_op</span><span class="p">(</span><span class="n">q_device</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot; class: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2"> parameters: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2"> wires: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">wires</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2"> inverse: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">inverse</span><span class="si">}</span><span class="s2">&quot;</span></div>



<div class="viewcode-block" id="Observable">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.Observable.html#torchquantum.operator.Observable">[docs]</a>
<span class="k">class</span> <span class="nc">Observable</span><span class="p">(</span><span class="n">Operator</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for Observables.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="Observable.__init__">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.Observable.html#torchquantum.operator.Observable.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">has_params</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">trainable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">init_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">n_wires</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">wires</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">inverse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Init function of the Observable class</span>

<span class="sd">        Args:</span>
<span class="sd">            has_params (bool, optional): Whether the operations has parameters.</span>
<span class="sd">                Defaults to False.</span>
<span class="sd">            trainable (bool, optional): Whether the parameters are trainable</span>
<span class="sd">                (if contains parameters). Defaults to False.</span>
<span class="sd">            init_params (torch.Tensor, optional): Initial parameters.</span>
<span class="sd">                Defaults to None.</span>
<span class="sd">            n_wires (int, optional): Number of qubits. Defaults to None.</span>
<span class="sd">            wires (Union[int, List[int]], optional): Which qubit the operation</span>
<span class="sd">                is applied to. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">has_params</span><span class="o">=</span><span class="n">has_params</span><span class="p">,</span>
            <span class="n">trainable</span><span class="o">=</span><span class="n">trainable</span><span class="p">,</span>
            <span class="n">init_params</span><span class="o">=</span><span class="n">init_params</span><span class="p">,</span>
            <span class="n">n_wires</span><span class="o">=</span><span class="n">n_wires</span><span class="p">,</span>
            <span class="n">wires</span><span class="o">=</span><span class="n">wires</span><span class="p">,</span>
            <span class="n">inverse</span><span class="o">=</span><span class="n">inverse</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">return_type</span> <span class="o">=</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="Observable.diagonalizing_gates">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.Observable.html#torchquantum.operator.Observable.diagonalizing_gates">[docs]</a>
    <span class="k">def</span> <span class="nf">diagonalizing_gates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The diagonalizing gates when perform measurements.</span>

<span class="sd">        Returns: None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>
</div>



<div class="viewcode-block" id="Operation">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.Operation.html#torchquantum.operator.Operation">[docs]</a>
<span class="k">class</span> <span class="nc">Operation</span><span class="p">(</span><span class="n">Operator</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;_summary_&quot;&quot;&quot;</span>

<div class="viewcode-block" id="Operation.__init__">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.Operation.html#torchquantum.operator.Operation.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">has_params</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">trainable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">init_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">n_wires</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">wires</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">inverse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;_summary_</span>

<span class="sd">        Args:</span>
<span class="sd">            has_params (bool, optional): Whether the operations has parameters.</span>
<span class="sd">                Defaults to False.</span>
<span class="sd">            trainable (bool, optional): Whether the parameters are trainable</span>
<span class="sd">                (if contains parameters). Defaults to False.</span>
<span class="sd">            init_params (torch.Tensor, optional): Initial parameters.</span>
<span class="sd">                Defaults to None.</span>
<span class="sd">            n_wires (int, optional): Number of qubits. Defaults to None.</span>
<span class="sd">            wires (Union[int, List[int]], optional): Which qubit the operation is applied to.</span>
<span class="sd">                Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">has_params</span><span class="o">=</span><span class="n">has_params</span><span class="p">,</span>
            <span class="n">trainable</span><span class="o">=</span><span class="n">trainable</span><span class="p">,</span>
            <span class="n">init_params</span><span class="o">=</span><span class="n">init_params</span><span class="p">,</span>
            <span class="n">n_wires</span><span class="o">=</span><span class="n">n_wires</span><span class="p">,</span>
            <span class="n">wires</span><span class="o">=</span><span class="n">wires</span><span class="p">,</span>
            <span class="n">inverse</span><span class="o">=</span><span class="n">inverse</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_wires</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_wires</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The unitary matrix of the operator.&quot;&quot;&quot;</span>
        <span class="n">op_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">op_matrix</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">eigvals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; &quot;The eigenvalues of the unitary matrix of the operator.</span>

<span class="sd">        Returns:</span>
<span class="sd">            torch.Tensor: Eigenvalues.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">op_eigvals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eigvals</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">op_eigvals</span>

<div class="viewcode-block" id="Operation.init_params">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.Operation.html#torchquantum.operator.Operation.init_params">[docs]</a>
    <span class="k">def</span> <span class="nf">init_params</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the parameters.</span>

<span class="sd">        Raises:</span>
<span class="sd">            NotImplementedError: The init param function is not implemented.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>


<div class="viewcode-block" id="Operation.build_params">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.Operation.html#torchquantum.operator.Operation.build_params">[docs]</a>
    <span class="k">def</span> <span class="nf">build_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainable</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Build parameters.</span>

<span class="sd">        Args:</span>
<span class="sd">            trainable (bool): Whether the parameters are trainable.</span>

<span class="sd">        Returns:</span>
<span class="sd">            torch.Tensor: Built parameters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_params</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">F_DTYPE</span><span class="p">))</span>
        <span class="n">parameters</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">trainable</span> <span class="k">else</span> <span class="kc">False</span>
        <span class="c1"># self.register_parameter(f&quot;{self.name}_params&quot;, parameters)</span>
        <span class="k">return</span> <span class="n">parameters</span></div>


<div class="viewcode-block" id="Operation.reset_params">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.Operation.html#torchquantum.operator.Operation.reset_params">[docs]</a>
    <span class="k">def</span> <span class="nf">reset_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">init_params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reset parameters.</span>

<span class="sd">        Args:</span>
<span class="sd">            init_params (torch.Tensor, optional): Input the initialization</span>
<span class="sd">                parameters. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">init_params</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">init_params</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">init_param</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">init_params</span><span class="p">):</span>
                    <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">constant_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[:,</span> <span class="n">k</span><span class="p">],</span> <span class="n">init_param</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">constant_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">init_params</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">uniform_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="DiagonalOperation">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.DiagonalOperation.html#torchquantum.operator.DiagonalOperation">[docs]</a>
<span class="k">class</span> <span class="nc">DiagonalOperation</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for Diagonal Operation.&quot;&quot;&quot;</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_eigvals</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The eigenvalues of the unitary matrix of the operator.</span>

<span class="sd">        Args:</span>
<span class="sd">            params (torch.Tensor, optional): The parameters for parameterized</span>
<span class="sd">                operators.</span>

<span class="sd">        Returns: None.</span>
<span class="sd">        raise NotImplementedError</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">eigvals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The eigenvalues of the unitary matrix of the operator.</span>

<span class="sd">        Returns: Eigenvalues.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">eigvals</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The unitary matrix of the operator.</span>

<span class="sd">        Args:</span>
<span class="sd">            params (torch.Tensor, optional): The parameters for parameterized</span>
<span class="sd">                operators.</span>

<span class="sd">        Returns: None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_eigvals</span><span class="p">(</span><span class="n">params</span><span class="p">))</span></div>



<div class="viewcode-block" id="Hadamard">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.Hadamard.html#torchquantum.operator.Hadamard">[docs]</a>
<span class="k">class</span> <span class="nc">Hadamard</span><span class="p">(</span><span class="n">Observable</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for Hadamard Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">eigvals</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">C_DTYPE</span><span class="p">)</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">mat_dict</span><span class="p">[</span><span class="s2">&quot;hadamard&quot;</span><span class="p">]</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">hadamard</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">matrix</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_eigvals</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">eigvals</span>

<div class="viewcode-block" id="Hadamard.diagonalizing_gates">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.Hadamard.html#torchquantum.operator.Hadamard.diagonalizing_gates">[docs]</a>
    <span class="k">def</span> <span class="nf">diagonalizing_gates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">tq</span><span class="o">.</span><span class="n">RY</span><span class="p">(</span><span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">init_params</span><span class="o">=-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)]</span></div>
</div>



<div class="viewcode-block" id="SHadamard">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.SHadamard.html#torchquantum.operator.SHadamard">[docs]</a>
<span class="k">class</span> <span class="nc">SHadamard</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for SHadamard Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">mat_dict</span><span class="p">[</span><span class="s2">&quot;shadamard&quot;</span><span class="p">]</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">shadamard</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">matrix</span></div>



<div class="viewcode-block" id="PauliX">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.PauliX.html#torchquantum.operator.PauliX">[docs]</a>
<span class="k">class</span> <span class="nc">PauliX</span><span class="p">(</span><span class="n">Observable</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for Pauli X Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">eigvals</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">C_DTYPE</span><span class="p">)</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">mat_dict</span><span class="p">[</span><span class="s2">&quot;paulix&quot;</span><span class="p">]</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">paulix</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">matrix</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_eigvals</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">eigvals</span>

<div class="viewcode-block" id="PauliX.diagonalizing_gates">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.PauliX.html#torchquantum.operator.PauliX.diagonalizing_gates">[docs]</a>
    <span class="k">def</span> <span class="nf">diagonalizing_gates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">tq</span><span class="o">.</span><span class="n">Hadamard</span><span class="p">()]</span></div>
</div>



<div class="viewcode-block" id="PauliY">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.PauliY.html#torchquantum.operator.PauliY">[docs]</a>
<span class="k">class</span> <span class="nc">PauliY</span><span class="p">(</span><span class="n">Observable</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for Pauli Y Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">eigvals</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">C_DTYPE</span><span class="p">)</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">mat_dict</span><span class="p">[</span><span class="s2">&quot;pauliy&quot;</span><span class="p">]</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">pauliy</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">matrix</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_eigvals</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">eigvals</span>

<div class="viewcode-block" id="PauliY.diagonalizing_gates">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.PauliY.html#torchquantum.operator.PauliY.diagonalizing_gates">[docs]</a>
    <span class="k">def</span> <span class="nf">diagonalizing_gates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">tq</span><span class="o">.</span><span class="n">PauliZ</span><span class="p">(),</span> <span class="n">tq</span><span class="o">.</span><span class="n">S</span><span class="p">(),</span> <span class="n">tq</span><span class="o">.</span><span class="n">Hadamard</span><span class="p">()]</span></div>
</div>



<div class="viewcode-block" id="PauliZ">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.PauliZ.html#torchquantum.operator.PauliZ">[docs]</a>
<span class="k">class</span> <span class="nc">PauliZ</span><span class="p">(</span><span class="n">Observable</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for Pauli Z Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">eigvals</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">C_DTYPE</span><span class="p">)</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">mat_dict</span><span class="p">[</span><span class="s2">&quot;pauliz&quot;</span><span class="p">]</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">pauliz</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">matrix</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_eigvals</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">eigvals</span>

<div class="viewcode-block" id="PauliZ.diagonalizing_gates">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.PauliZ.html#torchquantum.operator.PauliZ.diagonalizing_gates">[docs]</a>
    <span class="k">def</span> <span class="nf">diagonalizing_gates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[]</span></div>
</div>



<div class="viewcode-block" id="I">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.I.html#torchquantum.operator.I">[docs]</a>
<span class="k">class</span> <span class="nc">I</span><span class="p">(</span><span class="n">Observable</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for Identity Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">eigvals</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">C_DTYPE</span><span class="p">)</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">mat_dict</span><span class="p">[</span><span class="s2">&quot;i&quot;</span><span class="p">]</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">i</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">matrix</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_eigvals</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">eigvals</span>

<div class="viewcode-block" id="I.diagonalizing_gates">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.I.html#torchquantum.operator.I.diagonalizing_gates">[docs]</a>
    <span class="k">def</span> <span class="nf">diagonalizing_gates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[]</span></div>
</div>



<div class="viewcode-block" id="S">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.S.html#torchquantum.operator.S">[docs]</a>
<span class="k">class</span> <span class="nc">S</span><span class="p">(</span><span class="n">DiagonalOperation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for S Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">eigvals</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="n">j</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">C_DTYPE</span><span class="p">)</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">mat_dict</span><span class="p">[</span><span class="s2">&quot;s&quot;</span><span class="p">]</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">matrix</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_eigvals</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">eigvals</span></div>



<div class="viewcode-block" id="T">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.T.html#torchquantum.operator.T">[docs]</a>
<span class="k">class</span> <span class="nc">T</span><span class="p">(</span><span class="n">DiagonalOperation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for T Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">eigvals</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="n">j</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">C_DTYPE</span><span class="p">)</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">mat_dict</span><span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">]</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">t</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">matrix</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_eigvals</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">eigvals</span></div>



<div class="viewcode-block" id="SX">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.SX.html#torchquantum.operator.SX">[docs]</a>
<span class="k">class</span> <span class="nc">SX</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for SX Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">eigvals</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="n">j</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">C_DTYPE</span><span class="p">)</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">mat_dict</span><span class="p">[</span><span class="s2">&quot;sx&quot;</span><span class="p">]</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">sx</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">matrix</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_eigvals</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">eigvals</span></div>



<div class="viewcode-block" id="CNOT">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.CNOT.html#torchquantum.operator.CNOT">[docs]</a>
<span class="k">class</span> <span class="nc">CNOT</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for CNOT Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">mat_dict</span><span class="p">[</span><span class="s2">&quot;cnot&quot;</span><span class="p">]</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">cnot</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">matrix</span></div>



<div class="viewcode-block" id="CZ">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.CZ.html#torchquantum.operator.CZ">[docs]</a>
<span class="k">class</span> <span class="nc">CZ</span><span class="p">(</span><span class="n">DiagonalOperation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for CZ Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">eigvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">mat_dict</span><span class="p">[</span><span class="s2">&quot;cz&quot;</span><span class="p">]</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">cz</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">matrix</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_eigvals</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">eigvals</span></div>



<div class="viewcode-block" id="CY">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.CY.html#torchquantum.operator.CY">[docs]</a>
<span class="k">class</span> <span class="nc">CY</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for CY Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">mat_dict</span><span class="p">[</span><span class="s2">&quot;cy&quot;</span><span class="p">]</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">cy</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">matrix</span></div>



<div class="viewcode-block" id="SWAP">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.SWAP.html#torchquantum.operator.SWAP">[docs]</a>
<span class="k">class</span> <span class="nc">SWAP</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for SWAP Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">mat_dict</span><span class="p">[</span><span class="s2">&quot;swap&quot;</span><span class="p">]</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">swap</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">matrix</span></div>



<div class="viewcode-block" id="SSWAP">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.SSWAP.html#torchquantum.operator.SSWAP">[docs]</a>
<span class="k">class</span> <span class="nc">SSWAP</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for SSWAP Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">mat_dict</span><span class="p">[</span><span class="s2">&quot;sswap&quot;</span><span class="p">]</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">sswap</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">matrix</span></div>



<div class="viewcode-block" id="CSWAP">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.CSWAP.html#torchquantum.operator.CSWAP">[docs]</a>
<span class="k">class</span> <span class="nc">CSWAP</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for CSWAP Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">mat_dict</span><span class="p">[</span><span class="s2">&quot;cswap&quot;</span><span class="p">]</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">cswap</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">matrix</span></div>



<div class="viewcode-block" id="Toffoli">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.Toffoli.html#torchquantum.operator.Toffoli">[docs]</a>
<span class="k">class</span> <span class="nc">Toffoli</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for Toffoli Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">mat_dict</span><span class="p">[</span><span class="s2">&quot;toffoli&quot;</span><span class="p">]</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">toffoli</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">matrix</span></div>



<div class="viewcode-block" id="RX">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.RX.html#torchquantum.operator.RX">[docs]</a>
<span class="k">class</span> <span class="nc">RX</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for RX Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">rx</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tqf</span><span class="o">.</span><span class="n">rx_matrix</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></div>



<div class="viewcode-block" id="RY">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.RY.html#torchquantum.operator.RY">[docs]</a>
<span class="k">class</span> <span class="nc">RY</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for RY Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">ry</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tqf</span><span class="o">.</span><span class="n">ry_matrix</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></div>



<div class="viewcode-block" id="RZ">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.RZ.html#torchquantum.operator.RZ">[docs]</a>
<span class="k">class</span> <span class="nc">RZ</span><span class="p">(</span><span class="n">DiagonalOperation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for RZ Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">rz</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tqf</span><span class="o">.</span><span class="n">rz_matrix</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></div>



<div class="viewcode-block" id="PhaseShift">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.PhaseShift.html#torchquantum.operator.PhaseShift">[docs]</a>
<span class="k">class</span> <span class="nc">PhaseShift</span><span class="p">(</span><span class="n">DiagonalOperation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for PhaseShift Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">phaseshift</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tqf</span><span class="o">.</span><span class="n">phaseshift_matrix</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></div>



<div class="viewcode-block" id="Rot">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.Rot.html#torchquantum.operator.Rot">[docs]</a>
<span class="k">class</span> <span class="nc">Rot</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for Rotation Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">rot</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tqf</span><span class="o">.</span><span class="n">rot_matrix</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></div>



<div class="viewcode-block" id="MultiRZ">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.MultiRZ.html#torchquantum.operator.MultiRZ">[docs]</a>
<span class="k">class</span> <span class="nc">MultiRZ</span><span class="p">(</span><span class="n">DiagonalOperation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for Multi-qubit RZ Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="n">AnyWires</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">multirz</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">n_wires</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tqf</span><span class="o">.</span><span class="n">multirz_matrix</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">n_wires</span><span class="p">)</span></div>



<div class="viewcode-block" id="RXX">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.RXX.html#torchquantum.operator.RXX">[docs]</a>
<span class="k">class</span> <span class="nc">RXX</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for RXX Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">rxx</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tqf</span><span class="o">.</span><span class="n">rxx_matrix</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></div>



<div class="viewcode-block" id="RYY">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.RYY.html#torchquantum.operator.RYY">[docs]</a>
<span class="k">class</span> <span class="nc">RYY</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for RYY Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">ryy</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tqf</span><span class="o">.</span><span class="n">ryy_matrix</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></div>



<div class="viewcode-block" id="RZZ">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.RZZ.html#torchquantum.operator.RZZ">[docs]</a>
<span class="k">class</span> <span class="nc">RZZ</span><span class="p">(</span><span class="n">DiagonalOperation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for RZZ Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">rzz</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tqf</span><span class="o">.</span><span class="n">rzz_matrix</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></div>



<div class="viewcode-block" id="RZX">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.RZX.html#torchquantum.operator.RZX">[docs]</a>
<span class="k">class</span> <span class="nc">RZX</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for RZX Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">rzx</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tqf</span><span class="o">.</span><span class="n">rzx_matrix</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></div>



<div class="viewcode-block" id="TrainableUnitary">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.TrainableUnitary.html#torchquantum.operator.TrainableUnitary">[docs]</a>
<span class="k">class</span> <span class="nc">TrainableUnitary</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for TrainableUnitary Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="n">AnyNParams</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="n">AnyWires</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">qubitunitaryfast</span><span class="p">)</span>

<div class="viewcode-block" id="TrainableUnitary.build_params">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.TrainableUnitary.html#torchquantum.operator.TrainableUnitary.build_params">[docs]</a>
    <span class="k">def</span> <span class="nf">build_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainable</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Build the parameters for the gate.</span>

<span class="sd">        Args:</span>
<span class="sd">            trainable (bool): Whether the parameters are trainble.</span>

<span class="sd">        Returns:</span>
<span class="sd">            torch.Tensor: Parameters.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">C_DTYPE</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">parameters</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">trainable</span> <span class="k">else</span> <span class="kc">False</span>
        <span class="c1"># self.register_parameter(f&quot;{self.name}_params&quot;, parameters)</span>
        <span class="k">return</span> <span class="n">parameters</span></div>


<div class="viewcode-block" id="TrainableUnitary.reset_params">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.TrainableUnitary.html#torchquantum.operator.TrainableUnitary.reset_params">[docs]</a>
    <span class="k">def</span> <span class="nf">reset_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">init_params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reset the parameters.</span>

<span class="sd">        Args:</span>
<span class="sd">            init_params (torch.Tensor, optional): Initial parameters.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mat</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">C_DTYPE</span><span class="p">)</span>
        <span class="n">U</span><span class="p">,</span> <span class="n">Sigma</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy_</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">V</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span></div>


    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tqf</span><span class="o">.</span><span class="n">qubitunitaryfast</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></div>



<div class="viewcode-block" id="TrainableUnitaryStrict">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.TrainableUnitaryStrict.html#torchquantum.operator.TrainableUnitaryStrict">[docs]</a>
<span class="k">class</span> <span class="nc">TrainableUnitaryStrict</span><span class="p">(</span><span class="n">TrainableUnitary</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for Strict Unitary matrix gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="n">AnyNParams</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="n">AnyWires</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">qubitunitarystrict</span><span class="p">)</span></div>



<div class="viewcode-block" id="CRX">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.CRX.html#torchquantum.operator.CRX">[docs]</a>
<span class="k">class</span> <span class="nc">CRX</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for Controlled Rotation X gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">crx</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tqf</span><span class="o">.</span><span class="n">crx_matrix</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></div>



<div class="viewcode-block" id="CRY">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.CRY.html#torchquantum.operator.CRY">[docs]</a>
<span class="k">class</span> <span class="nc">CRY</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for Controlled Rotation Y gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">cry</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tqf</span><span class="o">.</span><span class="n">cry_matrix</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></div>



<div class="viewcode-block" id="CRZ">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.CRZ.html#torchquantum.operator.CRZ">[docs]</a>
<span class="k">class</span> <span class="nc">CRZ</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for Controlled Rotation Z gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">crz</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tqf</span><span class="o">.</span><span class="n">crz_matrix</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></div>



<div class="viewcode-block" id="CRot">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.CRot.html#torchquantum.operator.CRot">[docs]</a>
<span class="k">class</span> <span class="nc">CRot</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for Controlled Rotation gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">crot</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tqf</span><span class="o">.</span><span class="n">crot_matrix</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></div>



<div class="viewcode-block" id="U1">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.U1.html#torchquantum.operator.U1">[docs]</a>
<span class="k">class</span> <span class="nc">U1</span><span class="p">(</span><span class="n">DiagonalOperation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for Controlled Rotation Y gate.  U1 is the same</span>
<span class="sd">    as phaseshift.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">u1</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tqf</span><span class="o">.</span><span class="n">u1_matrix</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></div>



<span class="k">class</span> <span class="nc">CU</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for Controlled U gate (4-parameter two-qubit gate).&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">cu</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tqf</span><span class="o">.</span><span class="n">cu_matrix</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>


<div class="viewcode-block" id="CU1">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.CU1.html#torchquantum.operator.CU1">[docs]</a>
<span class="k">class</span> <span class="nc">CU1</span><span class="p">(</span><span class="n">DiagonalOperation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for controlled U1 gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">cu1</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tqf</span><span class="o">.</span><span class="n">cu1_matrix</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></div>



<div class="viewcode-block" id="U2">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.U2.html#torchquantum.operator.U2">[docs]</a>
<span class="k">class</span> <span class="nc">U2</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for U2 gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">u2</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tqf</span><span class="o">.</span><span class="n">u2_matrix</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></div>



<div class="viewcode-block" id="CU2">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.CU2.html#torchquantum.operator.CU2">[docs]</a>
<span class="k">class</span> <span class="nc">CU2</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for controlled U2 gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">cu2</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tqf</span><span class="o">.</span><span class="n">cu2_matrix</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></div>



<div class="viewcode-block" id="U3">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.U3.html#torchquantum.operator.U3">[docs]</a>
<span class="k">class</span> <span class="nc">U3</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for U3 gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">u3</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tqf</span><span class="o">.</span><span class="n">u3_matrix</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></div>



<div class="viewcode-block" id="CU3">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.CU3.html#torchquantum.operator.CU3">[docs]</a>
<span class="k">class</span> <span class="nc">CU3</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for Controlled U3 gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">cu3</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tqf</span><span class="o">.</span><span class="n">cu3_matrix</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></div>



<div class="viewcode-block" id="QubitUnitary">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.QubitUnitary.html#torchquantum.operator.QubitUnitary">[docs]</a>
<span class="k">class</span> <span class="nc">QubitUnitary</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for controlled Qubit Unitary gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="n">AnyNParams</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="n">AnyWires</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">qubitunitary</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tqf</span><span class="o">.</span><span class="n">qubitunitary_matrix</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

<div class="viewcode-block" id="QubitUnitary.build_params">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.QubitUnitary.html#torchquantum.operator.QubitUnitary.build_params">[docs]</a>
    <span class="k">def</span> <span class="nf">build_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainable</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="QubitUnitary.reset_params">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.QubitUnitary.html#torchquantum.operator.QubitUnitary.reset_params">[docs]</a>
    <span class="k">def</span> <span class="nf">reset_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">init_params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">init_params</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">C_DTYPE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">register_buffer</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">_unitary&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="QubitUnitaryFast">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.QubitUnitaryFast.html#torchquantum.operator.QubitUnitaryFast">[docs]</a>
<span class="k">class</span> <span class="nc">QubitUnitaryFast</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for fast implementation of</span>
<span class="sd">    controlled Qubit Unitary gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="n">AnyNParams</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="n">AnyWires</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">qubitunitaryfast</span><span class="p">)</span>

<div class="viewcode-block" id="QubitUnitaryFast.__init__">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.QubitUnitaryFast.html#torchquantum.operator.QubitUnitaryFast.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">has_params</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">trainable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">init_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">n_wires</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">wires</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">trainable</span><span class="o">=</span><span class="n">trainable</span><span class="p">,</span>
            <span class="n">init_params</span><span class="o">=</span><span class="n">init_params</span><span class="p">,</span>
            <span class="n">n_wires</span><span class="o">=</span><span class="n">n_wires</span><span class="p">,</span>
            <span class="n">wires</span><span class="o">=</span><span class="n">wires</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="QubitUnitaryFast.from_controlled_operation">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.QubitUnitaryFast.html#torchquantum.operator.QubitUnitaryFast.from_controlled_operation">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_controlled_operation</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">op</span><span class="p">,</span>
        <span class="n">c_wires</span><span class="p">,</span>
        <span class="n">t_wires</span><span class="p">,</span>
        <span class="n">trainable</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            op: the operation</span>
<span class="sd">            c_wires: controlled wires, will only be a set such as 1, [2,3]</span>
<span class="sd">            t_wires: can be a list of list of wires, multiple sets</span>
<span class="sd">            [[1,2], [3,4]]</span>
<span class="sd">            trainable:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">op</span> <span class="o">=</span> <span class="n">op</span>
        <span class="n">c_wires</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">c_wires</span><span class="p">)</span>
        <span class="n">t_wires</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">t_wires</span><span class="p">)</span>
        <span class="n">trainable</span> <span class="o">=</span> <span class="n">trainable</span>
        <span class="c1"># self.n_t_wires = op.n_wires</span>
        <span class="c1"># assert len(t_wires) == op.n_wires</span>

        <span class="n">orig_u</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">matrix</span>
        <span class="n">orig_u_n_wires</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">n_wires</span>

        <span class="n">wires</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">c_wires</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># only one control qubit</span>
            <span class="c1"># 1</span>
            <span class="n">n_c_wires</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">wires</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c_wires</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
        <span class="k">elif</span> <span class="n">c_wires</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># multiple control qubits</span>
            <span class="c1"># [1, 2]</span>
            <span class="n">n_c_wires</span> <span class="o">=</span> <span class="n">c_wires</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">wires</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">c_wires</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">t_wires</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># single qubit U on one set</span>
            <span class="c1"># 2</span>
            <span class="n">n_t_wires</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">n_set_t_wires</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">wires</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t_wires</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
        <span class="k">elif</span> <span class="n">t_wires</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># single qubit U on multiple sets</span>
            <span class="c1"># [1, 2, 3]</span>
            <span class="c1"># or multi qubit U on one set</span>
            <span class="c1"># [2, 3]</span>
            <span class="n">n_t_wires</span> <span class="o">=</span> <span class="n">t_wires</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">n_set_t_wires</span> <span class="o">=</span> <span class="n">n_t_wires</span> <span class="o">//</span> <span class="n">orig_u_n_wires</span>
            <span class="n">wires</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">t_wires</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>

        <span class="k">elif</span> <span class="n">t_wires</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c1"># multi qubit unitary on multiple sets</span>
            <span class="c1"># [[2, 3], [4, 5]]</span>
            <span class="n">n_t_wires</span> <span class="o">=</span> <span class="n">t_wires</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">n_set_t_wires</span> <span class="o">=</span> <span class="n">n_t_wires</span> <span class="o">//</span> <span class="n">orig_u_n_wires</span>
            <span class="n">wires</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">t_wires</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>

        <span class="n">n_wires</span> <span class="o">=</span> <span class="n">n_c_wires</span> <span class="o">+</span> <span class="n">n_t_wires</span>

        <span class="c1"># compute the new unitary, then permute</span>
        <span class="n">unitary</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">n_wires</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="n">n_wires</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">C_DTYPE</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">n_wires</span> <span class="o">-</span> <span class="mi">2</span><span class="o">**</span><span class="n">n_t_wires</span><span class="p">):</span>
            <span class="n">unitary</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.0</span><span class="n">j</span>

        <span class="c1"># compute kronecker product of all the controlled target</span>

        <span class="n">controlled_u</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_set_t_wires</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">controlled_u</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">controlled_u</span> <span class="o">=</span> <span class="n">orig_u</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">controlled_u</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">controlled_u</span><span class="p">,</span> <span class="n">orig_u</span><span class="p">)</span>

        <span class="n">d_controlled_u</span> <span class="o">=</span> <span class="n">controlled_u</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">unitary</span><span class="p">[</span><span class="o">-</span><span class="n">d_controlled_u</span><span class="p">:,</span> <span class="o">-</span><span class="n">d_controlled_u</span><span class="p">:]</span> <span class="o">=</span> <span class="n">controlled_u</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="n">has_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">trainable</span><span class="o">=</span><span class="n">trainable</span><span class="p">,</span>
            <span class="n">init_params</span><span class="o">=</span><span class="n">unitary</span><span class="p">,</span>
            <span class="n">n_wires</span><span class="o">=</span><span class="n">n_wires</span><span class="p">,</span>
            <span class="n">wires</span><span class="o">=</span><span class="n">wires</span><span class="p">,</span>
        <span class="p">)</span></div>


    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tqf</span><span class="o">.</span><span class="n">qubitunitaryfast_matrix</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

<div class="viewcode-block" id="QubitUnitaryFast.build_params">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.QubitUnitaryFast.html#torchquantum.operator.QubitUnitaryFast.build_params">[docs]</a>
    <span class="k">def</span> <span class="nf">build_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainable</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="QubitUnitaryFast.reset_params">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.QubitUnitaryFast.html#torchquantum.operator.QubitUnitaryFast.reset_params">[docs]</a>
    <span class="k">def</span> <span class="nf">reset_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">init_params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">init_params</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">C_DTYPE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">register_buffer</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">_unitary&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="MultiCNOT">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.MultiCNOT.html#torchquantum.operator.MultiCNOT">[docs]</a>
<span class="k">class</span> <span class="nc">MultiCNOT</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for Multi qubit CNOT gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="n">AnyWires</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">multicnot</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">n_wires</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tqf</span><span class="o">.</span><span class="n">multicnot_matrix</span><span class="p">(</span><span class="n">n_wires</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">op_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">op_matrix</span></div>



<div class="viewcode-block" id="MultiXCNOT">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.MultiXCNOT.html#torchquantum.operator.MultiXCNOT">[docs]</a>
<span class="k">class</span> <span class="nc">MultiXCNOT</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for Multi qubit XCNOT gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="n">AnyWires</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">multixcnot</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">n_wires</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tqf</span><span class="o">.</span><span class="n">multixcnot_matrix</span><span class="p">(</span><span class="n">n_wires</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">op_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_wires</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">op_matrix</span></div>



<div class="viewcode-block" id="Reset">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.Reset.html#torchquantum.operator.Reset">[docs]</a>
<span class="k">class</span> <span class="nc">Reset</span><span class="p">(</span><span class="n">Operator</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for Reset gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="n">AnyWires</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">reset</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span></div>



<div class="viewcode-block" id="SingleExcitation">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.SingleExcitation.html#torchquantum.operator.SingleExcitation">[docs]</a>
<span class="k">class</span> <span class="nc">SingleExcitation</span><span class="p">(</span><span class="n">Operator</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for SingleExcitation gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">singleexcitation</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tqf</span><span class="o">.</span><span class="n">singleexcitation_matrix</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></div>



<div class="viewcode-block" id="ECR">
<a class="viewcode-back" href="../../../generated/torchquantum.operator.ECR.html#torchquantum.operator.ECR">[docs]</a>
<span class="k">class</span> <span class="nc">ECR</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for Echoed Cross Resonance Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">mat_dict</span><span class="p">[</span><span class="s2">&quot;ecr&quot;</span><span class="p">]</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">ecr</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">matrix</span></div>



<span class="k">class</span> <span class="nc">QFT</span><span class="p">(</span><span class="n">Observable</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for Quantum Fourier Transform.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="n">AnyWires</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">qft</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">n_wires</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tqf</span><span class="o">.</span><span class="n">qft_matrix</span><span class="p">(</span><span class="n">n_wires</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">SDG</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for SDG Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="n">matrix</span> <span class="o">=</span> <span class="n">mat_dict</span><span class="p">[</span><span class="s2">&quot;sdg&quot;</span><span class="p">]</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">sdg</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">matrix</span>


<span class="k">class</span> <span class="nc">TDG</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for TDG Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">mat_dict</span><span class="p">[</span><span class="s2">&quot;tdg&quot;</span><span class="p">]</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">tdg</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">matrix</span>


<span class="k">class</span> <span class="nc">SXDG</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for SXDG Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">mat_dict</span><span class="p">[</span><span class="s2">&quot;sxdg&quot;</span><span class="p">]</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">sxdg</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">matrix</span>


<span class="k">class</span> <span class="nc">CCZ</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for CCZ Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">mat_dict</span><span class="p">[</span><span class="s2">&quot;ccz&quot;</span><span class="p">]</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">ccz</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">matrix</span>


<span class="k">class</span> <span class="nc">ISWAP</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for ISWAP Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">mat_dict</span><span class="p">[</span><span class="s2">&quot;iswap&quot;</span><span class="p">]</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">iswap</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">matrix</span>


<span class="k">class</span> <span class="nc">CS</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for CS Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">mat_dict</span><span class="p">[</span><span class="s2">&quot;cs&quot;</span><span class="p">]</span>
    <span class="n">eigvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="n">j</span><span class="p">])</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">cs</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">matrix</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_eigvals</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">eigvals</span>


<span class="k">class</span> <span class="nc">CSDG</span><span class="p">(</span><span class="n">DiagonalOperation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for CS Dagger Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">mat_dict</span><span class="p">[</span><span class="s2">&quot;csdg&quot;</span><span class="p">]</span>
    <span class="n">eigvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="p">])</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">csdg</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">matrix</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_eigvals</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">eigvals</span>


<span class="k">class</span> <span class="nc">CSX</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for CSX Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">mat_dict</span><span class="p">[</span><span class="s2">&quot;csx&quot;</span><span class="p">]</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">csx</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">matrix</span>


<span class="k">class</span> <span class="nc">CHadamard</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for CHadamard Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">mat_dict</span><span class="p">[</span><span class="s2">&quot;chadamard&quot;</span><span class="p">]</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">chadamard</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">matrix</span>


<span class="k">class</span> <span class="nc">CCZ</span><span class="p">(</span><span class="n">DiagonalOperation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for CCZ Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">mat_dict</span><span class="p">[</span><span class="s2">&quot;ccz&quot;</span><span class="p">]</span>
    <span class="n">eigvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">ccz</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">matrix</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_eigvals</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">eigvals</span>


<span class="k">class</span> <span class="nc">DCX</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for DCX Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">mat_dict</span><span class="p">[</span><span class="s2">&quot;dcx&quot;</span><span class="p">]</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">dcx</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">matrix</span>


<span class="k">class</span> <span class="nc">XXMINYY</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for XXMinusYY gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">xxminyy_matrix</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tqf</span><span class="o">.</span><span class="n">xxminyy_matrix</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">XXPLUSYY</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for XXPlusYY gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">xxplusyy_matrix</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tqf</span><span class="o">.</span><span class="n">xxplusyy_matrix</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">C3X</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for C3X gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">mat_dict</span><span class="p">[</span><span class="s2">&quot;c3x&quot;</span><span class="p">]</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">c3x</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">matrix</span>


<span class="k">class</span> <span class="nc">R</span><span class="p">(</span><span class="n">DiagonalOperation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for R Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tqf</span><span class="o">.</span><span class="n">r_matrix</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">C4X</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for C4X Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">mat_dict</span><span class="p">[</span><span class="s2">&quot;c4x&quot;</span><span class="p">]</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">c4x</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">matrix</span>


<span class="k">class</span> <span class="nc">RC3X</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for RC3X Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">mat_dict</span><span class="p">[</span><span class="s2">&quot;rc3x&quot;</span><span class="p">]</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">rc3x</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">matrix</span>


<span class="k">class</span> <span class="nc">RCCX</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for RCCX Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">mat_dict</span><span class="p">[</span><span class="s2">&quot;rccx&quot;</span><span class="p">]</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">rccx</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">matrix</span>


<span class="k">class</span> <span class="nc">GlobalPhase</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for Global Phase gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">globalphase</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tqf</span><span class="o">.</span><span class="n">globalphase_matrix</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">C3SX</span><span class="p">(</span><span class="n">Operation</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for C3SX Gate.&quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_wires</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">mat_dict</span><span class="p">[</span><span class="s2">&quot;c3sx&quot;</span><span class="p">]</span>
    <span class="n">func</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">tqf</span><span class="o">.</span><span class="n">c3sx</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matrix</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">matrix</span>


<span class="n">H</span> <span class="o">=</span> <span class="n">Hadamard</span>
<span class="n">SH</span> <span class="o">=</span> <span class="n">SHadamard</span>
<span class="n">EchoedCrossResonance</span> <span class="o">=</span> <span class="n">ECR</span>
<span class="n">CH</span> <span class="o">=</span> <span class="n">CHadamard</span>

<span class="n">op_name_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;hadamard&quot;</span><span class="p">:</span> <span class="n">Hadamard</span><span class="p">,</span>
    <span class="s2">&quot;h&quot;</span><span class="p">:</span> <span class="n">Hadamard</span><span class="p">,</span>
    <span class="s2">&quot;shadamard&quot;</span><span class="p">:</span> <span class="n">SHadamard</span><span class="p">,</span>
    <span class="s2">&quot;sh&quot;</span><span class="p">:</span> <span class="n">SHadamard</span><span class="p">,</span>
    <span class="s2">&quot;paulix&quot;</span><span class="p">:</span> <span class="n">PauliX</span><span class="p">,</span>
    <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">PauliX</span><span class="p">,</span>
    <span class="s2">&quot;pauliy&quot;</span><span class="p">:</span> <span class="n">PauliY</span><span class="p">,</span>
    <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">PauliY</span><span class="p">,</span>
    <span class="s2">&quot;pauliz&quot;</span><span class="p">:</span> <span class="n">PauliZ</span><span class="p">,</span>
    <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="n">PauliZ</span><span class="p">,</span>
    <span class="s2">&quot;i&quot;</span><span class="p">:</span> <span class="n">I</span><span class="p">,</span>
    <span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="n">S</span><span class="p">,</span>
    <span class="s2">&quot;t&quot;</span><span class="p">:</span> <span class="n">T</span><span class="p">,</span>
    <span class="s2">&quot;sx&quot;</span><span class="p">:</span> <span class="n">SX</span><span class="p">,</span>
    <span class="s2">&quot;cx&quot;</span><span class="p">:</span> <span class="n">CNOT</span><span class="p">,</span>
    <span class="s2">&quot;cnot&quot;</span><span class="p">:</span> <span class="n">CNOT</span><span class="p">,</span>
    <span class="s2">&quot;cz&quot;</span><span class="p">:</span> <span class="n">CZ</span><span class="p">,</span>
    <span class="s2">&quot;cy&quot;</span><span class="p">:</span> <span class="n">CY</span><span class="p">,</span>
    <span class="s2">&quot;rx&quot;</span><span class="p">:</span> <span class="n">RX</span><span class="p">,</span>
    <span class="s2">&quot;ry&quot;</span><span class="p">:</span> <span class="n">RY</span><span class="p">,</span>
    <span class="s2">&quot;rz&quot;</span><span class="p">:</span> <span class="n">RZ</span><span class="p">,</span>
    <span class="s2">&quot;rxx&quot;</span><span class="p">:</span> <span class="n">RXX</span><span class="p">,</span>
    <span class="s2">&quot;xx&quot;</span><span class="p">:</span> <span class="n">RXX</span><span class="p">,</span>
    <span class="s2">&quot;ryy&quot;</span><span class="p">:</span> <span class="n">RYY</span><span class="p">,</span>
    <span class="s2">&quot;yy&quot;</span><span class="p">:</span> <span class="n">RYY</span><span class="p">,</span>
    <span class="s2">&quot;rzz&quot;</span><span class="p">:</span> <span class="n">RZZ</span><span class="p">,</span>
    <span class="s2">&quot;zz&quot;</span><span class="p">:</span> <span class="n">RZZ</span><span class="p">,</span>
    <span class="s2">&quot;rzx&quot;</span><span class="p">:</span> <span class="n">RZX</span><span class="p">,</span>
    <span class="s2">&quot;zx&quot;</span><span class="p">:</span> <span class="n">RZX</span><span class="p">,</span>
    <span class="s2">&quot;swap&quot;</span><span class="p">:</span> <span class="n">SWAP</span><span class="p">,</span>
    <span class="s2">&quot;sswap&quot;</span><span class="p">:</span> <span class="n">SSWAP</span><span class="p">,</span>
    <span class="s2">&quot;cswap&quot;</span><span class="p">:</span> <span class="n">CSWAP</span><span class="p">,</span>
    <span class="s2">&quot;toffoli&quot;</span><span class="p">:</span> <span class="n">Toffoli</span><span class="p">,</span>
    <span class="s2">&quot;ccx&quot;</span><span class="p">:</span> <span class="n">Toffoli</span><span class="p">,</span>
    <span class="s2">&quot;phaseshift&quot;</span><span class="p">:</span> <span class="n">PhaseShift</span><span class="p">,</span>
    <span class="s2">&quot;rot&quot;</span><span class="p">:</span> <span class="n">Rot</span><span class="p">,</span>
    <span class="s2">&quot;multirz&quot;</span><span class="p">:</span> <span class="n">MultiRZ</span><span class="p">,</span>
    <span class="s2">&quot;crx&quot;</span><span class="p">:</span> <span class="n">CRX</span><span class="p">,</span>
    <span class="s2">&quot;cry&quot;</span><span class="p">:</span> <span class="n">CRY</span><span class="p">,</span>
    <span class="s2">&quot;crz&quot;</span><span class="p">:</span> <span class="n">CRZ</span><span class="p">,</span>
    <span class="s2">&quot;crot&quot;</span><span class="p">:</span> <span class="n">CRot</span><span class="p">,</span>
    <span class="s2">&quot;u1&quot;</span><span class="p">:</span> <span class="n">U1</span><span class="p">,</span>
    <span class="s2">&quot;p&quot;</span><span class="p">:</span> <span class="n">U1</span><span class="p">,</span>
    <span class="s2">&quot;u2&quot;</span><span class="p">:</span> <span class="n">U2</span><span class="p">,</span>
    <span class="s2">&quot;u3&quot;</span><span class="p">:</span> <span class="n">U3</span><span class="p">,</span>
    <span class="s2">&quot;u&quot;</span><span class="p">:</span> <span class="n">U3</span><span class="p">,</span>
    <span class="s2">&quot;cu1&quot;</span><span class="p">:</span> <span class="n">CU1</span><span class="p">,</span>
    <span class="s2">&quot;cp&quot;</span><span class="p">:</span> <span class="n">CU1</span><span class="p">,</span>
    <span class="s2">&quot;cr&quot;</span><span class="p">:</span> <span class="n">CU1</span><span class="p">,</span>
    <span class="s2">&quot;cphase&quot;</span><span class="p">:</span> <span class="n">CU1</span><span class="p">,</span>
    <span class="s2">&quot;cu2&quot;</span><span class="p">:</span> <span class="n">CU2</span><span class="p">,</span>
    <span class="s2">&quot;cu3&quot;</span><span class="p">:</span> <span class="n">CU3</span><span class="p">,</span>
    <span class="s2">&quot;cu&quot;</span><span class="p">:</span> <span class="n">CU</span><span class="p">,</span>
    <span class="s2">&quot;qubitunitary&quot;</span><span class="p">:</span> <span class="n">QubitUnitary</span><span class="p">,</span>
    <span class="s2">&quot;qubitunitarystrict&quot;</span><span class="p">:</span> <span class="n">QubitUnitaryFast</span><span class="p">,</span>
    <span class="s2">&quot;qubitunitaryfast&quot;</span><span class="p">:</span> <span class="n">QubitUnitaryFast</span><span class="p">,</span>
    <span class="s2">&quot;trainableunitary&quot;</span><span class="p">:</span> <span class="n">TrainableUnitary</span><span class="p">,</span>
    <span class="s2">&quot;trainableunitarystrict&quot;</span><span class="p">:</span> <span class="n">TrainableUnitaryStrict</span><span class="p">,</span>
    <span class="s2">&quot;multicnot&quot;</span><span class="p">:</span> <span class="n">MultiCNOT</span><span class="p">,</span>
    <span class="s2">&quot;multixcnot&quot;</span><span class="p">:</span> <span class="n">MultiXCNOT</span><span class="p">,</span>
    <span class="s2">&quot;reset&quot;</span><span class="p">:</span> <span class="n">Reset</span><span class="p">,</span>
    <span class="s2">&quot;singleexcitation&quot;</span><span class="p">:</span> <span class="n">SingleExcitation</span><span class="p">,</span>
    <span class="s2">&quot;ecr&quot;</span><span class="p">:</span> <span class="n">ECR</span><span class="p">,</span>
    <span class="s2">&quot;echoedcrossresonance&quot;</span><span class="p">:</span> <span class="n">ECR</span><span class="p">,</span>
    <span class="s2">&quot;QFT&quot;</span><span class="p">:</span> <span class="n">QFT</span><span class="p">,</span>
    <span class="s2">&quot;sdg&quot;</span><span class="p">:</span> <span class="n">SDG</span><span class="p">,</span>
    <span class="s2">&quot;cs&quot;</span><span class="p">:</span> <span class="n">CS</span><span class="p">,</span>
    <span class="s2">&quot;chadamard&quot;</span><span class="p">:</span> <span class="n">CHadamard</span><span class="p">,</span>
    <span class="s2">&quot;ch&quot;</span><span class="p">:</span> <span class="n">CH</span><span class="p">,</span>
    <span class="s2">&quot;dcx&quot;</span><span class="p">:</span> <span class="n">DCX</span><span class="p">,</span>
    <span class="s2">&quot;xxminyy&quot;</span><span class="p">:</span> <span class="n">XXMINYY</span><span class="p">,</span>
    <span class="s2">&quot;xxplusyy&quot;</span><span class="p">:</span> <span class="n">XXPLUSYY</span><span class="p">,</span>
    <span class="s2">&quot;c3x&quot;</span><span class="p">:</span> <span class="n">C3X</span><span class="p">,</span>
    <span class="s2">&quot;tdg&quot;</span><span class="p">:</span> <span class="n">TDG</span><span class="p">,</span>
    <span class="s2">&quot;sxdg&quot;</span><span class="p">:</span> <span class="n">SXDG</span><span class="p">,</span>
    <span class="s2">&quot;ch&quot;</span><span class="p">:</span> <span class="n">CH</span><span class="p">,</span>
    <span class="s2">&quot;ccz&quot;</span><span class="p">:</span> <span class="n">CCZ</span><span class="p">,</span>
    <span class="s2">&quot;iswap&quot;</span><span class="p">:</span> <span class="n">ISWAP</span><span class="p">,</span>
    <span class="s2">&quot;csdg&quot;</span><span class="p">:</span> <span class="n">CSDG</span><span class="p">,</span>
    <span class="s2">&quot;csx&quot;</span><span class="p">:</span> <span class="n">CSX</span><span class="p">,</span>
    <span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="n">R</span><span class="p">,</span>
    <span class="s2">&quot;c3sx&quot;</span><span class="p">:</span> <span class="n">C3SX</span><span class="p">,</span>
    <span class="s2">&quot;globalphase&quot;</span><span class="p">:</span> <span class="n">GlobalPhase</span><span class="p">,</span>
    <span class="s2">&quot;rccx&quot;</span><span class="p">:</span> <span class="n">RCCX</span><span class="p">,</span>
    <span class="s2">&quot;rc3x&quot;</span><span class="p">:</span> <span class="n">RC3X</span><span class="p">,</span>
    <span class="s2">&quot;c4x&quot;</span><span class="p">:</span> <span class="n">C4X</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2021, Hanrui Wang
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script src="../../../_static/documentation_options.js?v=2709fde1"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/scripts/furo.js?v=32e29ea5"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    </body>
</html>